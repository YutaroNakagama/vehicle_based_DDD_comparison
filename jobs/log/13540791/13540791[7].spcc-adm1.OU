IDX=7
NAME=mmd_biased_anti_pretrain
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/misc/pretrain_groups/mmd_biased_anti_pretrain.txt
TARGETS(first few)=S0120_2 S0116_1 S0135_2 S0134_1 S0154_2 S0188_1 S0154_1 S0205_1 S0172_1 S0205_2
pretrain_setting not found. It will be created at: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_mmd_biased_anti_pretrain.pkl
2025-08-12 14:53:25.775086: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-12 14:53:26.206433: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-12 14:53:26.542688: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754978006.833549 1356145 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754978006.905352 1356145 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754978007.613353 1356145 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754978007.613390 1356145 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754978007.613392 1356145 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754978007.613394 1356145 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-12 14:53:27.684962: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-12 14:53:35,524 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=finetune_mmd_biased_anti_pretrain | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-12 14:53:35,526 - INFO - Model type: common
2025-08-12 14:53:35,526 - INFO - Finetuning with target subjects: ['S0120_2', 'S0116_1', 'S0135_2', 'S0134_1', 'S0154_2', 'S0188_1', 'S0154_1', 'S0205_1', 'S0172_1', 'S0205_2']
2025-08-12 14:53:35,584 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-12 14:53:35,649 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-12 14:53:35,674 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-12 14:53:35,727 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-12 14:53:35,777 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-12 14:53:35,826 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-12 14:53:35,878 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-12 14:53:35,922 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-12 14:53:35,988 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-12 14:53:36,037 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-12 14:53:36,061 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-12 14:53:36,111 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-12 14:53:36,155 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-12 14:53:36,203 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-12 14:53:36,248 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-12 14:53:36,297 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-12 14:53:36,345 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-12 14:53:36,394 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-12 14:53:36,440 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-12 14:53:36,503 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-12 14:53:36,565 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-12 14:53:36,590 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-12 14:53:36,616 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-12 14:53:36,657 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-12 14:53:36,706 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-12 14:53:36,754 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-12 14:53:36,803 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-12 14:53:36,860 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-12 14:53:36,884 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-12 14:53:36,912 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-12 14:53:36,958 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-12 14:53:37,005 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-12 14:53:37,052 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-12 14:53:37,098 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-12 14:53:37,148 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-12 14:53:37,201 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-12 14:53:37,246 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-12 14:53:37,292 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-12 14:53:37,336 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-12 14:53:37,383 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-12 14:53:37,428 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-12 14:53:37,484 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-12 14:53:37,506 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-12 14:53:37,529 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-12 14:53:37,572 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-12 14:53:37,618 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-12 14:53:37,662 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-12 14:53:37,711 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-12 14:53:37,769 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-12 14:53:37,818 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-12 14:53:37,864 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-12 14:53:37,907 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-12 14:53:37,953 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-12 14:53:37,992 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-12 14:53:38,036 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-12 14:53:38,081 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-12 14:53:38,127 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-12 14:53:38,176 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-12 14:53:38,224 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-12 14:53:38,266 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-12 14:53:38,312 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-12 14:53:38,363 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-12 14:53:38,407 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-12 14:53:38,456 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-12 14:53:38,505 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-12 14:53:38,552 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-12 14:53:38,598 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-12 14:53:38,645 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-12 14:53:38,690 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-12 14:53:38,736 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-12 14:53:38,781 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-12 14:53:38,822 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-12 14:53:38,865 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-12 14:53:38,908 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-12 14:53:38,959 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-12 14:53:38,998 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-12 14:53:39,033 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-12 14:55:16,188 - INFO - Saved pretrain setting (features/scaler) to /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_mmd_biased_anti_pretrain.pkl
2025-08-12 14:55:16,198 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_mmd_biased_anti_pretrain.pkl: features=['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
2025-08-12 14:55:16,227 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-12 14:55:16,256 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-12 14:55:16,285 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-12 14:55:16,315 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-12 14:55:16,340 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-12 14:55:16,365 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-12 14:55:16,390 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-12 14:55:16,416 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-12 14:55:16,444 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-12 14:55:16,470 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
[I 2025-08-12 14:55:16,503] A new study created in memory with name: no-name-4e67d358-c068-4f71-86ce-8faeca3e2bcd
[I 2025-08-12 14:55:46,642] Trial 0 finished with value: 0.49450408964761505 and parameters: {'n_estimators': 257, 'max_depth': 7, 'min_samples_split': 8, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.49450408964761505.
[I 2025-08-12 14:56:25,954] Trial 1 finished with value: 0.4960814205759137 and parameters: {'n_estimators': 184, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.4960814205759137.
[I 2025-08-12 14:57:07,714] Trial 2 finished with value: 0.49506268702026945 and parameters: {'n_estimators': 193, 'max_depth': 30, 'min_samples_split': 6, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.4960814205759137.
[I 2025-08-12 14:58:04,570] Trial 3 finished with value: 0.5013977476934207 and parameters: {'n_estimators': 285, 'max_depth': 17, 'min_samples_split': 9, 'min_samples_leaf': 3}. Best is trial 3 with value: 0.5013977476934207.
X_train.shape: (6028, 135)
X_train nan: 19 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
y_train shape: (6028,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6028, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 293], y_pred bincount: [904 302]
[CV] Fold 0: AUC = 0.5092987525653343
[CV] Fold 1: y_val bincount: [913 293], y_pred bincount: [983 223]
[CV] Fold 1: AUC = 0.5203600626520977
[CV] Fold 2: y_val bincount: [913 293], y_pred bincount: [933 273]
[CV] Fold 2: AUC = 0.48903027561689516
[CV] Fold 3: y_val bincount: [912 293], y_pred bincount: [987 218]
[CV] Fold 3: AUC = 0.48684958984491955
[CV] Fold 4: y_val bincount: [912 293], y_pred bincount: [924 281]
[CV] Fold 4: AUC = 0.4669817675588288
manual auc_list: [np.float64(0.5092987525653343), np.float64(0.5203600626520977), np.float64(0.48903027561689516), np.float64(0.48684958984491955), np.float64(0.4669817675588288)]
manual auc mean (ignore nan): 0.49450408964761505
cross_val_score: [0.50929875 0.52036006 0.48903028 0.48684959 0.46698177]
X_train.shape: (6028, 135)
X_train nan: 19 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
y_train shape: (6028,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6028, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 293], y_pred bincount: [1189   17]
[CV] Fold 0: AUC = 0.5128874168719557
[CV] Fold 1: y_val bincount: [913 293], y_pred bincount: [1195   11]
[CV] Fold 1: AUC = 0.5274028163538422
[CV] Fold 2: y_val bincount: [913 293], y_pred bincount: [1190   16]
[CV] Fold 2: AUC = 0.4905479815632371
[CV] Fold 3: y_val bincount: [912 293], y_pred bincount: [1185   20]
[CV] Fold 3: AUC = 0.4943753368061793
[CV] Fold 4: y_val bincount: [912 293], y_pred bincount: [1183   22]
[CV] Fold 4: AUC = 0.45519355128435424
manual auc_list: [np.float64(0.5128874168719557), np.float64(0.5274028163538422), np.float64(0.4905479815632371), np.float64(0.4943753368061793), np.float64(0.45519355128435424)]
manual auc mean (ignore nan): 0.4960814205759137
cross_val_score: [0.51288742 0.52740282 0.49054798 0.49437534 0.45519355]
X_train.shape: (6028, 135)
X_train nan: 19 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
y_train shape: (6028,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6028, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 293], y_pred bincount: [1194   12]
[CV] Fold 0: AUC = 0.5340904418169109
[CV] Fold 1: y_val bincount: [913 293], y_pred bincount: [1193   13]
[CV] Fold 1: AUC = 0.5018522741290947
[CV] Fold 2: y_val bincount: [913 293], y_pred bincount: [1186   20]
[CV] Fold 2: AUC = 0.48503041019180665
[CV] Fold 3: y_val bincount: [912 293], y_pred bincount: [1191   14]
[CV] Fold 3: AUC = 0.47472456739117413
[CV] Fold 4: y_val bincount: [912 293], y_pred bincount: [1193   12]
[CV] Fold 4: AUC = 0.4796157415723609
manual auc_list: [np.float64(0.5340904418169109), np.float64(0.5018522741290947), np.float64(0.48503041019180665), np.float64(0.47472456739117413), np.float64(0.4796157415723609)]
manual auc mean (ignore nan): 0.49506268702026945
cross_val_score: [0.53409044 0.50185227 0.48503041 0.47472457 0.47961574]
X_train.shape: (6028, 135)
X_train nan: 19 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
y_train shape: (6028,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6028, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 293], y_pred bincount: [1177   29]
[CV] Fold 0: AUC = 0.5085174704402469
[CV] Fold 1: y_val bincount: [913 293], y_pred bincount: [1185   21]
[CV] Fold 1: AUC = 0.5347371490305
[CV] Fold 2: y_val bincount: [913 293], y_pred bincount: [1175   31]
[CV] Fold 2: AUC = 0.4976916664486054
[CV] Fold 3: y_val bincount: [912 293], y_pred bincount: [1183   22]
[CV] Fold 3: AUC = 0.49891847793545296
[CV] Fold 4: y_val bincount: [912 293], y_pred bincount: [1181   24]
[CV] Fold 4: AUC = 0.4671239746122987
manual auc_list: [np.float64(0.5085174704402469), np.float64(0.5347371490305), np.float64(0.4976916664486054), np.float64(0.49891847793545296), np.float64(0.4671239746122987)]
manual auc mean (ignore nan): 0.5013977476934207
cross_val_score: [0.50851747 0.53473715 0.49769167 0.49891848 0.46712397]
X_train.shape: (6028, 135)
X_train nan: 19 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
y_train shape: (6028,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6028, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 293], y_pred bincount: [1179   27]
[CV] Fold 0: AUC = 0.526210333110288
[CV] Fold 1: y_val bincount: [913 293], y_pred bincount: [1185   21]
[CV] Fold 1: AUC = 0.5178367830615045
[CV] Fold 2: y_val bincount: [913 293], y_pred bincount: [1170   36]
[CV] Fold 2: AUC = 0.4825781562489486
[CV] Fold 3: y_val bincount: [912 293], y_pred bincount: [1175   30]
[CV] Fold 3: AUC = 0.5016990000598766
[I 2025-08-12 14:58:28,972] Trial 4 finished with value: 0.5011516516938961 and parameters: {'n_estimators': 118, 'max_depth': 20, 'min_samples_split': 9, 'min_samples_leaf': 4}. Best is trial 3 with value: 0.5013977476934207.
[I 2025-08-12 14:59:18,638] Trial 5 finished with value: 0.4942792431381059 and parameters: {'n_estimators': 246, 'max_depth': 18, 'min_samples_split': 7, 'min_samples_leaf': 4}. Best is trial 3 with value: 0.5013977476934207.
[I 2025-08-12 14:59:52,069] Trial 6 finished with value: 0.49652345276069737 and parameters: {'n_estimators': 164, 'max_depth': 17, 'min_samples_split': 3, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.5013977476934207.
[I 2025-08-12 15:00:31,428] Trial 7 finished with value: 0.49952465937693 and parameters: {'n_estimators': 198, 'max_depth': 18, 'min_samples_split': 9, 'min_samples_leaf': 4}. Best is trial 3 with value: 0.5013977476934207.
[I 2025-08-12 15:01:28,826] Trial 8 finished with value: 0.49523895260975975 and parameters: {'n_estimators': 285, 'max_depth': 16, 'min_samples_split': 3, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.5013977476934207.
[CV] Fold 4: y_val bincount: [912 293], y_pred bincount: [1173   32]
[CV] Fold 4: AUC = 0.47743398598886294
manual auc_list: [np.float64(0.526210333110288), np.float64(0.5178367830615045), np.float64(0.4825781562489486), np.float64(0.5016990000598766), np.float64(0.47743398598886294)]
manual auc mean (ignore nan): 0.5011516516938961
cross_val_score: [0.52621033 0.51783678 0.48257816 0.501699   0.47743399]
X_train.shape: (6028, 135)
X_train nan: 19 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
y_train shape: (6028,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6028, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 293], y_pred bincount: [1178   28]
[CV] Fold 0: AUC = 0.5103903046252649
[CV] Fold 1: y_val bincount: [913 293], y_pred bincount: [1187   19]
[CV] Fold 1: AUC = 0.5233319252810186
[CV] Fold 2: y_val bincount: [913 293], y_pred bincount: [1183   23]
[CV] Fold 2: AUC = 0.4863761593067897
[CV] Fold 3: y_val bincount: [912 293], y_pred bincount: [1180   25]
[CV] Fold 3: AUC = 0.48355263157894735
[CV] Fold 4: y_val bincount: [912 293], y_pred bincount: [1178   27]
[CV] Fold 4: AUC = 0.467745194898509
manual auc_list: [np.float64(0.5103903046252649), np.float64(0.5233319252810186), np.float64(0.4863761593067897), np.float64(0.48355263157894735), np.float64(0.467745194898509)]
manual auc mean (ignore nan): 0.4942792431381059
cross_val_score: [0.5103903  0.52333193 0.48637616 0.48355263 0.46774519]
X_train.shape: (6028, 135)
X_train nan: 19 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
y_train shape: (6028,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6028, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 293], y_pred bincount: [1188   18]
[CV] Fold 0: AUC = 0.5152835979350228
[CV] Fold 1: y_val bincount: [913 293], y_pred bincount: [1193   13]
[CV] Fold 1: AUC = 0.5277579445925185
[CV] Fold 2: y_val bincount: [913 293], y_pred bincount: [1188   18]
[CV] Fold 2: AUC = 0.47554287893117614
[CV] Fold 3: y_val bincount: [912 293], y_pred bincount: [1192   13]
[CV] Fold 3: AUC = 0.49451380156876834
[CV] Fold 4: y_val bincount: [912 293], y_pred bincount: [1181   24]
[CV] Fold 4: AUC = 0.4695190407760015
manual auc_list: [np.float64(0.5152835979350228), np.float64(0.5277579445925185), np.float64(0.47554287893117614), np.float64(0.49451380156876834), np.float64(0.4695190407760015)]
manual auc mean (ignore nan): 0.49652345276069737
cross_val_score: [0.5152836  0.52775794 0.47554288 0.4945138  0.46951904]
X_train.shape: (6028, 135)
X_train nan: 19 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
y_train shape: (6028,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6028, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 293], y_pred bincount: [1173   33]
[CV] Fold 0: AUC = 0.5290588354036687
[CV] Fold 1: y_val bincount: [913 293], y_pred bincount: [1179   27]
[CV] Fold 1: AUC = 0.5208871477221327
[CV] Fold 2: y_val bincount: [913 293], y_pred bincount: [1180   26]
[CV] Fold 2: AUC = 0.4964468485172462
[CV] Fold 3: y_val bincount: [912 293], y_pred bincount: [1186   19]
[CV] Fold 3: AUC = 0.48421501706484643
[CV] Fold 4: y_val bincount: [912 293], y_pred bincount: [1168   37]
[CV] Fold 4: AUC = 0.4670154481767559
manual auc_list: [np.float64(0.5290588354036687), np.float64(0.5208871477221327), np.float64(0.4964468485172462), np.float64(0.48421501706484643), np.float64(0.4670154481767559)]
manual auc mean (ignore nan): 0.49952465937693
cross_val_score: [0.52905884 0.52088715 0.49644685 0.48421502 0.46701545]
X_train.shape: (6028, 135)
X_train nan: 19 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
y_train shape: (6028,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6028, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 293], y_pred bincount: [1188   18]
[CV] Fold 0: AUC = 0.503964352601221
[CV] Fold 1: y_val bincount: [913 293], y_pred bincount: [1202    4]
[CV] Fold 1: AUC = 0.5341726820406043
[CV] Fold 2: y_val bincount: [913 293], y_pred bincount: [1189   17]
[CV] Fold 2: AUC = 0.48111278499041155
[CV] Fold 3: y_val bincount: [912 293], y_pred bincount: [1197    8]
[CV] Fold 3: AUC = 0.48733982995030234
[CV] Fold 4: y_val bincount: [912 293], y_pred bincount: [1194   11]
[CV] Fold 4: AUC = 0.46960511346625955
manual auc_list: [np.float64(0.503964352601221), np.float64(0.5341726820406043), np.float64(0.48111278499041155), np.float64(0.48733982995030234), np.float64(0.46960511346625955)]
manual auc mean (ignore nan): 0.49523895260975975
cross_val_score: [0.50396435 0.53417268 0.48111278 0.48733983 0.46960511]
X_train.shape: (6028, 135)
X_train nan: 19 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
y_train shape: (6028,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6028, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[I 2025-08-12 15:02:18,906] Trial 9 finished with value: 0.4944184711148922 and parameters: {'n_estimators': 248, 'max_depth': 18, 'min_samples_split': 3, 'min_samples_leaf': 4}. Best is trial 3 with value: 0.5013977476934207.
2025-08-12 15:02:18,906 - INFO - Best hyperparameters: {'n_estimators': 285, 'max_depth': 17, 'min_samples_split': 9, 'min_samples_leaf': 3}
2025-08-12 15:02:18,906 - INFO - Selected features (from input): ['steering_speed_pred_error', 'Lateral_SampleEntropy', 'steering_pred_error', 'lat_acc_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'SteeringSpeed_Skewness', 'LongAcc_Kurtosis', 'Lateral_Kurtosis', 'Steering_Kurtosis']
2025-08-12 15:02:26,108 - INFO - Saving RF with 10 features.
2025-08-12 15:02:26,741 - INFO - RF (Optuna) metrics: train acc=0.997, val acc=0.788, test acc=0.750
2025-08-12 15:02:26,782 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.76      0.98      0.86       581
         1.0       0.26      0.03      0.05       182

    accuracy                           0.75       763
   macro avg       0.51      0.50      0.45       763
weighted avg       0.64      0.75      0.66       763

2025-08-12 15:02:28,189 - INFO - Optimal threshold for F1: 0.323
2025-08-12 15:02:28,201 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.3506666666666667, "precision": 0.21525423728813559, "recall": 0.8410596026490066, "f1": 0.3427800269905533}
2025-08-12 15:02:28,202 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.3486238532110092, "precision": 0.2463768115942029, "recall": 0.8406593406593407, "f1": 0.38107098381070986}
2025-08-12 15:02:28,223 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_finetune_mmd_biased_anti_pretrain_finetune.csv
[CV] Fold 0: y_val bincount: [913 293], y_pred bincount: [1179   27]
[CV] Fold 0: AUC = 0.510685621792164
[CV] Fold 1: y_val bincount: [913 293], y_pred bincount: [1190   16]
[CV] Fold 1: AUC = 0.523477714768475
[CV] Fold 2: y_val bincount: [913 293], y_pred bincount: [1184   22]
[CV] Fold 2: AUC = 0.48586776519668506
[CV] Fold 3: y_val bincount: [912 293], y_pred bincount: [1181   24]
[CV] Fold 3: AUC = 0.4834777857613317
[CV] Fold 4: y_val bincount: [912 293], y_pred bincount: [1178   27]
[CV] Fold 4: AUC = 0.46858346805580503
manual auc_list: [np.float64(0.510685621792164), np.float64(0.523477714768475), np.float64(0.48586776519668506), np.float64(0.4834777857613317), np.float64(0.46858346805580503)]
manual auc mean (ignore nan): 0.4944184711148922
cross_val_score: [0.51068562 0.52347771 0.48586777 0.48347779 0.46858347]

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=954796kb,walltime=00:09:31,ncpus=8,cpupercent=99,vmem=2384896kb
============================================================================================
