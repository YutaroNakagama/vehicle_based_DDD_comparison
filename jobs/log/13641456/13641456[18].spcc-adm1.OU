=== JOB INFO ===
IDX=18
NAME(line)=results/ranks/wasserstein_std_middle.txt
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/results/ranks/wasserstein_std_middle.txt
BASENAME=wasserstein_std_middle
TARGETS(first few)=S0181_1 S0120_2 S0154_2 S0136_1 S0199_1 S0148_2 S0136_2 S0196_1 S0139_1 S0204_1
[PRETRAIN] pretrain_setting exists. Reusing: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_std_middle.pkl
----- RUN: EVAL-ONLY (no fine-tune) -----
2025-08-16 19:03:06.926985: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:07.359835: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:07.693783: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755338587.967997 2639333 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755338588.051885 2639333 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755338588.714121 2639333 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.714160 2639333 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.714163 2639333 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.714165 2639333 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 19:03:08.785518: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 19:03:14,908 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_std_middle | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 19:03:14,909 - INFO - Model type: common
2025-08-16 19:03:14,909 - INFO - Finetuning with target subjects: ['S0181_1', 'S0120_2', 'S0154_2', 'S0136_1', 'S0199_1', 'S0148_2', 'S0136_2', 'S0196_1', 'S0139_1', 'S0204_1']
2025-08-16 19:03:14,981 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 19:03:15,024 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 19:03:15,090 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 19:03:15,132 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 19:03:15,189 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 19:03:15,232 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 19:03:15,276 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 19:03:15,326 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 19:03:15,373 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 19:03:15,436 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 19:03:15,478 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 19:03:15,508 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 19:03:15,570 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 19:03:15,611 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 19:03:15,654 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 19:03:15,701 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 19:03:15,747 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 19:03:15,791 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 19:03:15,837 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 19:03:15,880 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 19:03:15,924 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 19:03:15,973 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 19:03:16,011 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 19:03:16,056 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 19:03:16,100 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 19:03:16,142 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 19:03:16,182 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 19:03:16,226 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 19:03:16,270 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 19:03:16,312 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 19:03:16,354 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 19:03:16,398 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 19:03:16,442 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 19:03:16,501 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 19:03:16,525 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 19:03:16,548 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 19:03:16,601 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 19:03:16,653 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 19:03:16,677 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 19:03:16,699 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 19:03:16,723 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 19:03:16,761 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 19:03:16,801 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 19:03:16,845 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 19:03:16,888 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 19:03:16,932 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 19:03:16,974 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 19:03:17,015 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 19:03:17,057 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 19:03:17,099 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 19:03:17,141 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 19:03:17,184 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 19:03:17,241 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 19:03:17,296 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 19:03:17,352 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 19:03:17,407 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 19:03:17,428 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 19:03:17,477 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 19:03:17,500 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 19:03:17,522 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 19:03:17,544 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 19:03:17,566 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 19:03:17,607 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 19:03:17,650 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 19:03:17,691 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 19:03:17,730 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 19:03:17,769 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 19:03:17,824 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 19:03:17,846 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 19:03:17,868 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 19:03:17,916 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 19:03:17,954 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 19:03:17,993 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 19:03:18,032 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 19:03:18,072 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 19:03:18,109 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 19:03:18,145 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 19:03:18,190 - INFO - [EvalOnly] Found existing pretrained model/scaler. Skipping retrain.
2025-08-16 19:03:18,519 - INFO - [EvalOnly] Loaded model features: ./model/common/selected_features_train_RF_pretrain_general.pkl (10 cols)
2025-08-16 19:03:18,545 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 19:03:18,570 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 19:03:18,590 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 19:03:18,612 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 19:03:18,634 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 19:03:18,656 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 19:03:18,677 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 19:03:18,701 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 19:03:18,726 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 19:03:18,751 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 19:03:18,792 - WARNING - [EvalOnly] feature mismatch before alignment: missing_in_val=[] extra_in_val=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 19:03:18,792 - WARNING - [EvalOnly] feature mismatch (test) before alignment: missing_in_test=[] extra_in_test=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 19:03:18,797 - INFO - [EvalOnly] scaler expects n_features=10, aligned_features=10
2025-08-16 19:03:19,130 - INFO - [EvalOnly] val pos_ratio=0.201, pred_pos_ratio=0.122
2025-08-16 19:03:19,130 - INFO - [EvalOnly] test pos_ratio=0.243, pred_pos_ratio=0.119
2025-08-16 19:03:19,131 - INFO - [EvalOnly] val CM=
[[606   4]
 [ 64  89]]
2025-08-16 19:03:19,133 - INFO - [EvalOnly] test CM=
[[579   6]
 [102  86]]
2025-08-16 19:03:19,133 - INFO - [EvalOnly] RF on targets: val acc=0.911 auc=0.850 ap=0.769 | test acc=0.860 auc=0.802 ap=0.714
2025-08-16 19:03:19,137 - INFO - [EvalOnly] Saved -> ./model/common/metrics_RF_rank_wasserstein_std_middle_evalonly_on_targets.csv
----- RUN: FINE-TUNE (use target-train) -----
2025-08-16 19:03:21.379320: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:21.382532: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:21.392965: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755338601.409982 2639357 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755338601.415158 2639357 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755338601.428985 2639357 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338601.429017 2639357 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338601.429019 2639357 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338601.429021 2639357 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 19:03:21.433085: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 19:03:23,958 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_std_middle | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 19:03:23,959 - INFO - Model type: common
2025-08-16 19:03:23,959 - INFO - Finetuning with target subjects: ['S0181_1', 'S0120_2', 'S0154_2', 'S0136_1', 'S0199_1', 'S0148_2', 'S0136_2', 'S0196_1', 'S0139_1', 'S0204_1']
2025-08-16 19:03:23,984 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 19:03:24,009 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 19:03:24,034 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 19:03:24,058 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 19:03:24,082 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 19:03:24,106 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 19:03:24,130 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 19:03:24,154 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 19:03:24,178 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 19:03:24,202 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 19:03:24,225 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 19:03:24,249 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 19:03:24,272 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 19:03:24,295 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 19:03:24,318 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 19:03:24,341 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 19:03:24,364 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 19:03:24,387 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 19:03:24,410 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 19:03:24,433 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 19:03:24,456 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 19:03:24,478 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 19:03:24,501 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 19:03:24,523 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 19:03:24,546 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 19:03:24,568 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 19:03:24,591 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 19:03:24,613 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 19:03:24,636 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 19:03:24,658 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 19:03:24,681 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 19:03:24,703 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 19:03:24,725 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 19:03:24,748 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 19:03:24,770 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 19:03:24,792 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 19:03:24,814 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 19:03:24,836 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 19:03:24,858 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 19:03:24,880 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 19:03:24,906 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 19:03:24,928 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 19:03:24,950 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 19:03:24,972 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 19:03:24,994 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 19:03:25,016 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 19:03:25,038 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 19:03:25,059 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 19:03:25,081 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 19:03:25,103 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 19:03:25,124 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 19:03:25,146 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 19:03:25,168 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 19:03:25,190 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 19:03:25,211 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 19:03:25,233 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 19:03:25,254 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 19:03:25,276 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 19:03:25,298 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 19:03:25,319 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 19:03:25,341 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 19:03:25,362 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 19:03:25,383 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 19:03:25,405 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 19:03:25,426 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 19:03:25,447 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 19:03:25,468 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 19:03:25,490 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 19:03:25,511 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 19:03:25,532 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 19:03:25,552 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 19:03:25,573 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 19:03:25,594 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 19:03:25,614 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 19:03:25,635 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 19:03:25,655 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 19:03:25,674 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 19:03:25,712 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_std_middle.pkl: features=['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
2025-08-16 19:03:25,735 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 19:03:25,759 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 19:03:25,778 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 19:03:25,798 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 19:03:25,819 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 19:03:25,838 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 19:03:25,858 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 19:03:25,881 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 19:03:25,905 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 19:03:25,932 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 19:03:25,970 - INFO - [split:finetune_setting] global  : n=7664, pos=1676, pos_ratio=0.219
2025-08-16 19:03:25,970 - INFO - [split:finetune_setting] train   : n=6128, pos=1335, pos_ratio=0.218, |Δ|=0.001
2025-08-16 19:03:25,970 - INFO - [split:finetune_setting] val     : n=763, pos=153, pos_ratio=0.201, |Δ|=0.018
2025-08-16 19:03:25,970 - INFO - [split:finetune_setting] test    : n=773, pos=188, pos_ratio=0.243, |Δ|=0.025
[I 2025-08-16 19:03:25,972] A new study created in memory with name: no-name-7f24204b-e605-4925-adfb-0290a3ca8eea
[I 2025-08-16 19:04:16,136] Trial 0 finished with value: 0.5306664997844628 and parameters: {'n_estimators': 257, 'max_depth': 27, 'min_samples_split': 5, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.5306664997844628.
[I 2025-08-16 19:04:50,035] Trial 1 finished with value: 0.5288532131024837 and parameters: {'n_estimators': 174, 'max_depth': 28, 'min_samples_split': 4, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.5306664997844628.
[I 2025-08-16 19:05:12,468] Trial 2 finished with value: 0.5279920127118123 and parameters: {'n_estimators': 124, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.5306664997844628.
[I 2025-08-16 19:05:48,567] Trial 3 finished with value: 0.5245208987469298 and parameters: {'n_estimators': 203, 'max_depth': 14, 'min_samples_split': 6, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.5306664997844628.
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1214   12]
[CV] Fold 0: AUC = 0.5091172530687006
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1214   12]
[CV] Fold 1: AUC = 0.5158150851581509
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1211   15]
[CV] Fold 2: AUC = 0.5619344432597938
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1206   19]
[CV] Fold 3: AUC = 0.5414604395862166
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1213   12]
[CV] Fold 4: AUC = 0.5250052778494523
manual auc_list: [np.float64(0.5091172530687006), np.float64(0.5158150851581509), np.float64(0.5619344432597938), np.float64(0.5414604395862166), np.float64(0.5250052778494523)]
manual auc mean (ignore nan): 0.5306664997844628
cross_val_score: [0.50911725 0.51581509 0.56193444 0.54146044 0.52500528]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1215   11]
[CV] Fold 0: AUC = 0.5115386267686768
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1215   11]
[CV] Fold 1: AUC = 0.5112730567499697
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1210   16]
[CV] Fold 2: AUC = 0.5493237728126599
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1203   22]
[CV] Fold 3: AUC = 0.542089872002377
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1206   19]
[CV] Fold 4: AUC = 0.5300407371787355
manual auc_list: [np.float64(0.5115386267686768), np.float64(0.5112730567499697), np.float64(0.5493237728126599), np.float64(0.542089872002377), np.float64(0.5300407371787355)]
manual auc mean (ignore nan): 0.5288532131024837
cross_val_score: [0.51153863 0.51127306 0.54932377 0.54208987 0.53004074]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1196   30]
[CV] Fold 0: AUC = 0.5149910370118685
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1201   25]
[CV] Fold 1: AUC = 0.5242274060448422
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1198   28]
[CV] Fold 2: AUC = 0.5344713789723221
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1179   46]
[CV] Fold 3: AUC = 0.541433072959427
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1195   30]
[CV] Fold 4: AUC = 0.5248371685706019
manual auc_list: [np.float64(0.5149910370118685), np.float64(0.5242274060448422), np.float64(0.5344713789723221), np.float64(0.541433072959427), np.float64(0.5248371685706019)]
manual auc mean (ignore nan): 0.5279920127118123
cross_val_score: [0.51499104 0.52422741 0.53447138 0.54143307 0.52483717]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1197   29]
[CV] Fold 0: AUC = 0.5011579633903919
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1206   20]
[CV] Fold 1: AUC = 0.5135733617649471
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1203   23]
[CV] Fold 2: AUC = 0.5376543137553553
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1184   41]
[CV] Fold 3: AUC = 0.5393805759502084
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1199   26]
[CV] Fold 4: AUC = 0.530838278873746
manual auc_list: [np.float64(0.5011579633903919), np.float64(0.5135733617649471), np.float64(0.5376543137553553), np.float64(0.5393805759502084), np.float64(0.530838278873746)]
manual auc mean (ignore nan): 0.5245208987469298
cross_val_score: [0.50115796 0.51357336 0.53765431 0.53938058 0.53083828]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: [I 2025-08-16 19:06:30,616] Trial 4 finished with value: 0.52697012745771 and parameters: {'n_estimators': 202, 'max_depth': 29, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.5306664997844628.
[I 2025-08-16 19:07:17,214] Trial 5 finished with value: 0.5321004319410092 and parameters: {'n_estimators': 240, 'max_depth': 28, 'min_samples_split': 9, 'min_samples_leaf': 5}. Best is trial 5 with value: 0.5321004319410092.
[I 2025-08-16 19:08:02,535] Trial 6 finished with value: 0.522702399645911 and parameters: {'n_estimators': 222, 'max_depth': 21, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 5 with value: 0.5321004319410092.
[I 2025-08-16 19:08:43,270] Trial 7 finished with value: 0.5304545011708864 and parameters: {'n_estimators': 212, 'max_depth': 21, 'min_samples_split': 7, 'min_samples_leaf': 5}. Best is trial 5 with value: 0.5321004319410092.
['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1226]
[CV] Fold 0: AUC = 0.5183262840115133
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1219    7]
[CV] Fold 1: AUC = 0.5069302058558189
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1224    2]
[CV] Fold 2: AUC = 0.5518779315219896
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1218    7]
[CV] Fold 3: AUC = 0.5402954031886029
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1223    2]
[CV] Fold 4: AUC = 0.5174208127106252
manual auc_list: [np.float64(0.5183262840115133), np.float64(0.5069302058558189), np.float64(0.5518779315219896), np.float64(0.5402954031886029), np.float64(0.5174208127106252)]
manual auc mean (ignore nan): 0.52697012745771
cross_val_score: [0.51832628 0.50693021 0.55187793 0.5402954  0.51742081]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1214   12]
[CV] Fold 0: AUC = 0.5153425267425102
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1215   11]
[CV] Fold 1: AUC = 0.514620020073969
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1211   15]
[CV] Fold 2: AUC = 0.5572830624909686
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1204   21]
[CV] Fold 3: AUC = 0.541781020071466
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1207   18]
[CV] Fold 4: AUC = 0.5314755303261319
manual auc_list: [np.float64(0.5153425267425102), np.float64(0.514620020073969), np.float64(0.5572830624909686), np.float64(0.541781020071466), np.float64(0.5314755303261319)]
manual auc mean (ignore nan): 0.5321004319410092
cross_val_score: [0.51534253 0.51462002 0.55728306 0.54178102 0.53147553]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1225    1]
[CV] Fold 0: AUC = 0.5182872295969975
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1225    1]
[CV] Fold 1: AUC = 0.4964284737925351
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1224    2]
[CV] Fold 2: AUC = 0.5516514159177983
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1222    3]
[CV] Fold 3: AUC = 0.5227729430070449
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1223    2]
[CV] Fold 4: AUC = 0.524371935915179
manual auc_list: [np.float64(0.5182872295969975), np.float64(0.4964284737925351), np.float64(0.5516514159177983), np.float64(0.5227729430070449), np.float64(0.524371935915179)]
manual auc mean (ignore nan): 0.522702399645911
cross_val_score: [0.51828723 0.49642847 0.55165142 0.52277294 0.52437194]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1210   16]
[CV] Fold 0: AUC = 0.5168656489086244
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1208   18]
[CV] Fold 1: AUC = 0.5162798326908882
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1213   13]
[CV] Fold 2: AUC = 0.5504680671579713
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1197   28]
[CV] Fold 3: AUC = 0.5449360011884935
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1209   16]
[CV] Fold 4: AUC = 0.5237229559084547
manual auc_list: [np.float64(0.5168656489086244), np.float64(0.5162798326908882), np.float64(0.5504680671579713), np.float64(0.5449360011884935), np.float64(0.5237229559084547)]
manual auc mean (ignore nan): 0.5304545011708864
cross_val_score: [0.51686565 0.51627983 0.55046807 0.544936   0.52372296]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1116  110]
[CV] Fold 0: AUC = 0.5022163380237685
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1151   75]
[CV] Fold 1: AUC = 0.5076136581098445
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1141   85]
[CV] Fold 2: AUC = 0.5672341273095804
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1097  128]
[I 2025-08-16 19:09:08,488] Trial 8 finished with value: 0.5243796954321509 and parameters: {'n_estimators': 169, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 5 with value: 0.5321004319410092.
[I 2025-08-16 19:09:39,214] Trial 9 finished with value: 0.5320166989501546 and parameters: {'n_estimators': 154, 'max_depth': 29, 'min_samples_split': 7, 'min_samples_leaf': 4}. Best is trial 5 with value: 0.5321004319410092.
2025-08-16 19:09:39,214 - INFO - Best hyperparameters: {'n_estimators': 240, 'max_depth': 28, 'min_samples_split': 9, 'min_samples_leaf': 5}
2025-08-16 19:09:39,214 - INFO - Selected features (from input): ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
2025-08-16 19:09:39,977 - INFO - Saving RF with 10 features.
2025-08-16 19:09:40,610 - INFO - RF (Optuna) metrics: train acc=0.999, val acc=0.786, test acc=0.755
2025-08-16 19:09:40,682 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.76      0.99      0.86       585
         1.0       0.40      0.01      0.02       188

    accuracy                           0.76       773
   macro avg       0.58      0.50      0.44       773
weighted avg       0.67      0.76      0.66       773

2025-08-16 19:09:41,998 - INFO - Optimal threshold for F1: 0.204
2025-08-16 19:09:42,009 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.22280471821756226, "precision": 0.20270270270270271, "recall": 0.9803921568627451, "f1": 0.335946248600224}
2025-08-16 19:09:42,009 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.2626131953428202, "precision": 0.2418918918918919, "recall": 0.9521276595744681, "f1": 0.3857758620689655}
2025-08-16 19:09:42,016 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_rank_wasserstein_std_middle.csv
[CV] Fold 3: AUC = 0.5206461651536832
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1133   92]
[CV] Fold 4: AUC = 0.5241881885638777
manual auc_list: [np.float64(0.5022163380237685), np.float64(0.5076136581098445), np.float64(0.5672341273095804), np.float64(0.5206461651536832), np.float64(0.5241881885638777)]
manual auc mean (ignore nan): 0.5243796954321509
cross_val_score: [0.50221634 0.50761366 0.56723413 0.52064617 0.52418819]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1218    8]
[CV] Fold 0: AUC = 0.5215014079116433
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1214   12]
[CV] Fold 1: AUC = 0.5180333759026452
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1217    9]
[CV] Fold 2: AUC = 0.5630240614247831
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1210   15]
[CV] Fold 3: AUC = 0.5431454418928323
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1216    9]
[CV] Fold 4: AUC = 0.5143792076188689
manual auc_list: [np.float64(0.5215014079116433), np.float64(0.5180333759026452), np.float64(0.5630240614247831), np.float64(0.5431454418928323), np.float64(0.5143792076188689)]
manual auc mean (ignore nan): 0.5320166989501546
cross_val_score: [0.52150141 0.51803338 0.56302406 0.54314544 0.51437921]
=== DONE (BASENAME=wasserstein_std_middle) ===

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=869176kb,walltime=00:06:43,ncpus=8,cpupercent=101,vmem=2284572kb
============================================================================================
