=== JOB INFO ===
IDX=17
NAME(line)=results/ranks/wasserstein_std_low.txt
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/results/ranks/wasserstein_std_low.txt
BASENAME=wasserstein_std_low
TARGETS(first few)=S0186_1 S0156_2 S0156_1 S0186_2 S0134_2 S0191_2 S0209_2 S0206_1 S0139_2 S0206_2
[PRETRAIN] pretrain_setting exists. Reusing: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_std_low.pkl
----- RUN: EVAL-ONLY (no fine-tune) -----
2025-08-16 19:03:06.926988: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:07.359835: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:07.693784: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755338587.967993 2639334 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755338588.051882 2639334 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755338588.714117 2639334 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.714150 2639334 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.714153 2639334 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.714155 2639334 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 19:03:08.785515: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 19:03:14,908 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_std_low | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 19:03:14,909 - INFO - Model type: common
2025-08-16 19:03:14,909 - INFO - Finetuning with target subjects: ['S0186_1', 'S0156_2', 'S0156_1', 'S0186_2', 'S0134_2', 'S0191_2', 'S0209_2', 'S0206_1', 'S0139_2', 'S0206_2']
2025-08-16 19:03:14,981 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 19:03:15,006 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 19:03:15,032 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 19:03:15,094 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 19:03:15,120 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 19:03:15,174 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 19:03:15,199 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 19:03:15,223 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 19:03:15,247 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 19:03:15,276 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 19:03:15,327 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 19:03:15,373 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 19:03:15,437 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 19:03:15,463 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 19:03:15,508 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 19:03:15,571 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 19:03:15,596 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 19:03:15,620 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 19:03:15,654 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 19:03:15,701 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 19:03:15,747 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 19:03:15,791 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 19:03:15,837 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 19:03:15,880 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 19:03:15,924 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 19:03:15,970 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 19:03:16,011 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 19:03:16,056 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 19:03:16,100 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 19:03:16,141 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 19:03:16,182 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 19:03:16,226 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 19:03:16,271 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 19:03:16,312 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 19:03:16,354 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 19:03:16,398 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 19:03:16,442 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 19:03:16,500 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 19:03:16,539 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 19:03:16,590 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 19:03:16,642 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 19:03:16,680 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 19:03:16,719 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 19:03:16,761 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 19:03:16,801 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 19:03:16,845 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 19:03:16,888 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 19:03:16,932 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 19:03:16,974 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 19:03:17,015 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 19:03:17,056 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 19:03:17,099 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 19:03:17,141 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 19:03:17,184 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 19:03:17,242 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 19:03:17,299 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 19:03:17,355 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 19:03:17,409 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 19:03:17,453 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 19:03:17,495 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 19:03:17,533 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 19:03:17,570 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 19:03:17,607 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 19:03:17,650 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 19:03:17,691 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 19:03:17,730 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 19:03:17,769 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 19:03:17,822 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 19:03:17,858 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 19:03:17,904 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 19:03:17,927 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 19:03:17,954 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 19:03:17,993 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 19:03:18,032 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 19:03:18,072 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 19:03:18,109 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 19:03:18,145 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 19:03:18,190 - INFO - [EvalOnly] Found existing pretrained model/scaler. Skipping retrain.
2025-08-16 19:03:18,519 - INFO - [EvalOnly] Loaded model features: ./model/common/selected_features_train_RF_pretrain_general.pkl (10 cols)
2025-08-16 19:03:18,541 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 19:03:18,561 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 19:03:18,582 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 19:03:18,603 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 19:03:18,628 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 19:03:18,649 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 19:03:18,670 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 19:03:18,692 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 19:03:18,713 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 19:03:18,734 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 19:03:18,786 - WARNING - [EvalOnly] feature mismatch before alignment: missing_in_val=[] extra_in_val=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 19:03:18,786 - WARNING - [EvalOnly] feature mismatch (test) before alignment: missing_in_test=[] extra_in_test=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 19:03:18,791 - INFO - [EvalOnly] scaler expects n_features=10, aligned_features=10
2025-08-16 19:03:19,126 - INFO - [EvalOnly] val pos_ratio=0.189, pred_pos_ratio=0.087
2025-08-16 19:03:19,126 - INFO - [EvalOnly] test pos_ratio=0.163, pred_pos_ratio=0.086
2025-08-16 19:03:19,129 - INFO - [EvalOnly] val CM=
[[589   5]
 [ 79  59]]
2025-08-16 19:03:19,130 - INFO - [EvalOnly] test CM=
[[618   7]
 [ 65  57]]
2025-08-16 19:03:19,130 - INFO - [EvalOnly] RF on targets: val acc=0.885 auc=0.777 ap=0.656 | test acc=0.904 auc=0.786 ap=0.660
2025-08-16 19:03:19,136 - INFO - [EvalOnly] Saved -> ./model/common/metrics_RF_rank_wasserstein_std_low_evalonly_on_targets.csv
----- RUN: FINE-TUNE (use target-train) -----
2025-08-16 19:03:21.378783: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:21.382444: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:21.392908: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755338601.409947 2639358 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755338601.415129 2639358 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755338601.428985 2639358 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338601.429010 2639358 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338601.429013 2639358 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338601.429015 2639358 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 19:03:21.433079: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 19:03:23,958 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_std_low | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 19:03:23,958 - INFO - Model type: common
2025-08-16 19:03:23,958 - INFO - Finetuning with target subjects: ['S0186_1', 'S0156_2', 'S0156_1', 'S0186_2', 'S0134_2', 'S0191_2', 'S0209_2', 'S0206_1', 'S0139_2', 'S0206_2']
2025-08-16 19:03:23,984 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 19:03:24,009 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 19:03:24,033 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 19:03:24,058 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 19:03:24,083 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 19:03:24,107 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 19:03:24,131 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 19:03:24,155 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 19:03:24,179 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 19:03:24,203 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 19:03:24,228 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 19:03:24,252 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 19:03:24,276 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 19:03:24,300 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 19:03:24,323 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 19:03:24,347 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 19:03:24,370 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 19:03:24,394 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 19:03:24,417 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 19:03:24,441 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 19:03:24,464 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 19:03:24,487 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 19:03:24,510 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 19:03:24,532 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 19:03:24,555 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 19:03:24,578 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 19:03:24,600 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 19:03:24,623 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 19:03:24,645 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 19:03:24,668 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 19:03:24,690 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 19:03:24,713 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 19:03:24,736 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 19:03:24,758 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 19:03:24,781 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 19:03:24,803 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 19:03:24,825 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 19:03:24,847 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 19:03:24,870 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 19:03:24,896 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 19:03:24,919 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 19:03:24,941 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 19:03:24,963 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 19:03:24,985 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 19:03:25,007 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 19:03:25,029 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 19:03:25,051 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 19:03:25,073 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 19:03:25,095 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 19:03:25,117 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 19:03:25,138 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 19:03:25,160 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 19:03:25,182 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 19:03:25,204 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 19:03:25,225 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 19:03:25,247 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 19:03:25,269 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 19:03:25,290 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 19:03:25,311 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 19:03:25,333 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 19:03:25,354 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 19:03:25,376 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 19:03:25,397 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 19:03:25,419 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 19:03:25,440 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 19:03:25,462 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 19:03:25,483 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 19:03:25,504 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 19:03:25,525 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 19:03:25,546 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 19:03:25,567 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 19:03:25,588 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 19:03:25,609 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 19:03:25,629 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 19:03:25,650 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 19:03:25,670 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 19:03:25,689 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 19:03:25,727 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_std_low.pkl: features=['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
2025-08-16 19:03:25,747 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 19:03:25,767 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 19:03:25,787 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 19:03:25,808 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 19:03:25,831 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 19:03:25,851 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 19:03:25,871 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 19:03:25,891 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 19:03:25,911 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 19:03:25,931 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 19:03:25,965 - INFO - [split:finetune_setting] global  : n=7371, pos=1299, pos_ratio=0.176
2025-08-16 19:03:25,965 - INFO - [split:finetune_setting] train   : n=5892, pos=1039, pos_ratio=0.176, |Δ|=0.000
2025-08-16 19:03:25,965 - INFO - [split:finetune_setting] val     : n=732, pos=138, pos_ratio=0.189, |Δ|=0.012
2025-08-16 19:03:25,965 - INFO - [split:finetune_setting] test    : n=747, pos=122, pos_ratio=0.163, |Δ|=0.013
[I 2025-08-16 19:03:25,967] A new study created in memory with name: no-name-50a652ab-e274-42bb-b9b1-1c110612dbeb
[I 2025-08-16 19:03:58,815] Trial 0 finished with value: 0.538503537477688 and parameters: {'n_estimators': 180, 'max_depth': 17, 'min_samples_split': 8, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.538503537477688.
[I 2025-08-16 19:04:40,410] Trial 1 finished with value: 0.5383901555859031 and parameters: {'n_estimators': 230, 'max_depth': 19, 'min_samples_split': 5, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.538503537477688.
[I 2025-08-16 19:05:03,981] Trial 2 finished with value: 0.5304631134107733 and parameters: {'n_estimators': 140, 'max_depth': 14, 'min_samples_split': 10, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.538503537477688.
[I 2025-08-16 19:05:34,905] Trial 3 finished with value: 0.534119000199943 and parameters: {'n_estimators': 169, 'max_depth': 21, 'min_samples_split': 8, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.538503537477688.
X_train.shape: (5892, 135)
X_train nan: 20 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5892,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5892, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [971 208], y_pred bincount: [1172    7]
[CV] Fold 0: AUC = 0.5147597639229977
[CV] Fold 1: y_val bincount: [971 208], y_pred bincount: [1175    4]
[CV] Fold 1: AUC = 0.5467351263566506
[CV] Fold 2: y_val bincount: [971 207], y_pred bincount: [1171    7]
[CV] Fold 2: AUC = 0.542804121454549
[CV] Fold 3: y_val bincount: [970 208], y_pred bincount: [1169    9]
[CV] Fold 3: AUC = 0.5296788263283109
[CV] Fold 4: y_val bincount: [970 208], y_pred bincount: [1172    6]
[CV] Fold 4: AUC = 0.5585398493259317
manual auc_list: [np.float64(0.5147597639229977), np.float64(0.5467351263566506), np.float64(0.542804121454549), np.float64(0.5296788263283109), np.float64(0.5585398493259317)]
manual auc mean (ignore nan): 0.538503537477688
cross_val_score: [0.51475976 0.54673513 0.54280412 0.52967883 0.55853985]
X_train.shape: (5892, 135)
X_train nan: 20 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5892,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5892, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [971 208], y_pred bincount: [1171    8]
[CV] Fold 0: AUC = 0.4948259130159233
[CV] Fold 1: y_val bincount: [971 208], y_pred bincount: [1174    5]
[CV] Fold 1: AUC = 0.5471411312683198
[CV] Fold 2: y_val bincount: [971 207], y_pred bincount: [1169    9]
[CV] Fold 2: AUC = 0.546157405334408
[CV] Fold 3: y_val bincount: [970 208], y_pred bincount: [1167   11]
[CV] Fold 3: AUC = 0.5508475416336241
[CV] Fold 4: y_val bincount: [970 208], y_pred bincount: [1166   12]
[CV] Fold 4: AUC = 0.5529787866772403
manual auc_list: [np.float64(0.4948259130159233), np.float64(0.5471411312683198), np.float64(0.546157405334408), np.float64(0.5508475416336241), np.float64(0.5529787866772403)]
manual auc mean (ignore nan): 0.5383901555859031
cross_val_score: [0.49482591 0.54714113 0.54615741 0.55084754 0.55297879]
X_train.shape: (5892, 135)
X_train nan: 20 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5892,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5892, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [971 208], y_pred bincount: [1145   34]
[CV] Fold 0: AUC = 0.5078774855422641
[CV] Fold 1: y_val bincount: [971 208], y_pred bincount: [1154   25]
[CV] Fold 1: AUC = 0.541422403549077
[CV] Fold 2: y_val bincount: [971 207], y_pred bincount: [1136   42]
[CV] Fold 2: AUC = 0.5379334019910744
[CV] Fold 3: y_val bincount: [970 208], y_pred bincount: [1145   33]
[CV] Fold 3: AUC = 0.5162519825535289
[CV] Fold 4: y_val bincount: [970 208], y_pred bincount: [1153   25]
[CV] Fold 4: AUC = 0.5488302934179223
manual auc_list: [np.float64(0.5078774855422641), np.float64(0.541422403549077), np.float64(0.5379334019910744), np.float64(0.5162519825535289), np.float64(0.5488302934179223)]
manual auc mean (ignore nan): 0.5304631134107733
cross_val_score: [0.50787749 0.5414224  0.5379334  0.51625198 0.54883029]
X_train.shape: (5892, 135)
X_train nan: 20 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5892,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5892, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [971 208], y_pred bincount: [1172    7]
[CV] Fold 0: AUC = 0.49584092529509627
[CV] Fold 1: y_val bincount: [971 208], y_pred bincount: [1173    6]
[CV] Fold 1: AUC = 0.5464974649449418
[CV] Fold 2: y_val bincount: [971 207], y_pred bincount: [1170    8]
[CV] Fold 2: AUC = 0.545286745573317
[CV] Fold 3: y_val bincount: [970 208], y_pred bincount: [1168   10]
[CV] Fold 3: AUC = 0.5425307295796986
[CV] Fold 4: y_val bincount: [970 208], y_pred bincount: [1169    9]
[CV] Fold 4: AUC = 0.5404391356066613
manual auc_list: [np.float64(0.49584092529509627), np.float64(0.5464974649449418), np.float64(0.545286745573317), np.float64(0.5425307295796986), np.float64(0.5404391356066613)]
manual auc mean (ignore nan): 0.534119000199943
cross_val_score: [0.49584093 0.54649746 0.54528675 0.54253073 0.54043914]
X_train.shape: (5892, 135)
X_train nan: 20 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: [I 2025-08-16 19:06:03,892] Trial 4 finished with value: 0.5349203273229344 and parameters: {'n_estimators': 159, 'max_depth': 18, 'min_samples_split': 9, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.538503537477688.
[I 2025-08-16 19:06:47,999] Trial 5 finished with value: 0.5295909622244057 and parameters: {'n_estimators': 228, 'max_depth': 22, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.538503537477688.
[I 2025-08-16 19:07:35,115] Trial 6 finished with value: 0.5314425584249589 and parameters: {'n_estimators': 242, 'max_depth': 21, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.538503537477688.
[I 2025-08-16 19:07:55,566] Trial 7 finished with value: 0.5242254437609879 and parameters: {'n_estimators': 104, 'max_depth': 27, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.538503537477688.
['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5892,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5892, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [971 208], y_pred bincount: [1171    8]
[CV] Fold 0: AUC = 0.5092440386595897
[CV] Fold 1: y_val bincount: [971 208], y_pred bincount: [1175    4]
[CV] Fold 1: AUC = 0.5479828487681216
[CV] Fold 2: y_val bincount: [971 207], y_pred bincount: [1165   13]
[CV] Fold 2: AUC = 0.5419782384811713
[CV] Fold 3: y_val bincount: [970 208], y_pred bincount: [1168   10]
[CV] Fold 3: AUC = 0.5372075733544805
[CV] Fold 4: y_val bincount: [970 208], y_pred bincount: [1168   10]
[CV] Fold 4: AUC = 0.5381889373513085
manual auc_list: [np.float64(0.5092440386595897), np.float64(0.5479828487681216), np.float64(0.5419782384811713), np.float64(0.5372075733544805), np.float64(0.5381889373513085)]
manual auc mean (ignore nan): 0.5349203273229344
cross_val_score: [0.50924404 0.54798285 0.54197824 0.53720757 0.53818894]
X_train.shape: (5892, 135)
X_train nan: 20 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5892,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5892, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [971 208], y_pred bincount: [1178    1]
[CV] Fold 0: AUC = 0.5102095381446565
[CV] Fold 1: y_val bincount: [971 208], y_pred bincount: [1179]
[CV] Fold 1: AUC = 0.5405905886080963
[CV] Fold 2: y_val bincount: [971 207], y_pred bincount: [1178]
[CV] Fold 2: AUC = 0.5293959611337483
[CV] Fold 3: y_val bincount: [970 208], y_pred bincount: [1177    1]
[CV] Fold 3: AUC = 0.5276566217287867
[CV] Fold 4: y_val bincount: [970 208], y_pred bincount: [1178]
[CV] Fold 4: AUC = 0.5401021015067407
manual auc_list: [np.float64(0.5102095381446565), np.float64(0.5405905886080963), np.float64(0.5293959611337483), np.float64(0.5276566217287867), np.float64(0.5401021015067407)]
manual auc mean (ignore nan): 0.5295909622244057
cross_val_score: [0.51020954 0.54059059 0.52939596 0.52765662 0.5401021 ]
X_train.shape: (5892, 135)
X_train nan: 20 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5892,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5892, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [971 208], y_pred bincount: [1179]
[CV] Fold 0: AUC = 0.5207706171274658
[CV] Fold 1: y_val bincount: [971 208], y_pred bincount: [1179]
[CV] Fold 1: AUC = 0.5344262457418998
[CV] Fold 2: y_val bincount: [971 207], y_pred bincount: [1178]
[CV] Fold 2: AUC = 0.5304507032443271
[CV] Fold 3: y_val bincount: [970 208], y_pred bincount: [1177    1]
[CV] Fold 3: AUC = 0.5300158604282316
[CV] Fold 4: y_val bincount: [970 208], y_pred bincount: [1178]
[CV] Fold 4: AUC = 0.5415493655828707
manual auc_list: [np.float64(0.5207706171274658), np.float64(0.5344262457418998), np.float64(0.5304507032443271), np.float64(0.5300158604282316), np.float64(0.5415493655828707)]
manual auc mean (ignore nan): 0.5314425584249589
cross_val_score: [0.52077062 0.53442625 0.5304507  0.53001586 0.54154937]
X_train.shape: (5892, 135)
X_train nan: 20 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5892,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5892, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [971 208], y_pred bincount: [1175    4]
[CV] Fold 0: AUC = 0.508818228630278
[CV] Fold 1: y_val bincount: [971 208], y_pred bincount: [1178    1]
[CV] Fold 1: AUC = 0.5190079616572922
[CV] Fold 2: y_val bincount: [971 207], y_pred bincount: [1175    3]
[CV] Fold 2: AUC = 0.5418289825221272
[CV] Fold 3: y_val bincount: [970 208], y_pred bincount: [1177    1]
[CV] Fold 3: AUC = 0.5243705392545599
[CV] Fold 4: y_val bincount: [970 208], y_pred bincount: [1176    2]
[CV] Fold 4: AUC = 0.5271015067406819
manual auc_list: [np.float64(0.508818228630278), np.float64(0.5190079616572922), np.float64(0.5418289825221272), np.float64(0.5243705392545599), np.float64(0.5271015067406819)]
manual auc mean (ignore nan): 0.5242254437609879
cross_val_score: [0.50881823 0.51900796 0.54182898 0.52437054 0.52710151]
X_train.shape: (5892, 135)
X_train nan: 20 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5892,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5892, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [971 208], y_pred bincount: [1148   31]
[CV] Fold 0: AUC = 0.511244355541472
[CV] Fold 1: y_val bincount: [971 208], y_pred bincount: [1143   36]
[CV] Fold 1: AUC = 0.5480472154004594
[CV] Fold 2: y_val bincount: [971 207], y_pred bincount: [1136   42]
[CV] Fold 2: AUC = 0.5351870923446619
[CV] Fold 3: y_val bincount: [970 208], y_pred bincount: [1105   73]
[I 2025-08-16 19:08:38,802] Trial 8 finished with value: 0.5342605225066446 and parameters: {'n_estimators': 274, 'max_depth': 12, 'min_samples_split': 7, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.538503537477688.
[I 2025-08-16 19:09:17,297] Trial 9 finished with value: 0.5351100506293731 and parameters: {'n_estimators': 206, 'max_depth': 22, 'min_samples_split': 4, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.538503537477688.
2025-08-16 19:09:17,297 - INFO - Best hyperparameters: {'n_estimators': 180, 'max_depth': 17, 'min_samples_split': 8, 'min_samples_leaf': 2}
2025-08-16 19:09:17,297 - INFO - Selected features (from input): ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
2025-08-16 19:09:17,909 - INFO - Saving RF with 10 features.
2025-08-16 19:09:18,401 - INFO - RF (Optuna) metrics: train acc=0.999, val acc=0.810, test acc=0.830
2025-08-16 19:09:18,463 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.84      0.99      0.91       625
         1.0       0.14      0.01      0.02       122

    accuracy                           0.83       747
   macro avg       0.49      0.50      0.46       747
weighted avg       0.72      0.83      0.76       747

2025-08-16 19:09:19,625 - INFO - Optimal threshold for F1: 0.130
2025-08-16 19:09:19,636 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.19262295081967212, "precision": 0.18930041152263374, "recall": 1.0, "f1": 0.31833910034602075}
2025-08-16 19:09:19,636 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.1686746987951807, "precision": 0.1632928475033738, "recall": 0.9918032786885246, "f1": 0.28041714947856317}
2025-08-16 19:09:19,643 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_rank_wasserstein_std_low.csv
[CV] Fold 3: AUC = 0.5345459952418715
[CV] Fold 4: y_val bincount: [970 208], y_pred bincount: [1138   40]
[CV] Fold 4: AUC = 0.5422779540047581
manual auc_list: [np.float64(0.511244355541472), np.float64(0.5480472154004594), np.float64(0.5351870923446619), np.float64(0.5345459952418715), np.float64(0.5422779540047581)]
manual auc mean (ignore nan): 0.5342605225066446
cross_val_score: [0.51124436 0.54804722 0.53518709 0.534546   0.54227795]
X_train.shape: (5892, 135)
X_train nan: 20 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_Skewness', 'LongAcc_Skewness', 'lat_acc_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'Steering_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5892,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5892, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [971 208], y_pred bincount: [1175    4]
[CV] Fold 0: AUC = 0.5139180464231957
[CV] Fold 1: y_val bincount: [971 208], y_pred bincount: [1178    1]
[CV] Fold 1: AUC = 0.5453933296363781
[CV] Fold 2: y_val bincount: [971 207], y_pred bincount: [1176    2]
[CV] Fold 2: AUC = 0.5469932387050552
[CV] Fold 3: y_val bincount: [970 208], y_pred bincount: [1175    3]
[CV] Fold 3: AUC = 0.5312698255352895
[CV] Fold 4: y_val bincount: [970 208], y_pred bincount: [1175    3]
[CV] Fold 4: AUC = 0.537975812846947
manual auc_list: [np.float64(0.5139180464231957), np.float64(0.5453933296363781), np.float64(0.5469932387050552), np.float64(0.5312698255352895), np.float64(0.537975812846947)]
manual auc mean (ignore nan): 0.5351100506293731
cross_val_score: [0.51391805 0.54539333 0.54699324 0.53126983 0.53797581]
=== DONE (BASENAME=wasserstein_std_low) ===

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=855272kb,walltime=00:06:21,ncpus=8,cpupercent=99,vmem=2270100kb
============================================================================================
