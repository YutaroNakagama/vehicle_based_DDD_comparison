=== JOB INFO ===
IDX=13
NAME(line)=results/ranks/wasserstein_mean_high.txt
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/results/ranks/wasserstein_mean_high.txt
BASENAME=wasserstein_mean_high
TARGETS(first few)=S0154_2 S0120_2 S0154_1 S0120_1 S0135_2 S0209_1 S0178_2 S0186_2 S0206_1 S0156_1
[PRETRAIN] pretrain_setting exists. Reusing: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_mean_high.pkl
----- RUN: EVAL-ONLY (no fine-tune) -----
2025-08-16 19:03:06.728632: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:07.119150: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:07.455222: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755338587.725005  893220 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755338587.802266  893220 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755338588.460921  893220 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.460957  893220 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.460959  893220 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.460961  893220 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 19:03:08.533323: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 19:03:14,489 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_mean_high | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 19:03:14,491 - INFO - Model type: common
2025-08-16 19:03:14,491 - INFO - Finetuning with target subjects: ['S0154_2', 'S0120_2', 'S0154_1', 'S0120_1', 'S0135_2', 'S0209_1', 'S0178_2', 'S0186_2', 'S0206_1', 'S0156_1']
2025-08-16 19:03:14,547 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 19:03:14,607 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 19:03:14,650 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 19:03:14,708 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 19:03:14,751 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 19:03:14,795 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 19:03:14,853 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 19:03:14,897 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 19:03:14,945 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 19:03:14,991 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 19:03:15,064 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 19:03:15,088 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 19:03:15,114 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 19:03:15,140 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 19:03:15,171 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 19:03:15,217 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 19:03:15,259 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 19:03:15,321 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 19:03:15,387 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 19:03:15,411 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 19:03:15,435 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 19:03:15,459 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 19:03:15,482 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 19:03:15,509 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 19:03:15,554 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 19:03:15,598 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 19:03:15,641 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 19:03:15,702 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 19:03:15,766 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 19:03:15,791 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 19:03:15,849 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 19:03:15,872 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 19:03:15,895 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 19:03:15,918 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 19:03:15,963 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 19:03:16,024 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 19:03:16,075 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 19:03:16,116 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 19:03:16,158 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 19:03:16,214 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 19:03:16,252 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 19:03:16,295 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 19:03:16,335 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 19:03:16,377 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 19:03:16,436 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 19:03:16,459 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 19:03:16,514 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 19:03:16,536 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 19:03:16,560 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 19:03:16,582 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 19:03:16,604 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 19:03:16,658 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 19:03:16,681 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 19:03:16,704 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 19:03:16,734 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 19:03:16,777 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 19:03:16,818 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 19:03:16,861 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 19:03:16,902 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 19:03:16,943 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 19:03:16,985 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 19:03:17,047 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 19:03:17,070 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 19:03:17,092 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 19:03:17,143 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 19:03:17,207 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 19:03:17,255 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 19:03:17,276 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 19:03:17,301 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 19:03:17,325 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 19:03:17,347 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 19:03:17,399 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 19:03:17,420 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 19:03:17,443 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 19:03:17,465 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 19:03:17,486 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 19:03:17,509 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 19:03:17,554 - INFO - [EvalOnly] Found existing pretrained model/scaler. Skipping retrain.
2025-08-16 19:03:17,896 - INFO - [EvalOnly] Loaded model features: ./model/common/selected_features_train_RF_pretrain_general.pkl (10 cols)
2025-08-16 19:03:17,918 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 19:03:17,942 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 19:03:17,964 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 19:03:17,989 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 19:03:18,013 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 19:03:18,036 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 19:03:18,059 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 19:03:18,082 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 19:03:18,105 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 19:03:18,128 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 19:03:18,170 - WARNING - [EvalOnly] feature mismatch before alignment: missing_in_val=[] extra_in_val=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 19:03:18,170 - WARNING - [EvalOnly] feature mismatch (test) before alignment: missing_in_test=[] extra_in_test=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 19:03:18,175 - INFO - [EvalOnly] scaler expects n_features=10, aligned_features=10
2025-08-16 19:03:18,515 - INFO - [EvalOnly] val pos_ratio=0.142, pred_pos_ratio=0.036
2025-08-16 19:03:18,516 - INFO - [EvalOnly] test pos_ratio=0.189, pred_pos_ratio=0.043
2025-08-16 19:03:18,517 - INFO - [EvalOnly] val CM=
[[637  12]
 [ 92  15]]
2025-08-16 19:03:18,518 - INFO - [EvalOnly] test CM=
[[614  10]
 [122  23]]
2025-08-16 19:03:18,518 - INFO - [EvalOnly] RF on targets: val acc=0.862 auc=0.622 ap=0.304 | test acc=0.828 auc=0.630 ap=0.398
2025-08-16 19:03:18,523 - INFO - [EvalOnly] Saved -> ./model/common/metrics_RF_rank_wasserstein_mean_high_evalonly_on_targets.csv
----- RUN: FINE-TUNE (use target-train) -----
2025-08-16 19:03:20.796060: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:20.799668: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:20.810310: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755338600.828012  893240 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755338600.833341  893240 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755338600.847129  893240 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338600.847157  893240 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338600.847160  893240 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338600.847162  893240 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 19:03:20.851267: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 19:03:23,420 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_mean_high | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 19:03:23,420 - INFO - Model type: common
2025-08-16 19:03:23,420 - INFO - Finetuning with target subjects: ['S0154_2', 'S0120_2', 'S0154_1', 'S0120_1', 'S0135_2', 'S0209_1', 'S0178_2', 'S0186_2', 'S0206_1', 'S0156_1']
2025-08-16 19:03:23,447 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 19:03:23,472 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 19:03:23,497 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 19:03:23,522 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 19:03:23,546 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 19:03:23,570 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 19:03:23,595 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 19:03:23,620 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 19:03:23,644 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 19:03:23,669 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 19:03:23,693 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 19:03:23,717 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 19:03:23,741 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 19:03:23,765 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 19:03:23,788 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 19:03:23,812 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 19:03:23,835 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 19:03:23,859 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 19:03:23,882 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 19:03:23,905 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 19:03:23,929 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 19:03:23,952 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 19:03:23,975 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 19:03:23,998 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 19:03:24,021 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 19:03:24,044 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 19:03:24,066 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 19:03:24,089 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 19:03:24,112 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 19:03:24,135 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 19:03:24,157 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 19:03:24,180 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 19:03:24,203 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 19:03:24,225 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 19:03:24,248 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 19:03:24,270 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 19:03:24,293 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 19:03:24,320 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 19:03:24,343 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 19:03:24,365 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 19:03:24,388 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 19:03:24,410 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 19:03:24,433 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 19:03:24,455 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 19:03:24,477 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 19:03:24,499 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 19:03:24,521 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 19:03:24,543 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 19:03:24,565 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 19:03:24,588 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 19:03:24,610 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 19:03:24,632 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 19:03:24,653 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 19:03:24,676 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 19:03:24,698 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 19:03:24,720 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 19:03:24,742 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 19:03:24,764 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 19:03:24,785 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 19:03:24,807 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 19:03:24,829 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 19:03:24,850 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 19:03:24,872 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 19:03:24,894 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 19:03:24,916 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 19:03:24,938 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 19:03:24,959 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 19:03:24,980 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 19:03:25,001 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 19:03:25,023 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 19:03:25,044 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 19:03:25,065 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 19:03:25,086 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 19:03:25,107 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 19:03:25,128 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 19:03:25,148 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 19:03:25,167 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 19:03:25,205 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_mean_high.pkl: features=['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
2025-08-16 19:03:25,225 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 19:03:25,249 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 19:03:25,268 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 19:03:25,292 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 19:03:25,316 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 19:03:25,337 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 19:03:25,358 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 19:03:25,378 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 19:03:25,399 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 19:03:25,419 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 19:03:25,460 - INFO - [split:finetune_setting] global  : n=7604, pos=1479, pos_ratio=0.195
2025-08-16 19:03:25,460 - INFO - [split:finetune_setting] train   : n=6079, pos=1227, pos_ratio=0.202, |Δ|=0.007
2025-08-16 19:03:25,460 - INFO - [split:finetune_setting] val     : n=756, pos=107, pos_ratio=0.142, |Δ|=0.053
2025-08-16 19:03:25,460 - INFO - [split:finetune_setting] test    : n=769, pos=145, pos_ratio=0.189, |Δ|=0.006
[I 2025-08-16 19:03:25,462] A new study created in memory with name: no-name-35fe1b18-0a0b-48e5-9c63-81c68e6ce0d2
[I 2025-08-16 19:04:00,015] Trial 0 finished with value: 0.5152118690964185 and parameters: {'n_estimators': 299, 'max_depth': 7, 'min_samples_split': 8, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.5152118690964185.
[I 2025-08-16 19:04:51,020] Trial 1 finished with value: 0.49014474347530246 and parameters: {'n_estimators': 251, 'max_depth': 26, 'min_samples_split': 6, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.5152118690964185.
[I 2025-08-16 19:05:39,163] Trial 2 finished with value: 0.49280423205339885 and parameters: {'n_estimators': 228, 'max_depth': 28, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.5152118690964185.
[I 2025-08-16 19:06:32,454] Trial 3 finished with value: 0.5061239187195404 and parameters: {'n_estimators': 299, 'max_depth': 15, 'min_samples_split': 3, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.5152118690964185.
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [908 308]
[CV] Fold 0: AUC = 0.5413293102003185
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [903 313]
[CV] Fold 1: AUC = 0.5125052384544464
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [807 409]
[CV] Fold 2: AUC = 0.5084049685785745
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [902 314]
[CV] Fold 3: AUC = 0.4968074150360453
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [929 286]
[CV] Fold 4: AUC = 0.5170124132127077
manual auc_list: [np.float64(0.5413293102003185), np.float64(0.5125052384544464), np.float64(0.5084049685785745), np.float64(0.4968074150360453), np.float64(0.5170124132127077)]
manual auc mean (ignore nan): 0.5152118690964185
cross_val_score: [0.54132931 0.51250524 0.50840497 0.49680742 0.51701241]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1213    3]
[CV] Fold 0: AUC = 0.48685357472131424
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1208    8]
[CV] Fold 1: AUC = 0.483739837398374
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1212    4]
[CV] Fold 2: AUC = 0.4885937073078459
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1211    5]
[CV] Fold 3: AUC = 0.48705100989932537
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1208    7]
[CV] Fold 4: AUC = 0.5044855880496528
manual auc_list: [np.float64(0.48685357472131424), np.float64(0.483739837398374), np.float64(0.4885937073078459), np.float64(0.48705100989932537), np.float64(0.5044855880496528)]
manual auc mean (ignore nan): 0.49014474347530246
cross_val_score: [0.48685357 0.48373984 0.48859371 0.48705101 0.50448559]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1214    2]
[CV] Fold 0: AUC = 0.48431816276925654
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1215    1]
[CV] Fold 1: AUC = 0.4925655854496689
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1216]
[CV] Fold 2: AUC = 0.48038420311481955
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1215    1]
[CV] Fold 3: AUC = 0.47795876331995213
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1213    2]
[CV] Fold 4: AUC = 0.5287944456132968
manual auc_list: [np.float64(0.48431816276925654), np.float64(0.4925655854496689), np.float64(0.48038420311481955), np.float64(0.47795876331995213), np.float64(0.5287944456132968)]
manual auc mean (ignore nan): 0.49280423205339885
cross_val_score: [0.48431816 0.49256559 0.4803842  0.47795876 0.52879445]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1179   37]
[CV] Fold 0: AUC = 0.5114785013829519
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1157   59]
[CV] Fold 1: AUC = 0.5026192272232001
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1166   50]
[CV] Fold 2: AUC = 0.503680195044032
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1177   39]
[CV] Fold 3: AUC = 0.49051892641711675
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1169   46]
[CV] Fold 4: AUC = 0.5223227435304019
manual auc_list: [np.float64(0.5114785013829519), np.float64(0.5026192272232001), np.float64(0.503680195044032), np.float64(0.49051892641711675), np.float64(0.5223227435304019)]
manual auc mean (ignore nan): 0.5061239187195404
cross_val_score: [0.5114785  0.50261923 0.5036802  0.49051893 0.52232274]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1203   13]
[CV] Fold 0: AUC = 0.49764479088089847
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1199   17]
[CV] Fold 1: AUC = 0.49248177017852657
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1204   12]
[CV] Fold 2: AUC = 0.48940078606107734
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1205   11]
[CV] Fold 3: AUC = 0.48568065743290106
[I 2025-08-16 19:07:30,609] Trial 4 finished with value: 0.4985151965344972 and parameters: {'n_estimators': 296, 'max_depth': 30, 'min_samples_split': 9, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.5152118690964185.
[I 2025-08-16 19:08:19,982] Trial 5 finished with value: 0.5029096693497507 and parameters: {'n_estimators': 271, 'max_depth': 15, 'min_samples_split': 4, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.5152118690964185.
[I 2025-08-16 19:09:11,660] Trial 6 finished with value: 0.49589019475109525 and parameters: {'n_estimators': 253, 'max_depth': 21, 'min_samples_split': 8, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.5152118690964185.
[I 2025-08-16 19:09:44,430] Trial 7 finished with value: 0.5039521754456298 and parameters: {'n_estimators': 179, 'max_depth': 15, 'min_samples_split': 9, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.5152118690964185.
[I 2025-08-16 19:10:24,914] Trial 8 finished with value: 0.502586915239166 and parameters: {'n_estimators': 216, 'max_depth': 18, 'min_samples_split': 3, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.5152118690964185.
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1201   14]
[CV] Fold 4: AUC = 0.5273679781190828
manual auc_list: [np.float64(0.49764479088089847), np.float64(0.49248177017852657), np.float64(0.48940078606107734), np.float64(0.48568065743290106), np.float64(0.5273679781190828)]
manual auc mean (ignore nan): 0.4985151965344972
cross_val_score: [0.49764479 0.49248177 0.48940079 0.48568066 0.52736798]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1195   21]
[CV] Fold 0: AUC = 0.5094375995306345
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1173   43]
[CV] Fold 1: AUC = 0.49679406587880315
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1193   23]
[CV] Fold 2: AUC = 0.5014018789802224
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1184   32]
[CV] Fold 3: AUC = 0.47223354841421633
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1189   26]
[CV] Fold 4: AUC = 0.534681253944877
manual auc_list: [np.float64(0.5094375995306345), np.float64(0.49679406587880315), np.float64(0.5014018789802224), np.float64(0.47223354841421633), np.float64(0.534681253944877)]
manual auc mean (ignore nan): 0.5029096693497507
cross_val_score: [0.5094376  0.49679407 0.50140188 0.47223355 0.53468125]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1209    7]
[CV] Fold 0: AUC = 0.5028455284552846
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1211    5]
[CV] Fold 1: AUC = 0.49578409186153716
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1211    5]
[CV] Fold 2: AUC = 0.4810693793480317
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1204   12]
[CV] Fold 3: AUC = 0.47323819332058265
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1207    8]
[CV] Fold 4: AUC = 0.52651378077004
manual auc_list: [np.float64(0.5028455284552846), np.float64(0.49578409186153716), np.float64(0.4810693793480317), np.float64(0.47323819332058265), np.float64(0.52651378077004)]
manual auc mean (ignore nan): 0.49589019475109525
cross_val_score: [0.50284553 0.49578409 0.48106938 0.47323819 0.52651378]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1177   39]
[CV] Fold 0: AUC = 0.5236065711172575
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1177   39]
[CV] Fold 1: AUC = 0.5000628614533569
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1179   37]
[CV] Fold 2: AUC = 0.49432312574875464
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1170   46]
[CV] Fold 3: AUC = 0.4847306584837848
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1177   38]
[CV] Fold 4: AUC = 0.5170376604249948
manual auc_list: [np.float64(0.5236065711172575), np.float64(0.5000628614533569), np.float64(0.49432312574875464), np.float64(0.4847306584837848), np.float64(0.5170376604249948)]
manual auc mean (ignore nan): 0.5039521754456298
cross_val_score: [0.52360657 0.50006286 0.49432313 0.48473066 0.51703766]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1191   25]
[CV] Fold 0: AUC = 0.5150825580420753
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1191   25]
[CV] Fold 1: AUC = 0.493789288408348
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1187   29]
[CV] Fold 2: AUC = 0.4948233464343512
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1199   17]
[CV] Fold 3: AUC = 0.4826961474600139
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1190   25]
[CV] Fold 4: AUC = 0.5265432358510415
manual auc_list: [np.float64(0.5150825580420753), np.float64(0.493789288408348), np.float64(0.4948233464343512), np.float64(0.4826961474600139), np.float64(0.5265432358510415)]
manual auc mean (ignore nan): 0.502586915239166
cross_val_score: [0.51508256 0.49378929 0.49482335 0.48269615 0.52654324]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[I 2025-08-16 19:10:36,407] Trial 9 finished with value: 0.5133210684492925 and parameters: {'n_estimators': 111, 'max_depth': 6, 'min_samples_split': 10, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.5152118690964185.
2025-08-16 19:10:36,407 - INFO - Best hyperparameters: {'n_estimators': 299, 'max_depth': 7, 'min_samples_split': 8, 'min_samples_leaf': 2}
2025-08-16 19:10:36,407 - INFO - Selected features (from input): ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
2025-08-16 19:10:37,301 - INFO - Saving RF with 10 features.
2025-08-16 19:10:37,961 - INFO - RF (Optuna) metrics: train acc=0.794, val acc=0.681, test acc=0.668
2025-08-16 19:10:38,044 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.83      0.75      0.79       624
         1.0       0.23      0.33      0.27       145

    accuracy                           0.67       769
   macro avg       0.53      0.54      0.53       769
weighted avg       0.72      0.67      0.69       769

2025-08-16 19:10:39,218 - INFO - Optimal threshold for F1: 0.425
2025-08-16 19:10:39,229 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.2962962962962963, "precision": 0.15559157212317667, "recall": 0.897196261682243, "f1": 0.26519337016574585}
2025-08-16 19:10:39,229 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.3068920676202861, "precision": 0.19206349206349208, "recall": 0.8344827586206897, "f1": 0.31225806451612903}
2025-08-16 19:10:39,236 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_rank_wasserstein_mean_high.csv
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [862 354]
[CV] Fold 0: AUC = 0.5419579247338865
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [847 369]
[CV] Fold 1: AUC = 0.4998784678568435
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [738 478]
[CV] Fold 2: AUC = 0.5073456777149583
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [850 366]
[CV] Fold 3: AUC = 0.5035078501019357
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [858 357]
[CV] Fold 4: AUC = 0.5139154218388386
manual auc_list: [np.float64(0.5419579247338865), np.float64(0.4998784678568435), np.float64(0.5073456777149583), np.float64(0.5035078501019357), np.float64(0.5139154218388386)]
manual auc mean (ignore nan): 0.5133210684492925
cross_val_score: [0.54195792 0.49987847 0.50734568 0.50350785 0.51391542]
=== DONE (BASENAME=wasserstein_mean_high) ===

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=854108kb,walltime=00:07:40,ncpus=8,cpupercent=99,vmem=2268648kb
============================================================================================
