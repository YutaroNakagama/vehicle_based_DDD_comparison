IDX=13
NAME=wasserstein_biased_far
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/misc/pretrain_groups/wasserstein_biased_far.txt
TARGETS(first few)=S0178_2 S0120_1 S0120_2 S0156_1 S0206_1 S0209_1 S0154_2 S0154_1 S0186_1 S0156_2
pretrain_setting not found. It will be created at: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_biased_far.pkl
2025-08-12 14:53:26.151897: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-12 14:53:26.562532: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-12 14:53:26.913336: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754978007.199888 1161680 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754978007.278622 1161680 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754978007.957246 1161680 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754978007.957302 1161680 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754978007.957305 1161680 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754978007.957307 1161680 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-12 14:53:28.027543: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-12 14:53:36,613 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=finetune_wasserstein_biased_far | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-12 14:53:36,615 - INFO - Model type: common
2025-08-12 14:53:36,616 - INFO - Finetuning with target subjects: ['S0178_2', 'S0120_1', 'S0120_2', 'S0156_1', 'S0206_1', 'S0209_1', 'S0154_2', 'S0154_1', 'S0186_1', 'S0156_2']
2025-08-12 14:53:36,682 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-12 14:53:36,736 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-12 14:53:36,788 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-12 14:53:36,844 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-12 14:53:36,897 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-12 14:53:36,952 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-12 14:53:37,007 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-12 14:53:37,057 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-12 14:53:37,108 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-12 14:53:37,157 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-12 14:53:37,215 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-12 14:53:37,265 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-12 14:53:37,316 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-12 14:53:37,366 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-12 14:53:37,414 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-12 14:53:37,462 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-12 14:53:37,511 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-12 14:53:37,563 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-12 14:53:37,611 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-12 14:53:37,659 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-12 14:53:37,707 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-12 14:53:37,751 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-12 14:53:37,796 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-12 14:53:37,840 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-12 14:53:37,890 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-12 14:53:37,942 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-12 14:53:37,987 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-12 14:53:38,036 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-12 14:53:38,086 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-12 14:53:38,134 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-12 14:53:38,183 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-12 14:53:38,234 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-12 14:53:38,283 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-12 14:53:38,329 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-12 14:53:38,377 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-12 14:53:38,423 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-12 14:53:38,470 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-12 14:53:38,513 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-12 14:53:38,557 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-12 14:53:38,606 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-12 14:53:38,652 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-12 14:53:38,701 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-12 14:53:38,753 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-12 14:53:38,798 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-12 14:53:38,845 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-12 14:53:38,892 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-12 14:53:38,936 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-12 14:53:38,980 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-12 14:53:39,028 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-12 14:53:39,071 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-12 14:53:39,125 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-12 14:53:39,169 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-12 14:53:39,221 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-12 14:53:39,280 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-12 14:53:39,342 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-12 14:53:39,414 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-12 14:53:39,488 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-12 14:53:39,564 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-12 14:53:39,677 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-12 14:53:39,743 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-12 14:53:39,841 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-12 14:53:39,938 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-12 14:53:40,043 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-12 14:53:40,147 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-12 14:53:40,251 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-12 14:53:40,358 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-12 14:53:40,467 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-12 14:53:40,578 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-12 14:53:40,685 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-12 14:53:40,790 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-12 14:53:40,879 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-12 14:53:40,969 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-12 14:53:41,061 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-12 14:53:41,151 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-12 14:53:41,242 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-12 14:53:41,335 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-12 14:53:41,413 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-12 14:55:26,942 - INFO - Saved pretrain setting (features/scaler) to /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_biased_far.pkl
2025-08-12 14:55:26,952 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_biased_far.pkl: features=['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
2025-08-12 14:55:27,075 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-12 14:55:27,193 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-12 14:55:27,298 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-12 14:55:27,396 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-12 14:55:27,497 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-12 14:55:27,602 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-12 14:55:27,707 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-12 14:55:27,798 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-12 14:55:27,871 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-12 14:55:27,918 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
[I 2025-08-12 14:55:27,975] A new study created in memory with name: no-name-b0d693f7-d246-40fe-83f7-155d5ff5971c
[I 2025-08-12 14:55:55,066] Trial 0 finished with value: 0.5008424984289703 and parameters: {'n_estimators': 132, 'max_depth': 16, 'min_samples_split': 6, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.5008424984289703.
[I 2025-08-12 14:56:18,564] Trial 1 finished with value: 0.5045502474258006 and parameters: {'n_estimators': 102, 'max_depth': 28, 'min_samples_split': 3, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.5045502474258006.
[I 2025-08-12 14:56:40,405] Trial 2 finished with value: 0.49870072141939675 and parameters: {'n_estimators': 100, 'max_depth': 20, 'min_samples_split': 6, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.5045502474258006.
[I 2025-08-12 14:57:22,376] Trial 3 finished with value: 0.5043079898391801 and parameters: {'n_estimators': 274, 'max_depth': 9, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.5045502474258006.
X_train.shape: (6031, 135)
X_train nan: 9 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
y_train shape: (6031,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6031, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [984 223], y_pred bincount: [1190   17]
[CV] Fold 0: AUC = 0.4996171934813518
[CV] Fold 1: y_val bincount: [983 223], y_pred bincount: [1197    9]
[CV] Fold 1: AUC = 0.4667098522414681
[CV] Fold 2: y_val bincount: [984 222], y_pred bincount: [1199    7]
[CV] Fold 2: AUC = 0.5066240020508314
[CV] Fold 3: y_val bincount: [984 222], y_pred bincount: [1195   11]
[CV] Fold 3: AUC = 0.5336418735808979
[CV] Fold 4: y_val bincount: [984 222], y_pred bincount: [1196   10]
[CV] Fold 4: AUC = 0.4976195707903025
manual auc_list: [np.float64(0.4996171934813518), np.float64(0.4667098522414681), np.float64(0.5066240020508314), np.float64(0.5336418735808979), np.float64(0.4976195707903025)]
manual auc mean (ignore nan): 0.5008424984289703
cross_val_score: [0.49961719 0.46670985 0.506624   0.53364187 0.49761957]
X_train.shape: (6031, 135)
X_train nan: 9 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
y_train shape: (6031,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6031, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [984 223], y_pred bincount: [1207]
[CV] Fold 0: AUC = 0.4873764993255314
[CV] Fold 1: y_val bincount: [983 223], y_pred bincount: [1206]
[CV] Fold 1: AUC = 0.49337618437199193
[CV] Fold 2: y_val bincount: [984 222], y_pred bincount: [1206]
[CV] Fold 2: AUC = 0.5182903940525891
[CV] Fold 3: y_val bincount: [984 222], y_pred bincount: [1205    1]
[CV] Fold 3: AUC = 0.5184918149857174
[CV] Fold 4: y_val bincount: [984 222], y_pred bincount: [1206]
[CV] Fold 4: AUC = 0.5052163443931736
manual auc_list: [np.float64(0.4873764993255314), np.float64(0.49337618437199193), np.float64(0.5182903940525891), np.float64(0.5184918149857174), np.float64(0.5052163443931736)]
manual auc mean (ignore nan): 0.5045502474258006
cross_val_score: [0.4873765  0.49337618 0.51829039 0.51849181 0.50521634]
X_train.shape: (6031, 135)
X_train nan: 9 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
y_train shape: (6031,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6031, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [984 223], y_pred bincount: [1201    6]
[CV] Fold 0: AUC = 0.4770316088811112
[CV] Fold 1: y_val bincount: [983 223], y_pred bincount: [1203    3]
[CV] Fold 1: AUC = 0.46875812580687837
[CV] Fold 2: y_val bincount: [984 222], y_pred bincount: [1203    3]
[CV] Fold 2: AUC = 0.5053330769794184
[CV] Fold 3: y_val bincount: [984 222], y_pred bincount: [1200    6]
[CV] Fold 3: AUC = 0.5404306745770161
[CV] Fold 4: y_val bincount: [984 222], y_pred bincount: [1204    2]
[CV] Fold 4: AUC = 0.5019501208525599
manual auc_list: [np.float64(0.4770316088811112), np.float64(0.46875812580687837), np.float64(0.5053330769794184), np.float64(0.5404306745770161), np.float64(0.5019501208525599)]
manual auc mean (ignore nan): 0.49870072141939675
cross_val_score: [0.47703161 0.46875813 0.50533308 0.54043067 0.50195012]
X_train.shape: (6031, 135)
X_train nan: 9 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
y_train shape: (6031,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6031, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [984 223], y_pred bincount: [1080  127]
[CV] Fold 0: AUC = 0.5002597615662254
[CV] Fold 1: y_val bincount: [983 223], y_pred bincount: [1064  142]
[CV] Fold 1: AUC = 0.4867090311072994
[CV] Fold 2: y_val bincount: [984 222], y_pred bincount: [1055  151]
[CV] Fold 2: AUC = 0.5039689079323225
[CV] Fold 3: y_val bincount: [984 222], y_pred bincount: [1077  129]
[CV] Fold 3: AUC = 0.5440104738885226
[CV] Fold 4: y_val bincount: [984 222], y_pred bincount: [1039  167]
[CV] Fold 4: AUC = 0.48659177470153075
manual auc_list: [np.float64(0.5002597615662254), np.float64(0.4867090311072994), np.float64(0.5039689079323225), np.float64(0.5440104738885226), np.float64(0.48659177470153075)]
manual auc mean (ignore nan): 0.5043079898391801
cross_val_score: [0.50025976 0.48670903 0.50396891 0.54401047 0.48659177]
X_train.shape: (6031, 135)
X_train nan: 9 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
y_train shape: (6031,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6031, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [984 223], y_pred bincount: [1194   13]
[CV] Fold 0: AUC = 0.48992854278318565
[CV] Fold 1: y_val bincount: [983 223], y_pred bincount: [1187   19]
[CV] Fold 1: AUC = 0.47997116906696347
[CV] Fold 2: y_val bincount: [984 222], y_pred bincount: [1196   10]
[CV] Fold 2: AUC = 0.4977477477477477
[CV] Fold 3: y_val bincount: [984 222], y_pred bincount: [1190   16]
[I 2025-08-12 14:57:46,734] Trial 4 finished with value: 0.5027390063120205 and parameters: {'n_estimators': 118, 'max_depth': 15, 'min_samples_split': 4, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.5045502474258006.
[I 2025-08-12 14:58:11,931] Trial 5 finished with value: 0.5048565892393586 and parameters: {'n_estimators': 116, 'max_depth': 30, 'min_samples_split': 8, 'min_samples_leaf': 2}. Best is trial 5 with value: 0.5048565892393586.
[I 2025-08-12 14:59:00,257] Trial 6 finished with value: 0.5023610861721771 and parameters: {'n_estimators': 238, 'max_depth': 17, 'min_samples_split': 7, 'min_samples_leaf': 2}. Best is trial 5 with value: 0.5048565892393586.
[I 2025-08-12 14:59:58,163] Trial 7 finished with value: 0.5053452642331445 and parameters: {'n_estimators': 276, 'max_depth': 30, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 7 with value: 0.5053452642331445.
[I 2025-08-12 15:00:18,093] Trial 8 finished with value: 0.49655462477561396 and parameters: {'n_estimators': 108, 'max_depth': 12, 'min_samples_split': 9, 'min_samples_leaf': 2}. Best is trial 7 with value: 0.5053452642331445.
[CV] Fold 3: AUC = 0.5538068556361239
[CV] Fold 4: y_val bincount: [984 222], y_pred bincount: [1190   16]
[CV] Fold 4: AUC = 0.49224071632608213
manual auc_list: [np.float64(0.48992854278318565), np.float64(0.47997116906696347), np.float64(0.4977477477477477), np.float64(0.5538068556361239), np.float64(0.49224071632608213)]
manual auc mean (ignore nan): 0.5027390063120205
cross_val_score: [0.48992854 0.47997117 0.49774775 0.55380686 0.49224072]
X_train.shape: (6031, 135)
X_train nan: 9 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
y_train shape: (6031,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6031, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [984 223], y_pred bincount: [1204    3]
[CV] Fold 0: AUC = 0.4972793393853221
[CV] Fold 1: y_val bincount: [983 223], y_pred bincount: [1206]
[CV] Fold 1: AUC = 0.47715650361070944
[CV] Fold 2: y_val bincount: [984 222], y_pred bincount: [1203    3]
[CV] Fold 2: AUC = 0.5068803559657218
[CV] Fold 3: y_val bincount: [984 222], y_pred bincount: [1199    7]
[CV] Fold 3: AUC = 0.5404627188163773
[CV] Fold 4: y_val bincount: [984 222], y_pred bincount: [1204    2]
[CV] Fold 4: AUC = 0.5025040284186626
manual auc_list: [np.float64(0.4972793393853221), np.float64(0.47715650361070944), np.float64(0.5068803559657218), np.float64(0.5404627188163773), np.float64(0.5025040284186626)]
manual auc mean (ignore nan): 0.5048565892393586
cross_val_score: [0.49727934 0.4771565  0.50688036 0.54046272 0.50250403]
X_train.shape: (6031, 135)
X_train nan: 9 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
y_train shape: (6031,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6031, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [984 223], y_pred bincount: [1198    9]
[CV] Fold 0: AUC = 0.48301523934521856
[CV] Fold 1: y_val bincount: [983 223], y_pred bincount: [1199    7]
[CV] Fold 1: AUC = 0.4636534083910788
[CV] Fold 2: y_val bincount: [984 222], y_pred bincount: [1203    3]
[CV] Fold 2: AUC = 0.5056992968578335
[CV] Fold 3: y_val bincount: [984 222], y_pred bincount: [1199    7]
[CV] Fold 3: AUC = 0.5598082838936498
[CV] Fold 4: y_val bincount: [984 222], y_pred bincount: [1202    4]
[CV] Fold 4: AUC = 0.4996292023731048
manual auc_list: [np.float64(0.48301523934521856), np.float64(0.4636534083910788), np.float64(0.5056992968578335), np.float64(0.5598082838936498), np.float64(0.4996292023731048)]
manual auc mean (ignore nan): 0.5023610861721771
cross_val_score: [0.48301524 0.46365341 0.5056993  0.55980828 0.4996292 ]
X_train.shape: (6031, 135)
X_train nan: 9 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
y_train shape: (6031,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6031, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [984 223], y_pred bincount: [1207]
[CV] Fold 0: AUC = 0.48575868606219696
[CV] Fold 1: y_val bincount: [983 223], y_pred bincount: [1206]
[CV] Fold 1: AUC = 0.48318271603811885
[CV] Fold 2: y_val bincount: [984 222], y_pred bincount: [1206]
[CV] Fold 2: AUC = 0.5075212407529481
[CV] Fold 3: y_val bincount: [984 222], y_pred bincount: [1204    2]
[CV] Fold 3: AUC = 0.5445048707243829
[CV] Fold 4: y_val bincount: [984 222], y_pred bincount: [1206]
[CV] Fold 4: AUC = 0.5057588075880759
manual auc_list: [np.float64(0.48575868606219696), np.float64(0.48318271603811885), np.float64(0.5075212407529481), np.float64(0.5445048707243829), np.float64(0.5057588075880759)]
manual auc mean (ignore nan): 0.5053452642331445
cross_val_score: [0.48575869 0.48318272 0.50752124 0.54450487 0.50575881]
X_train.shape: (6031, 135)
X_train nan: 9 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
y_train shape: (6031,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6031, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [984 223], y_pred bincount: [1142   65]
[CV] Fold 0: AUC = 0.49462703707754563
[CV] Fold 1: y_val bincount: [983 223], y_pred bincount: [1141   65]
[CV] Fold 1: AUC = 0.4749850599199851
[CV] Fold 2: y_val bincount: [984 222], y_pred bincount: [1139   67]
[CV] Fold 2: AUC = 0.4958388266315096
[CV] Fold 3: y_val bincount: [984 222], y_pred bincount: [1151   55]
[CV] Fold 3: AUC = 0.5257681461949755
[CV] Fold 4: y_val bincount: [984 222], y_pred bincount: [1153   53]
[CV] Fold 4: AUC = 0.49155405405405406
manual auc_list: [np.float64(0.49462703707754563), np.float64(0.4749850599199851), np.float64(0.4958388266315096), np.float64(0.5257681461949755), np.float64(0.49155405405405406)]
manual auc mean (ignore nan): 0.49655462477561396
cross_val_score: [0.49462704 0.47498506 0.49583883 0.52576815 0.49155405]
X_train.shape: (6031, 135)
X_train nan: 9 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
y_train shape: (6031,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6031, 10)
[I 2025-08-12 15:00:50,067] Trial 9 finished with value: 0.5050935058423708 and parameters: {'n_estimators': 265, 'max_depth': 6, 'min_samples_split': 8, 'min_samples_leaf': 1}. Best is trial 7 with value: 0.5053452642331445.
2025-08-12 15:00:50,068 - INFO - Best hyperparameters: {'n_estimators': 276, 'max_depth': 30, 'min_samples_split': 5, 'min_samples_leaf': 2}
2025-08-12 15:00:50,068 - INFO - Selected features (from input): ['long_acc_pred_error', 'steering_speed_pred_error', 'Lateral_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Steering_Kurtosis', 'Lateral_SampleEntropy', 'SteeringSpeed_Skewness', 'lat_acc_pred_error', 'SteeringSpeed_Kurtosis']
2025-08-12 15:00:57,772 - INFO - Saving RF with 10 features.
2025-08-12 15:00:58,692 - INFO - RF (Optuna) metrics: train acc=1.000, val acc=0.832, test acc=0.802
2025-08-12 15:00:58,746 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.80      1.00      0.89       613
         1.0       0.00      0.00      0.00       151

    accuracy                           0.80       764
   macro avg       0.40      0.50      0.45       764
weighted avg       0.64      0.80      0.71       764

2025-08-12 15:01:00,185 - INFO - Optimal threshold for F1: 0.117
2025-08-12 15:01:00,198 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.18133333333333335, "precision": 0.16824966078697423, "recall": 0.992, "f1": 0.2877030162412993}
2025-08-12 15:01:00,198 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.2198952879581152, "precision": 0.20134228187919462, "recall": 0.9933774834437086, "f1": 0.33482142857142855}
2025-08-12 15:01:00,204 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_finetune_wasserstein_biased_far_finetune.csv
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [984 223], y_pred bincount: [908 299]
[CV] Fold 0: AUC = 0.502018848663823
[CV] Fold 1: y_val bincount: [983 223], y_pred bincount: [920 286]
[CV] Fold 1: AUC = 0.49761186812585245
[CV] Fold 2: y_val bincount: [984 222], y_pred bincount: [876 330]
[CV] Fold 2: AUC = 0.49373764007910353
[CV] Fold 3: y_val bincount: [984 222], y_pred bincount: [917 289]
[CV] Fold 3: AUC = 0.5491741741741741
[CV] Fold 4: y_val bincount: [984 222], y_pred bincount: [862 344]
[CV] Fold 4: AUC = 0.48292499816890055
manual auc_list: [np.float64(0.502018848663823), np.float64(0.49761186812585245), np.float64(0.49373764007910353), np.float64(0.5491741741741741), np.float64(0.48292499816890055)]
manual auc mean (ignore nan): 0.5050935058423708
cross_val_score: [0.50201885 0.49761187 0.49373764 0.54917417 0.482925  ]

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=958280kb,walltime=00:08:03,ncpus=8,cpupercent=98,vmem=2377428kb
============================================================================================
