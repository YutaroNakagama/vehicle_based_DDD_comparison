2025-08-11 13:28:58.761704: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-11 13:28:59.157297: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-11 13:28:59.499122: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754886539.918890 3106616 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754886539.995279 3106616 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754886540.655359 3106616 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754886540.655395 3106616 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754886540.655398 3106616 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754886540.655400 3106616 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-11 13:29:00.725806: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-11 13:29:11,113 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=pretrain_group2 | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-11 13:29:11,115 - INFO - Model type: common
2025-08-11 13:29:11,115 - INFO - Finetuning with target subjects: ['S0197_1', 'S0134_1', 'S0196_1', 'S0178_1', 'S0134_2', 'S0140_1', 'S0181_1', 'S0174_2', 'S0113_1', 'S0181_2']
2025-08-11 13:29:11,186 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-11 13:29:11,249 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-11 13:29:11,313 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-11 13:29:11,371 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-11 13:29:11,436 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-11 13:29:11,495 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-11 13:29:11,558 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-11 13:29:11,623 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-11 13:29:11,691 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-11 13:29:11,751 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-11 13:29:11,775 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-11 13:29:11,801 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-11 13:29:11,824 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-11 13:29:11,850 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-11 13:29:11,893 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-11 13:29:11,939 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-11 13:29:11,981 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-11 13:29:12,041 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-11 13:29:12,098 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-11 13:29:12,156 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-11 13:29:12,179 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-11 13:29:12,202 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-11 13:29:12,226 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-11 13:29:12,249 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-11 13:29:12,273 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-11 13:29:12,296 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-11 13:29:12,325 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-11 13:29:12,359 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-11 13:29:12,401 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-11 13:29:12,445 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-11 13:29:12,491 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-11 13:29:12,532 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-11 13:29:12,574 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-11 13:29:12,616 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-11 13:29:12,660 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-11 13:29:12,703 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-11 13:29:12,747 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-11 13:29:12,789 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-11 13:29:12,832 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-11 13:29:12,876 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-11 13:29:12,919 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-11 13:29:12,962 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-11 13:29:13,002 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-11 13:29:13,045 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-11 13:29:13,086 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-11 13:29:13,129 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-11 13:29:13,170 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-11 13:29:13,213 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-11 13:29:13,255 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-11 13:29:13,299 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-11 13:29:13,341 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-11 13:29:13,386 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-11 13:29:13,428 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-11 13:29:13,470 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-11 13:29:13,512 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-11 13:29:13,555 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-11 13:29:13,598 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-11 13:29:13,640 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-11 13:29:13,682 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-11 13:29:13,724 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-11 13:29:13,764 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-11 13:29:13,806 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-11 13:29:13,847 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-11 13:29:13,889 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-11 13:29:13,929 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-11 13:29:13,972 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-11 13:29:14,012 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-11 13:29:14,053 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-11 13:29:14,095 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-11 13:29:14,139 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-11 13:29:14,179 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-11 13:29:14,219 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-11 13:29:14,266 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-11 13:29:14,313 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-11 13:29:14,362 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-11 13:29:14,415 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-11 13:29:14,461 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-11 13:30:45,050 - INFO - Saved pretrain setting (features/scaler) to model/common/pretrain_setting_group2.pkl
2025-08-11 13:30:45,073 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-11 13:30:45,094 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-11 13:30:45,114 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-11 13:30:45,137 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-11 13:30:45,158 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-11 13:30:45,179 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-11 13:30:45,203 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-11 13:30:45,224 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-11 13:30:45,250 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-11 13:30:45,275 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-11 13:30:45,303 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-11 13:30:45,329 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-11 13:30:45,354 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-11 13:30:45,381 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-11 13:30:45,406 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-11 13:30:45,430 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-11 13:30:45,454 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-11 13:30:45,479 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-11 13:30:45,506 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-11 13:30:45,532 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-11 13:30:45,557 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-11 13:30:45,585 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-11 13:30:45,610 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-11 13:30:45,635 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-11 13:30:45,664 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-11 13:30:45,693 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-11 13:30:45,721 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-11 13:30:45,748 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-11 13:30:45,772 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-11 13:30:45,799 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-11 13:30:45,824 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-11 13:30:45,847 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-11 13:30:45,873 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-11 13:30:45,896 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-11 13:30:45,920 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-11 13:30:45,944 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-11 13:30:45,971 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-11 13:30:45,996 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-11 13:30:46,025 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-11 13:30:46,050 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-11 13:30:46,076 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-11 13:30:46,101 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-11 13:30:46,125 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-11 13:30:46,149 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-11 13:30:46,177 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-11 13:30:46,205 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-11 13:30:46,231 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-11 13:30:46,257 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-11 13:30:46,282 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-11 13:30:46,308 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-11 13:30:46,332 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-11 13:30:46,358 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-11 13:30:46,387 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-11 13:30:46,413 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-11 13:30:46,438 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-11 13:30:46,467 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-11 13:30:46,492 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-11 13:30:46,521 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-11 13:30:46,547 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-11 13:30:46,576 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-11 13:30:46,606 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-11 13:30:46,631 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-11 13:30:46,657 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-11 13:30:46,683 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-11 13:30:46,709 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-11 13:30:46,734 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-11 13:30:46,764 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-11 13:30:46,789 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-11 13:30:46,811 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-11 13:30:46,834 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-11 13:30:46,862 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-11 13:30:46,886 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-11 13:30:46,914 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-11 13:30:46,937 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-11 13:30:46,962 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-11 13:30:46,983 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-11 13:30:47,007 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-11 13:30:47,031 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-11 13:30:47,055 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-11 13:30:47,079 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-11 13:30:47,104 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-11 13:30:47,129 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-11 13:30:47,152 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-11 13:30:47,178 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-11 13:30:47,204 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-11 13:30:47,233 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-11 13:30:47,263 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-11 13:30:47,307 - INFO - Splitting data by subject.
2025-08-11 13:30:47,307 - INFO -   Train subjects (85): ['S0139_1', 'S0120_1', 'S0116_2', 'S0120_2', 'S0116_1', 'S0204_1', 'S0148_1', 'S0189_1', 'S0171_1', 'S0135_2', 'S0140_2', 'S0155_1', 'S0171_2', 'S0172_1', 'S0167_1', 'S0198_1', 'S0202_1', 'S0153_2', 'S0155_2', 'S0189_2', 'S0204_2', 'S0170_1', 'S0178_2', 'S0201_1', 'S0194_1', 'S0207_1', 'S0207_2', 'S0198_2', 'S0156_1', 'S0196_2', 'S0201_2', 'S0206_1', 'S0186_2', 'S0199_1', 'S0173_1', 'S0165_1', 'S0209_1', 'S0172_2', 'S0210_2', 'S0200_1', 'S0193_1', 'S0165_2', 'S0210_1', 'S0205_1', 'S0213_2', 'S0205_2', 'S0199_2', 'S0202_2', 'S0186_1', 'S0156_2', 'S0136_1', 'S0191_2', 'S0206_2', 'S0167_2', 'S0209_2', 'S0173_2', 'S0169_1', 'S0148_2', 'S0200_2', 'S0185_1', 'S0136_2', 'S0193_2', 'S0194_2', 'S0147_2', 'S0185_2', 'S0170_2', 'S0139_2', 'S0168_2', 'S0168_1', 'S0154_2', 'S0169_2', 'S0188_2', 'S0188_1', 'S0190_2', 'S0154_1', 'S0153_1', 'S0190_1', 'S0140_1', 'S0197_1', 'S0174_2', 'S0196_1', 'S0181_2', 'S0134_2', 'S0178_1', 'S0181_1']
2025-08-11 13:30:47,308 - INFO -   Validation subjects (1): ['S0113_1']
2025-08-11 13:30:47,308 - INFO -   Test subjects (1): ['S0134_1']
2025-08-11 13:30:47,349 - INFO - Filtered data from 70841 to 64622 rows based on KSS labels.
2025-08-11 13:30:47,422 - INFO - Data splitting summary:
2025-08-11 13:30:47,436 - INFO -   X_train shape: (62846, 136), y_train distribution: {0.0: 48483, 1.0: 14363}
2025-08-11 13:30:47,436 - INFO -   X_val shape: (802, 136), y_val distribution: {0.0: 704, 1.0: 98}
2025-08-11 13:30:47,436 - INFO -   X_test shape: (812, 136), y_test distribution: {0.0: 630, 1.0: 182}
2025-08-11 13:30:47,461 - INFO - y_train unique: [0. 1.], counts: {0.0: 48483, 1.0: 14363}
2025-08-11 13:33:03,511 - INFO - Selected features (RF importance): ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
2025-08-11 13:33:03,514 - INFO - Scaler was fit using only X_train (standard procedure).
[I 2025-08-11 13:33:03,532] A new study created in memory with name: no-name-ca84e01d-0402-43d5-97c9-489970deb287
[I 2025-08-11 13:50:15,940] Trial 0 finished with value: 0.7600961540348192 and parameters: {'n_estimators': 224, 'max_depth': 22, 'min_samples_split': 9, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.7600961540348192.
[I 2025-08-11 14:02:02,934] Trial 1 finished with value: 0.7700092339925615 and parameters: {'n_estimators': 136, 'max_depth': 27, 'min_samples_split': 4, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.7700092339925615.
[I 2025-08-11 14:18:18,100] Trial 2 finished with value: 0.7153200702844246 and parameters: {'n_estimators': 261, 'max_depth': 16, 'min_samples_split': 3, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.7700092339925615.
[I 2025-08-11 14:29:57,149] Trial 3 finished with value: 0.767208758804937 and parameters: {'n_estimators': 139, 'max_depth': 26, 'min_samples_split': 8, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.7700092339925615.
[I 2025-08-11 14:43:12,278] Trial 4 finished with value: 0.7638513553157928 and parameters: {'n_estimators': 164, 'max_depth': 25, 'min_samples_split': 7, 'min_samples_leaf': 5}. Best is trial 1 with value: 0.7700092339925615.
X_train.shape: (62846, 10)
X_train nan: 0 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0]
X_train all const col: []
selected_features: ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
y_train shape: (62846,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (62846, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [9697 2873], y_pred bincount: [12225   345]
[CV] Fold 0: AUC = 0.5116257908752859
[CV] Fold 1: y_val bincount: [9697 2872], y_pred bincount: [12368   201]
[CV] Fold 1: AUC = 0.5117257641926415
[CV] Fold 2: y_val bincount: [9697 2872], y_pred bincount: [12215   354]
[CV] Fold 2: AUC = 0.5148781405270504
[CV] Fold 3: y_val bincount: [9696 2873], y_pred bincount: [12327   242]
[CV] Fold 3: AUC = 0.5111921738640972
[CV] Fold 4: y_val bincount: [9696 2873], y_pred bincount: [12365   204]
[CV] Fold 4: AUC = 0.5068501161376144
manual auc_list: [np.float64(0.5116257908752859), np.float64(0.5117257641926415), np.float64(0.5148781405270504), np.float64(0.5111921738640972), np.float64(0.5068501161376144)]
manual auc mean (ignore nan): 0.5112543971193378
cross_val_score: [0.51162579 0.51172576 0.51487814 0.51119217 0.50685012]
cross_val_score: [0.75719968 0.76426128 0.75654388 0.76012411 0.76235182]
X_train.shape: (62846, 10)
X_train nan: 0 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0]
X_train all const col: []
selected_features: ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
y_train shape: (62846,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (62846, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [9697 2873], y_pred bincount: [12534    36]
[CV] Fold 0: AUC = 0.5115269017394832
[CV] Fold 1: y_val bincount: [9697 2872], y_pred bincount: [12548    21]
[CV] Fold 1: AUC = 0.5102555912103304
[CV] Fold 2: y_val bincount: [9697 2872], y_pred bincount: [12517    52]
[CV] Fold 2: AUC = 0.5063785054849976
[CV] Fold 3: y_val bincount: [9696 2873], y_pred bincount: [12538    31]
[CV] Fold 3: AUC = 0.5059183085033181
[CV] Fold 4: y_val bincount: [9696 2873], y_pred bincount: [12536    33]
[CV] Fold 4: AUC = 0.5070277759589394
manual auc_list: [np.float64(0.5115269017394832), np.float64(0.5102555912103304), np.float64(0.5063785054849976), np.float64(0.5059183085033181), np.float64(0.5070277759589394)]
manual auc mean (ignore nan): 0.5082214165794138
cross_val_score: [0.5115269  0.51025559 0.50637851 0.50591831 0.50702778]
cross_val_score: [0.76968974 0.77046702 0.76943273 0.77022834 0.77022834]
X_train.shape: (62846, 10)
X_train nan: 0 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0]
X_train all const col: []
selected_features: ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
y_train shape: (62846,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (62846, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [9697 2873], y_pred bincount: [11072  1498]
[CV] Fold 0: AUC = 0.5146188473503868
[CV] Fold 1: y_val bincount: [9697 2872], y_pred bincount: [11470  1099]
[CV] Fold 1: AUC = 0.5134283626759906
[CV] Fold 2: y_val bincount: [9697 2872], y_pred bincount: [10976  1593]
[CV] Fold 2: AUC = 0.5099632011508599
[CV] Fold 3: y_val bincount: [9696 2873], y_pred bincount: [11256  1313]
[CV] Fold 3: AUC = 0.5078387864021348
[CV] Fold 4: y_val bincount: [9696 2873], y_pred bincount: [11412  1157]
[CV] Fold 4: AUC = 0.509962914364879
manual auc_list: [np.float64(0.5146188473503868), np.float64(0.5134283626759906), np.float64(0.5099632011508599), np.float64(0.5078387864021348), np.float64(0.509962914364879)]
manual auc mean (ignore nan): 0.5111624223888501
cross_val_score: [0.51461885 0.51342836 0.5099632  0.50783879 0.50996291]
cross_val_score: [0.71018298 0.72607208 0.70347681 0.71437664 0.72249185]
X_train.shape: (62846, 10)
X_train nan: 0 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0]
X_train all const col: []
selected_features: ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
y_train shape: (62846,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (62846, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [9697 2873], y_pred bincount: [12436   134]
[CV] Fold 0: AUC = 0.512403371764176
[CV] Fold 1: y_val bincount: [9697 2872], y_pred bincount: [12511    58]
[CV] Fold 1: AUC = 0.512974176029516
[CV] Fold 2: y_val bincount: [9697 2872], y_pred bincount: [12438   131]
[CV] Fold 2: AUC = 0.5072809182290248
[CV] Fold 3: y_val bincount: [9696 2873], y_pred bincount: [12471    98]
[CV] Fold 3: AUC = 0.5097328073827223
[CV] Fold 4: y_val bincount: [9696 2873], y_pred bincount: [12475    94]
[CV] Fold 4: AUC = 0.5102468685347477
manual auc_list: [np.float64(0.512403371764176), np.float64(0.512974176029516), np.float64(0.5072809182290248), np.float64(0.5097328073827223), np.float64(0.5102468685347477)]
manual auc mean (ignore nan): 0.5105276283880373
cross_val_score: [0.51240337 0.51297418 0.50728092 0.50973281 0.51024687]
cross_val_score: [0.7655529  0.76911449 0.76617074 0.76744371 0.76776195]
X_train.shape: (62846, 10)
X_train nan: 0 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0]
X_train all const col: []
selected_features: ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
y_train shape: (62846,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (62846, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [9697 2873], y_pred bincount: [12314   256]
[CV] Fold 0: AUC = 0.5097406875598293
[CV] Fold 1: y_val bincount: [9697 2872], y_pred bincount: [12443   126]
[CV] Fold 1: AUC = 0.5146427706584726
[CV] Fold 2: y_val bincount: [9697 2872], y_pred bincount: [12300   269]
[CV] Fold 2: AUC = 0.5104906379166173
[CV] Fold 3: y_val bincount: [9696 2873], y_pred bincount: [12424   145]
[CV] Fold 3: AUC = 0.5075878944055213
[CV] Fold 4: y_val bincount: [9696 2873], y_pred bincount: [12421   148]
[CV] Fold 4: AUC = 0.512144946003476
manual auc_list: [np.float64(0.5097406875598293), np.float64(0.5146427706584726), np.float64(0.5104906379166173), np.float64(0.5075878944055213), np.float64(0.512144946003476)]
manual auc mean (ignore nan): 0.5109213873087832
cross_val_score: [0.50974069 0.51464277 0.51049064 0.50758789 0.51214495]
cross_val_score: [0.76157518 0.76720503 0.76060148 0.76513645 0.76473864]
X_train.shape: (62846, 10)
X_train nan: 0 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0]
X_train all const col: []
selected_features: ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
y_train shape: (62846,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (62846, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [9697 2873], y_pred bincount: [8886 3684]
[CV] Fold 0: AUC = 0.5160655361813811
[CV] Fold 1: y_val bincount: [9697 2872], y_pred bincount: [9362 3207]
[CV] Fold 1: AUC = 0.5172415340815569
[CV] Fold 2: y_val bincount: [9697 2872], y_pred bincount: [8884 3685]
[CV] Fold 2: AUC = 0.5080603497678833
[I 2025-08-11 14:52:48,819] Trial 5 finished with value: 0.6270408228044995 and parameters: {'n_estimators': 209, 'max_depth': 11, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.7700092339925615.
[I 2025-08-11 15:07:29,058] Trial 6 finished with value: 0.6661204895199659 and parameters: {'n_estimators': 277, 'max_depth': 13, 'min_samples_split': 3, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.7700092339925615.
[I 2025-08-11 15:29:12,125] Trial 7 finished with value: 0.7681475600745935 and parameters: {'n_estimators': 263, 'max_depth': 25, 'min_samples_split': 9, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.7700092339925615.
[I 2025-08-11 15:42:45,036] Trial 8 finished with value: 0.6464373681937599 and parameters: {'n_estimators': 274, 'max_depth': 12, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.7700092339925615.
[I 2025-08-11 15:55:37,826] Trial 9 finished with value: 0.7630557521368284 and parameters: {'n_estimators': 161, 'max_depth': 24, 'min_samples_split': 8, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.7700092339925615.
2025-08-11 15:55:37,826 - INFO - Best hyperparameters: {'n_estimators': 136, 'max_depth': 27, 'min_samples_split': 4, 'min_samples_leaf': 1}
2025-08-11 15:55:37,826 - INFO - Selected features (from input): ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
2025-08-11 15:56:36,973 - INFO - Saving RF with 10 features.
2025-08-11 15:56:38,436 - INFO - RF (Optuna) trained with ROC AUC: 0.50
2025-08-11 15:56:38,442 - INFO -               precision    recall  f1-score   support

         0.0       0.88      0.99      0.93       704
         1.0       0.00      0.00      0.00        98

    accuracy                           0.87       802
   macro avg       0.44      0.50      0.47       802
weighted avg       0.77      0.87      0.82       802

2025-08-11 15:56:38,443 - INFO - Optimal threshold for F1: 0.205
2025-08-11 15:56:38,443 - INFO - Classification Report with optimized threshold:
2025-08-11 15:56:38,449 - INFO -               precision    recall  f1-score   support

         0.0       0.91      0.01      0.03       704
         1.0       0.12      0.99      0.22        98

    accuracy                           0.13       802
   macro avg       0.52      0.50      0.12       802
weighted avg       0.81      0.13      0.05       802

[CV] Fold 3: y_val bincount: [9696 2873], y_pred bincount: [9076 3493]
[CV] Fold 3: AUC = 0.5122027778830789
[CV] Fold 4: y_val bincount: [9696 2873], y_pred bincount: [9250 3319]
[CV] Fold 4: AUC = 0.5066612919993705
manual auc_list: [np.float64(0.5160655361813811), np.float64(0.5172415340815569), np.float64(0.5080603497678833), np.float64(0.5122027778830789), np.float64(0.5066612919993705)]
manual auc mean (ignore nan): 0.5120462979826541
cross_val_score: [0.51606554 0.51724153 0.50806035 0.51220278 0.50666129]
cross_val_score: [0.61949085 0.64062376 0.61564166 0.6273371  0.63211075]
X_train.shape: (62846, 10)
X_train nan: 0 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0]
X_train all const col: []
selected_features: ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
y_train shape: (62846,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (62846, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [9697 2873], y_pred bincount: [9810 2760]
[CV] Fold 0: AUC = 0.517985708348264
[CV] Fold 1: y_val bincount: [9697 2872], y_pred bincount: [10326  2243]
[CV] Fold 1: AUC = 0.5102634907329981
[CV] Fold 2: y_val bincount: [9697 2872], y_pred bincount: [9791 2778]
[CV] Fold 2: AUC = 0.5105814106134539
[CV] Fold 3: y_val bincount: [9696 2873], y_pred bincount: [10152  2417]
[CV] Fold 3: AUC = 0.5076778551071257
[CV] Fold 4: y_val bincount: [9696 2873], y_pred bincount: [10251  2318]
[CV] Fold 4: AUC = 0.5083891405586782
manual auc_list: [np.float64(0.517985708348264), np.float64(0.5102634907329981), np.float64(0.5105814106134539), np.float64(0.5076778551071257), np.float64(0.5083891405586782)]
manual auc mean (ignore nan): 0.510979521072104
cross_val_score: [0.51798571 0.51026349 0.51058141 0.50767786 0.50838914]
cross_val_score: [0.65783612 0.6791312  0.65359217 0.66711751 0.67292545]
X_train.shape: (62846, 10)
X_train nan: 0 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0]
X_train all const col: []
selected_features: ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
y_train shape: (62846,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (62846, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [9697 2873], y_pred bincount: [12451   119]
[CV] Fold 0: AUC = 0.5093552173495264
[CV] Fold 1: y_val bincount: [9697 2872], y_pred bincount: [12509    60]
[CV] Fold 1: AUC = 0.5103404033582452
[CV] Fold 2: y_val bincount: [9697 2872], y_pred bincount: [12459   110]
[CV] Fold 2: AUC = 0.5085360446601669
[CV] Fold 3: y_val bincount: [9696 2873], y_pred bincount: [12509    60]
[CV] Fold 3: AUC = 0.5087810762889725
[CV] Fold 4: y_val bincount: [9696 2873], y_pred bincount: [12526    43]
[CV] Fold 4: AUC = 0.5058517533793059
manual auc_list: [np.float64(0.5093552173495264), np.float64(0.5103404033582452), np.float64(0.5085360446601669), np.float64(0.5087810762889725), np.float64(0.5058517533793059)]
manual auc mean (ignore nan): 0.5085728990072433
cross_val_score: [0.50935522 0.5103404  0.50853604 0.50878108 0.50585175]
cross_val_score: [0.76658711 0.76959185 0.76640942 0.7680802  0.77006922]
X_train.shape: (62846, 10)
X_train nan: 0 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0]
X_train all const col: []
selected_features: ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
y_train shape: (62846,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (62846, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [9697 2873], y_pred bincount: [9393 3177]
[CV] Fold 0: AUC = 0.5154261129272293
[CV] Fold 1: y_val bincount: [9697 2872], y_pred bincount: [9817 2752]
[CV] Fold 1: AUC = 0.5176295442722285
[CV] Fold 2: y_val bincount: [9697 2872], y_pred bincount: [9244 3325]
[CV] Fold 2: AUC = 0.508980572344834
[CV] Fold 3: y_val bincount: [9696 2873], y_pred bincount: [9541 3028]
[CV] Fold 3: AUC = 0.5135105106838564
[CV] Fold 4: y_val bincount: [9696 2873], y_pred bincount: [9774 2795]
[CV] Fold 4: AUC = 0.5078638073953583
manual auc_list: [np.float64(0.5154261129272293), np.float64(0.5176295442722285), np.float64(0.508980572344834), np.float64(0.5135105106838564), np.float64(0.5078638073953583)]
manual auc mean (ignore nan): 0.5126821095247014
cross_val_score: [0.51542611 0.51762954 0.50898057 0.51351051 0.50786381]
cross_val_score: [0.64359586 0.6582067  0.62741666 0.64507916 0.65788846]
X_train.shape: (62846, 10)
X_train nan: 0 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0]
X_train all const col: []
selected_features: ['long_acc_pred_error', 'steering_pred_error', 'steering_speed_pred_error', 'Lateral_SampleEntropy', 'lat_acc_pred_error', 'SteeringSpeed_Skewness', 'Lateral_Skewness', 'Steering_Skewness', 'Steering_Kurtosis', 'LaneOffset_Kurtosis']
y_train shape: (62846,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (62846, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [9697 2873], y_pred bincount: [12318   252]
[CV] Fold 0: AUC = 0.5077143396892425
[CV] Fold 1: y_val bincount: [9697 2872], y_pred bincount: [12404   165]
[CV] Fold 1: AUC = 0.5100291621651356
[CV] Fold 2: y_val bincount: [9697 2872], y_pred bincount: [12326   243]
[CV] Fold 2: AUC = 0.5120298958153499
[CV] Fold 3: y_val bincount: [9696 2873], y_pred bincount: [12399   170]
[CV] Fold 3: AUC = 0.5079123775586747
[CV] Fold 4: y_val bincount: [9696 2873], y_pred bincount: [12395   174]
[CV] Fold 4: AUC = 0.5069445282067364
manual auc_list: [np.float64(0.5077143396892425), np.float64(0.5100291621651356), np.float64(0.5120298958153499), np.float64(0.5079123775586747), np.float64(0.5069445282067364)]
manual auc mean (ignore nan): 0.5089260606870278
cross_val_score: [0.50771434 0.51002916 0.5120299  0.50791238 0.50694453]
cross_val_score: [0.76125696 0.76601162 0.76107884 0.7621927  0.76473864]

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=48:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=1363632kb,walltime=02:28:00,ncpus=8,cpupercent=100,vmem=2786916kb
============================================================================================
