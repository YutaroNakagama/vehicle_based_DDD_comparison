IDX=2
NAME=mmd_hard
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/misc/pretrain_groups/mmd_hard.txt
TARGETS(first few)=S0178_2 S0120_1 S0120_2 S0156_1 S0135_2 S0206_1 S0209_1 S0154_2 S0154_1 S0213_2
pretrain_setting not found. It will be created at: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_mmd_hard.pkl
2025-08-11 19:01:09.083506: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-11 19:01:09.491686: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-11 19:01:09.839095: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754906470.116677 2144915 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754906470.194349 2144915 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754906470.862331 2144915 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754906470.862389 2144915 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754906470.862391 2144915 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754906470.862394 2144915 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-11 19:01:10.930877: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-11 19:01:16,797 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=finetune_mmd_hard | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-11 19:01:16,798 - INFO - Model type: common
2025-08-11 19:01:16,798 - INFO - Finetuning with target subjects: ['S0178_2', 'S0120_1', 'S0120_2', 'S0156_1', 'S0135_2', 'S0206_1', 'S0209_1', 'S0154_2', 'S0154_1', 'S0213_2']
2025-08-11 19:01:16,849 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-11 19:01:16,893 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-11 19:01:16,940 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-11 19:01:16,983 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-11 19:01:17,026 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-11 19:01:17,069 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-11 19:01:17,112 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-11 19:01:17,155 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-11 19:01:17,198 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-11 19:01:17,242 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-11 19:01:17,285 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-11 19:01:17,327 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-11 19:01:17,369 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-11 19:01:17,411 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-11 19:01:17,453 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-11 19:01:17,495 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-11 19:01:17,536 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-11 19:01:17,577 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-11 19:01:17,622 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-11 19:01:17,663 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-11 19:01:17,704 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-11 19:01:17,744 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-11 19:01:17,784 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-11 19:01:17,825 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-11 19:01:17,865 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-11 19:01:17,905 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-11 19:01:17,948 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-11 19:01:17,988 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-11 19:01:18,028 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-11 19:01:18,068 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-11 19:01:18,108 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-11 19:01:18,149 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-11 19:01:18,193 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-11 19:01:18,233 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-11 19:01:18,272 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-11 19:01:18,311 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-11 19:01:18,351 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-11 19:01:18,390 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-11 19:01:18,430 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-11 19:01:18,472 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-11 19:01:18,512 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-11 19:01:18,552 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-11 19:01:18,592 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-11 19:01:18,631 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-11 19:01:18,670 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-11 19:01:18,710 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-11 19:01:18,753 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-11 19:01:18,793 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-11 19:01:18,833 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-11 19:01:18,873 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-11 19:01:18,913 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-11 19:01:18,952 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-11 19:01:18,991 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-11 19:01:19,030 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-11 19:01:19,068 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-11 19:01:19,108 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-11 19:01:19,147 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-11 19:01:19,185 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-11 19:01:19,224 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-11 19:01:19,263 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-11 19:01:19,301 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-11 19:01:19,344 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-11 19:01:19,382 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-11 19:01:19,421 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-11 19:01:19,460 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-11 19:01:19,499 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-11 19:01:19,536 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-11 19:01:19,575 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-11 19:01:19,612 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-11 19:01:19,650 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-11 19:01:19,688 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-11 19:01:19,725 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-11 19:01:19,762 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-11 19:01:19,800 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-11 19:01:19,841 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-11 19:01:19,884 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-11 19:01:19,933 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-11 19:02:49,586 - INFO - Saved pretrain setting (features/scaler) to /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_mmd_hard.pkl
2025-08-11 19:02:49,596 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_mmd_hard.pkl: features=['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
2025-08-11 19:02:49,715 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-11 19:02:49,829 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-11 19:02:49,889 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-11 19:02:49,947 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-11 19:02:50,002 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-11 19:02:50,042 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-11 19:02:50,082 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-11 19:02:50,118 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-11 19:02:50,153 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-11 19:02:50,191 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
[I 2025-08-11 19:02:50,235] A new study created in memory with name: no-name-bce620b3-b443-4d18-b561-9cdf40ec6c31
[I 2025-08-11 19:03:08,492] Trial 0 finished with value: 0.512852207265285 and parameters: {'n_estimators': 202, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.512852207265285.
[I 2025-08-11 19:03:30,532] Trial 1 finished with value: 0.5011422251680064 and parameters: {'n_estimators': 137, 'max_depth': 12, 'min_samples_split': 3, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.512852207265285.
[I 2025-08-11 19:04:02,837] Trial 2 finished with value: 0.5135672071340031 and parameters: {'n_estimators': 237, 'max_depth': 9, 'min_samples_split': 9, 'min_samples_leaf': 2}. Best is trial 2 with value: 0.5135672071340031.
[I 2025-08-11 19:04:18,787] Trial 3 finished with value: 0.5065296893591088 and parameters: {'n_estimators': 126, 'max_depth': 8, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 2 with value: 0.5135672071340031.
X_train.shape: (6056, 135)
X_train nan: 4 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
y_train shape: (6056,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6056, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [961 251], y_pred bincount: [829 383]
[CV] Fold 0: AUC = 0.5133886928871403
[CV] Fold 1: y_val bincount: [960 251], y_pred bincount: [743 468]
[CV] Fold 1: AUC = 0.5008258632138114
[CV] Fold 2: y_val bincount: [960 251], y_pred bincount: [761 450]
[CV] Fold 2: AUC = 0.5103751660026561
[CV] Fold 3: y_val bincount: [960 251], y_pred bincount: [797 414]
[CV] Fold 3: AUC = 0.5084038844621515
[CV] Fold 4: y_val bincount: [961 250], y_pred bincount: [811 400]
[CV] Fold 4: AUC = 0.531267429760666
manual auc_list: [np.float64(0.5133886928871403), np.float64(0.5008258632138114), np.float64(0.5103751660026561), np.float64(0.5084038844621515), np.float64(0.531267429760666)]
manual auc mean (ignore nan): 0.512852207265285
cross_val_score: [0.51338869 0.50082586 0.51037517 0.50840388 0.53126743]
X_train.shape: (6056, 135)
X_train nan: 4 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
y_train shape: (6056,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6056, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [961 251], y_pred bincount: [1117   95]
[CV] Fold 0: AUC = 0.5086127912906128
[CV] Fold 1: y_val bincount: [960 251], y_pred bincount: [1078  133]
[CV] Fold 1: AUC = 0.4896331341301461
[CV] Fold 2: y_val bincount: [960 251], y_pred bincount: [1107  104]
[CV] Fold 2: AUC = 0.49131806108897746
[CV] Fold 3: y_val bincount: [960 251], y_pred bincount: [1095  116]
[CV] Fold 3: AUC = 0.49528137450199206
[CV] Fold 4: y_val bincount: [961 250], y_pred bincount: [1107  104]
[CV] Fold 4: AUC = 0.5208657648283039
manual auc_list: [np.float64(0.5086127912906128), np.float64(0.4896331341301461), np.float64(0.49131806108897746), np.float64(0.49528137450199206), np.float64(0.5208657648283039)]
manual auc mean (ignore nan): 0.5011422251680064
cross_val_score: [0.50861279 0.48963313 0.49131806 0.49528137 0.52086576]
X_train.shape: (6056, 135)
X_train nan: 4 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
y_train shape: (6056,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6056, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [961 251], y_pred bincount: [1047  165]
[CV] Fold 0: AUC = 0.5197938734137331
[CV] Fold 1: y_val bincount: [960 251], y_pred bincount: [954 257]
[CV] Fold 1: AUC = 0.5009420650730412
[CV] Fold 2: y_val bincount: [960 251], y_pred bincount: [1027  184]
[CV] Fold 2: AUC = 0.5136495683930943
[CV] Fold 3: y_val bincount: [960 251], y_pred bincount: [1004  207]
[CV] Fold 3: AUC = 0.5035358565737051
[CV] Fold 4: y_val bincount: [961 250], y_pred bincount: [1023  188]
[CV] Fold 4: AUC = 0.5299146722164412
manual auc_list: [np.float64(0.5197938734137331), np.float64(0.5009420650730412), np.float64(0.5136495683930943), np.float64(0.5035358565737051), np.float64(0.5299146722164412)]
manual auc mean (ignore nan): 0.5135672071340031
cross_val_score: [0.51979387 0.50094207 0.51364957 0.50353586 0.52991467]
X_train.shape: (6056, 135)
X_train nan: 4 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
y_train shape: (6056,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6056, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [961 251], y_pred bincount: [985 227]
[CV] Fold 0: AUC = 0.5057895369614155
[CV] Fold 1: y_val bincount: [960 251], y_pred bincount: [903 308]
[CV] Fold 1: AUC = 0.4945260624169987
[CV] Fold 2: y_val bincount: [960 251], y_pred bincount: [974 237]
[CV] Fold 2: AUC = 0.5072045152722443
[CV] Fold 3: y_val bincount: [960 251], y_pred bincount: [966 245]
[CV] Fold 3: AUC = 0.5027016932270917
[CV] Fold 4: y_val bincount: [961 250], y_pred bincount: [983 228]
[CV] Fold 4: AUC = 0.522426638917794
manual auc_list: [np.float64(0.5057895369614155), np.float64(0.4945260624169987), np.float64(0.5072045152722443), np.float64(0.5027016932270917), np.float64(0.522426638917794)]
manual auc mean (ignore nan): 0.5065296893591088
cross_val_score: [0.50578954 0.49452606 0.50720452 0.50270169 0.52242664]
X_train.shape: (6056, 135)
X_train nan: 4 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
y_train shape: (6056,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6056, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [961 251], y_pred bincount: [1208    4]
[CV] Fold 0: AUC = 0.5179614528358989
[CV] Fold 1: y_val bincount: [960 251], y_pred bincount: [1196   15]
[CV] Fold 1: AUC = 0.49520252324037184
[CV] Fold 2: y_val bincount: [960 251], y_pred bincount: [1201   10]
[CV] Fold 2: AUC = 0.4957918326693227
[CV] Fold 3: y_val bincount: [960 251], y_pred bincount: [1197   14]
[CV] Fold 3: AUC = 0.502394588313413
[I 2025-08-11 19:05:18,006] Trial 4 finished with value: 0.5061368848228314 and parameters: {'n_estimators': 298, 'max_depth': 20, 'min_samples_split': 8, 'min_samples_leaf': 2}. Best is trial 2 with value: 0.5135672071340031.
[I 2025-08-11 19:05:42,688] Trial 5 finished with value: 0.4992592976342981 and parameters: {'n_estimators': 129, 'max_depth': 20, 'min_samples_split': 7, 'min_samples_leaf': 5}. Best is trial 2 with value: 0.5135672071340031.
[I 2025-08-11 19:06:05,686] Trial 6 finished with value: 0.5132626811519099 and parameters: {'n_estimators': 201, 'max_depth': 7, 'min_samples_split': 3, 'min_samples_leaf': 1}. Best is trial 2 with value: 0.5135672071340031.
[I 2025-08-11 19:06:34,264] Trial 7 finished with value: 0.5107036872627423 and parameters: {'n_estimators': 227, 'max_depth': 8, 'min_samples_split': 3, 'min_samples_leaf': 2}. Best is trial 2 with value: 0.5135672071340031.
[I 2025-08-11 19:07:23,810] Trial 8 finished with value: 0.5058165291660275 and parameters: {'n_estimators': 235, 'max_depth': 25, 'min_samples_split': 4, 'min_samples_leaf': 1}. Best is trial 2 with value: 0.5135672071340031.
[CV] Fold 4: y_val bincount: [961 250], y_pred bincount: [1201   10]
[CV] Fold 4: AUC = 0.5193340270551509
manual auc_list: [np.float64(0.5179614528358989), np.float64(0.49520252324037184), np.float64(0.4957918326693227), np.float64(0.502394588313413), np.float64(0.5193340270551509)]
manual auc mean (ignore nan): 0.5061368848228314
cross_val_score: [0.51796145 0.49520252 0.49579183 0.50239459 0.51933403]
X_train.shape: (6056, 135)
X_train nan: 4 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
y_train shape: (6056,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6056, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [961 251], y_pred bincount: [1194   18]
[CV] Fold 0: AUC = 0.5176297930028066
[CV] Fold 1: y_val bincount: [960 251], y_pred bincount: [1181   30]
[CV] Fold 1: AUC = 0.4930444887118194
[CV] Fold 2: y_val bincount: [960 251], y_pred bincount: [1186   25]
[CV] Fold 2: AUC = 0.4973813081009296
[CV] Fold 3: y_val bincount: [960 251], y_pred bincount: [1190   21]
[CV] Fold 3: AUC = 0.4959495351925631
[CV] Fold 4: y_val bincount: [961 250], y_pred bincount: [1182   29]
[CV] Fold 4: AUC = 0.49229136316337146
manual auc_list: [np.float64(0.5176297930028066), np.float64(0.4930444887118194), np.float64(0.4973813081009296), np.float64(0.4959495351925631), np.float64(0.49229136316337146)]
manual auc mean (ignore nan): 0.4992592976342981
cross_val_score: [0.51762979 0.49304449 0.49738131 0.49594954 0.49229136]
X_train.shape: (6056, 135)
X_train nan: 4 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
y_train shape: (6056,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6056, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [961 251], y_pred bincount: [930 282]
[CV] Fold 0: AUC = 0.5200882215156025
[CV] Fold 1: y_val bincount: [960 251], y_pred bincount: [864 347]
[CV] Fold 1: AUC = 0.5000332005312085
[CV] Fold 2: y_val bincount: [960 251], y_pred bincount: [917 294]
[CV] Fold 2: AUC = 0.5106573705179284
[CV] Fold 3: y_val bincount: [960 251], y_pred bincount: [912 299]
[CV] Fold 3: AUC = 0.5025481407702523
[CV] Fold 4: y_val bincount: [961 250], y_pred bincount: [933 278]
[CV] Fold 4: AUC = 0.5329864724245578
manual auc_list: [np.float64(0.5200882215156025), np.float64(0.5000332005312085), np.float64(0.5106573705179284), np.float64(0.5025481407702523), np.float64(0.5329864724245578)]
manual auc mean (ignore nan): 0.5132626811519099
cross_val_score: [0.52008822 0.5000332  0.51065737 0.50254814 0.53298647]
X_train.shape: (6056, 135)
X_train nan: 4 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
y_train shape: (6056,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6056, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [961 251], y_pred bincount: [1014  198]
[CV] Fold 0: AUC = 0.5128331626667109
[CV] Fold 1: y_val bincount: [960 251], y_pred bincount: [925 286]
[CV] Fold 1: AUC = 0.5005768592297477
[CV] Fold 2: y_val bincount: [960 251], y_pred bincount: [989 222]
[CV] Fold 2: AUC = 0.5108524236387781
[CV] Fold 3: y_val bincount: [960 251], y_pred bincount: [973 238]
[CV] Fold 3: AUC = 0.5031665006640106
[CV] Fold 4: y_val bincount: [961 250], y_pred bincount: [995 216]
[CV] Fold 4: AUC = 0.526089490114464
manual auc_list: [np.float64(0.5128331626667109), np.float64(0.5005768592297477), np.float64(0.5108524236387781), np.float64(0.5031665006640106), np.float64(0.526089490114464)]
manual auc mean (ignore nan): 0.5107036872627423
cross_val_score: [0.51283316 0.50057686 0.51085242 0.5031665  0.52608949]
X_train.shape: (6056, 135)
X_train nan: 4 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
y_train shape: (6056,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6056, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [961 251], y_pred bincount: [1211    1]
[CV] Fold 0: AUC = 0.5162326759559059
[CV] Fold 1: y_val bincount: [960 251], y_pred bincount: [1208    3]
[CV] Fold 1: AUC = 0.5108731739707836
[CV] Fold 2: y_val bincount: [960 251], y_pred bincount: [1209    2]
[CV] Fold 2: AUC = 0.4970659030544488
[CV] Fold 3: y_val bincount: [960 251], y_pred bincount: [1211]
[CV] Fold 3: AUC = 0.5016309760956176
[CV] Fold 4: y_val bincount: [961 250], y_pred bincount: [1210    1]
[CV] Fold 4: AUC = 0.5032799167533819
manual auc_list: [np.float64(0.5162326759559059), np.float64(0.5108731739707836), np.float64(0.4970659030544488), np.float64(0.5016309760956176), np.float64(0.5032799167533819)]
manual auc mean (ignore nan): 0.5058165291660275
cross_val_score: [0.51623268 0.51087317 0.4970659  0.50163098 0.50327992]
X_train.shape: (6056, 135)
X_train nan: 4 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
y_train shape: (6056,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6056, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[I 2025-08-11 19:07:35,493] Trial 9 finished with value: 0.5060436500270165 and parameters: {'n_estimators': 113, 'max_depth': 6, 'min_samples_split': 9, 'min_samples_leaf': 4}. Best is trial 2 with value: 0.5135672071340031.
2025-08-11 19:07:35,494 - INFO - Best hyperparameters: {'n_estimators': 237, 'max_depth': 9, 'min_samples_split': 9, 'min_samples_leaf': 2}
2025-08-11 19:07:35,494 - INFO - Selected features (from input): ['steering_speed_pred_error', 'lat_acc_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'Lateral_Skewness', 'Steering_Skewness', 'Lateral_SampleEntropy', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'LongitudinalAccel_DDD']
2025-08-11 19:07:39,453 - INFO - Saving RF with 10 features.
2025-08-11 19:07:39,766 - INFO - RF (Optuna) metrics: train acc=0.883, val acc=0.742, test acc=0.708
2025-08-11 19:07:39,793 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.81      0.83      0.82       613
         1.0       0.24      0.21      0.23       154

    accuracy                           0.71       767
   macro avg       0.53      0.52      0.52       767
weighted avg       0.69      0.71      0.70       767

2025-08-11 19:07:40,991 - INFO - Optimal threshold for F1: 0.427
2025-08-11 19:07:41,003 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.45152722443559096, "precision": 0.17067833698030635, "recall": 0.6964285714285714, "f1": 0.2741652021089631}
2025-08-11 19:07:41,003 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.42633637548891784, "precision": 0.19574468085106383, "recall": 0.5974025974025974, "f1": 0.2948717948717949}
2025-08-11 19:07:41,008 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_finetune_mmd_hard_finetune.csv
[CV] Fold 0: y_val bincount: [961 251], y_pred bincount: [866 346]
[CV] Fold 0: AUC = 0.5070913018063024
[CV] Fold 1: y_val bincount: [960 251], y_pred bincount: [763 448]
[CV] Fold 1: AUC = 0.5008217131474104
[CV] Fold 2: y_val bincount: [960 251], y_pred bincount: [824 387]
[CV] Fold 2: AUC = 0.5038346613545817
[CV] Fold 3: y_val bincount: [960 251], y_pred bincount: [829 382]
[CV] Fold 3: AUC = 0.4935839973439575
[CV] Fold 4: y_val bincount: [961 250], y_pred bincount: [874 337]
[CV] Fold 4: AUC = 0.5248865764828303
manual auc_list: [np.float64(0.5070913018063024), np.float64(0.5008217131474104), np.float64(0.5038346613545817), np.float64(0.4935839973439575), np.float64(0.5248865764828303)]
manual auc mean (ignore nan): 0.5060436500270165
cross_val_score: [0.5070913  0.50082171 0.50383466 0.493584   0.52488658]

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=969868kb,walltime=00:06:39,ncpus=8,cpupercent=98,vmem=2387164kb
============================================================================================
