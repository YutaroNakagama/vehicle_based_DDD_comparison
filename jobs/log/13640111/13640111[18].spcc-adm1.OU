=== JOB INFO ===
IDX=18
NAME(line)=results/ranks/wasserstein_std_middle.txt
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/results/ranks/wasserstein_std_middle.txt
BASENAME=wasserstein_std_middle
TARGETS(first few)=S0181_1 S0120_2 S0154_2 S0136_1 S0199_1 S0148_2 S0136_2 S0196_1 S0139_1 S0204_1
[PRETRAIN] pretrain_setting exists. Reusing: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_std_middle.pkl
----- RUN: EVAL-ONLY (no fine-tune) -----
2025-08-16 18:01:05.446539: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:05.845619: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:06.189841: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755334866.472412 3159376 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755334866.548152 3159376 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755334867.209901 3159376 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334867.209937 3159376 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334867.209940 3159376 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334867.209942 3159376 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 18:01:07.280806: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 18:01:15,909 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_std_middle | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 18:01:15,912 - INFO - Model type: common
2025-08-16 18:01:15,912 - INFO - Finetuning with target subjects: ['S0181_1', 'S0120_2', 'S0154_2', 'S0136_1', 'S0199_1', 'S0148_2', 'S0136_2', 'S0196_1', 'S0139_1', 'S0204_1']
2025-08-16 18:01:15,985 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 18:01:16,029 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 18:01:16,092 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 18:01:16,140 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 18:01:16,198 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 18:01:16,246 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 18:01:16,289 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 18:01:16,341 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 18:01:16,393 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 18:01:16,460 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 18:01:16,504 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 18:01:16,531 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 18:01:16,596 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 18:01:16,642 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 18:01:16,688 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 18:01:16,735 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 18:01:16,785 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 18:01:16,833 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 18:01:16,879 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 18:01:16,925 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 18:01:16,966 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 18:01:17,014 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 18:01:17,060 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 18:01:17,104 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 18:01:17,149 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 18:01:17,194 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 18:01:17,242 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 18:01:17,286 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 18:01:17,330 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 18:01:17,376 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 18:01:17,422 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 18:01:17,466 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 18:01:17,509 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 18:01:17,568 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 18:01:17,591 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 18:01:17,614 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 18:01:17,671 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 18:01:17,727 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 18:01:17,752 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 18:01:17,775 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 18:01:17,805 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 18:01:17,849 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 18:01:17,893 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 18:01:17,935 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 18:01:17,975 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 18:01:18,018 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 18:01:18,058 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 18:01:18,101 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 18:01:18,141 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 18:01:18,186 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 18:01:18,227 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 18:01:18,268 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 18:01:18,327 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 18:01:18,384 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 18:01:18,440 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 18:01:18,496 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 18:01:18,518 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 18:01:18,568 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 18:01:18,592 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 18:01:18,616 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 18:01:18,638 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 18:01:18,661 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 18:01:18,701 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 18:01:18,743 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 18:01:18,786 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 18:01:18,827 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 18:01:18,870 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 18:01:18,924 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 18:01:18,945 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 18:01:18,967 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 18:01:19,019 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 18:01:19,056 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 18:01:19,097 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 18:01:19,138 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 18:01:19,180 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 18:01:19,218 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 18:01:19,255 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 18:01:19,303 - INFO - [EvalOnly] Found existing pretrained model/scaler. Skipping retrain.
2025-08-16 18:01:19,639 - INFO - [EvalOnly] Loaded model features: ./model/common/selected_features_train_RF_pretrain_general.pkl (10 cols)
2025-08-16 18:01:19,665 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 18:01:19,692 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 18:01:19,713 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 18:01:19,734 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 18:01:19,756 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 18:01:19,778 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 18:01:19,799 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 18:01:19,824 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 18:01:19,849 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 18:01:19,874 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 18:01:19,919 - WARNING - [EvalOnly] feature mismatch before alignment: missing_in_val=[] extra_in_val=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 18:01:19,919 - WARNING - [EvalOnly] feature mismatch (test) before alignment: missing_in_test=[] extra_in_test=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 18:01:19,924 - INFO - [EvalOnly] scaler expects n_features=10, aligned_features=10
2025-08-16 18:01:20,347 - INFO - [EvalOnly] val pos_ratio=0.201, pred_pos_ratio=0.122
2025-08-16 18:01:20,347 - INFO - [EvalOnly] test pos_ratio=0.243, pred_pos_ratio=0.119
2025-08-16 18:01:20,350 - INFO - [EvalOnly] val CM=
[[606   4]
 [ 64  89]]
2025-08-16 18:01:20,351 - INFO - [EvalOnly] test CM=
[[579   6]
 [102  86]]
2025-08-16 18:01:20,351 - INFO - [EvalOnly] RF on targets: val acc=0.911 auc=0.850 ap=0.769 | test acc=0.860 auc=0.802 ap=0.714
2025-08-16 18:01:20,357 - INFO - [EvalOnly] Saved -> ./model/common/metrics_RF_rank_wasserstein_std_middle_evalonly_on_targets.csv
----- RUN: FINE-TUNE (use target-train) -----
2025-08-16 18:01:22.972464: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:22.976646: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:22.987894: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755334883.006073 3159401 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755334883.011528 3159401 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755334883.026307 3159401 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334883.026331 3159401 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334883.026333 3159401 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334883.026335 3159401 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 18:01:23.030612: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 18:01:25,873 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_std_middle | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 18:01:25,873 - INFO - Model type: common
2025-08-16 18:01:25,873 - INFO - Finetuning with target subjects: ['S0181_1', 'S0120_2', 'S0154_2', 'S0136_1', 'S0199_1', 'S0148_2', 'S0136_2', 'S0196_1', 'S0139_1', 'S0204_1']
2025-08-16 18:01:25,900 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 18:01:25,925 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 18:01:25,950 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 18:01:25,974 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 18:01:25,999 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 18:01:26,023 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 18:01:26,048 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 18:01:26,072 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 18:01:26,097 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 18:01:26,121 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 18:01:26,145 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 18:01:26,169 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 18:01:26,192 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 18:01:26,216 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 18:01:26,239 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 18:01:26,262 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 18:01:26,286 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 18:01:26,309 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 18:01:26,333 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 18:01:26,355 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 18:01:26,378 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 18:01:26,401 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 18:01:26,424 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 18:01:26,447 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 18:01:26,470 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 18:01:26,493 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 18:01:26,515 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 18:01:26,538 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 18:01:26,561 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 18:01:26,584 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 18:01:26,606 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 18:01:26,629 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 18:01:26,651 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 18:01:26,674 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 18:01:26,696 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 18:01:26,719 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 18:01:26,741 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 18:01:26,764 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 18:01:26,786 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 18:01:26,809 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 18:01:26,831 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 18:01:26,853 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 18:01:26,875 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 18:01:26,897 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 18:01:26,919 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 18:01:26,942 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 18:01:26,964 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 18:01:26,986 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 18:01:27,008 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 18:01:27,030 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 18:01:27,052 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 18:01:27,075 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 18:01:27,097 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 18:01:27,119 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 18:01:27,141 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 18:01:27,163 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 18:01:27,185 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 18:01:27,207 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 18:01:27,229 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 18:01:27,251 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 18:01:27,273 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 18:01:27,295 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 18:01:27,316 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 18:01:27,338 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 18:01:27,360 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 18:01:27,381 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 18:01:27,403 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 18:01:27,424 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 18:01:27,445 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 18:01:27,466 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 18:01:27,487 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 18:01:27,514 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 18:01:27,535 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 18:01:27,556 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 18:01:27,576 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 18:01:27,596 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 18:01:27,616 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 18:01:27,656 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_std_middle.pkl: features=['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
2025-08-16 18:01:27,680 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 18:01:27,705 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 18:01:27,725 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 18:01:27,746 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 18:01:27,767 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 18:01:27,787 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 18:01:27,808 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 18:01:27,832 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 18:01:27,857 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 18:01:27,882 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 18:01:27,923 - INFO - [split:finetune_setting] global  : n=7664, pos=1676, pos_ratio=0.219
2025-08-16 18:01:27,923 - INFO - [split:finetune_setting] train   : n=6128, pos=1335, pos_ratio=0.218, |Δ|=0.001
2025-08-16 18:01:27,923 - INFO - [split:finetune_setting] val     : n=763, pos=153, pos_ratio=0.201, |Δ|=0.018
2025-08-16 18:01:27,923 - INFO - [split:finetune_setting] test    : n=773, pos=188, pos_ratio=0.243, |Δ|=0.025
[I 2025-08-16 18:01:27,926] A new study created in memory with name: no-name-aa43c9f0-4756-4d03-a462-c3cd7d46f959
[I 2025-08-16 18:01:52,225] Trial 0 finished with value: 0.5269394978712776 and parameters: {'n_estimators': 227, 'max_depth': 7, 'min_samples_split': 8, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.5269394978712776.
[I 2025-08-16 18:02:33,595] Trial 1 finished with value: 0.5290768725978223 and parameters: {'n_estimators': 219, 'max_depth': 25, 'min_samples_split': 8, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.5290768725978223.
[I 2025-08-16 18:03:06,144] Trial 2 finished with value: 0.5285113850589405 and parameters: {'n_estimators': 176, 'max_depth': 17, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.5290768725978223.
[I 2025-08-16 18:03:45,612] Trial 3 finished with value: 0.5282100374460086 and parameters: {'n_estimators': 270, 'max_depth': 11, 'min_samples_split': 7, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.5290768725978223.
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [957 269]
[CV] Fold 0: AUC = 0.5010681382370057
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1002  224]
[CV] Fold 1: AUC = 0.5165922680070141
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [993 233]
[CV] Fold 2: AUC = 0.5713582734824432
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [915 310]
[CV] Fold 3: AUC = 0.5167640136676753
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [982 243]
[CV] Fold 4: AUC = 0.5289147959622498
manual auc_list: [np.float64(0.5010681382370057), np.float64(0.5165922680070141), np.float64(0.5713582734824432), np.float64(0.5167640136676753), np.float64(0.5289147959622498)]
manual auc mean (ignore nan): 0.5269394978712776
cross_val_score: [0.50106814 0.51659227 0.57135827 0.51676401 0.5289148 ]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1223    3]
[CV] Fold 0: AUC = 0.5271174327190074
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1218    8]
[CV] Fold 1: AUC = 0.5106599024420725
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1218    8]
[CV] Fold 2: AUC = 0.5529167789481084
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1216    9]
[CV] Fold 3: AUC = 0.5437905123814439
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1214   11]
[CV] Fold 4: AUC = 0.5108997364984792
manual auc_list: [np.float64(0.5271174327190074), np.float64(0.5106599024420725), np.float64(0.5529167789481084), np.float64(0.5437905123814439), np.float64(0.5108997364984792)]
manual auc mean (ignore nan): 0.5290768725978223
cross_val_score: [0.52711743 0.5106599  0.55291678 0.54379051 0.51089974]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1219    7]
[CV] Fold 0: AUC = 0.5114292744080328
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1219    7]
[CV] Fold 1: AUC = 0.5082424341835479
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1218    8]
[CV] Fold 2: AUC = 0.5643519115183185
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1212   13]
[CV] Fold 3: AUC = 0.5415034442854574
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1216    9]
[CV] Fold 4: AUC = 0.5170298608993456
manual auc_list: [np.float64(0.5114292744080328), np.float64(0.5082424341835479), np.float64(0.5643519115183185), np.float64(0.5415034442854574), np.float64(0.5170298608993456)]
manual auc mean (ignore nan): 0.5285113850589405
cross_val_score: [0.51142927 0.50824243 0.56435191 0.54150344 0.51702986]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1127   99]
[CV] Fold 0: AUC = 0.5109176615778764
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1159   67]
[CV] Fold 1: AUC = 0.51196822532835
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1139   87]
[CV] Fold 2: AUC = 0.5626452336039803
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1114  111]
[CV] Fold 3: AUC = 0.534157459751511
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1153   72]
[CV] Fold 4: AUC = 0.5213616069683251
manual auc_list: [np.float64(0.5109176615778764), np.float64(0.51196822532835), np.float64(0.5626452336039803), np.float64(0.534157459751511), np.float64(0.5213616069683251)]
manual auc mean (ignore nan): 0.5282100374460086
cross_val_score: [0.51091766 0.51196823 0.56264523 0.53415746 0.52136161]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: [I 2025-08-16 18:04:24,297] Trial 4 finished with value: 0.5293313467600128 and parameters: {'n_estimators': 198, 'max_depth': 23, 'min_samples_split': 7, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.5293313467600128.
[I 2025-08-16 18:05:13,259] Trial 5 finished with value: 0.5248093584030713 and parameters: {'n_estimators': 255, 'max_depth': 22, 'min_samples_split': 5, 'min_samples_leaf': 3}. Best is trial 4 with value: 0.5293313467600128.
[I 2025-08-16 18:06:02,019] Trial 6 finished with value: 0.5284270715515277 and parameters: {'n_estimators': 248, 'max_depth': 22, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.5293313467600128.
[I 2025-08-16 18:06:33,941] Trial 7 finished with value: 0.5336158451407507 and parameters: {'n_estimators': 187, 'max_depth': 14, 'min_samples_split': 6, 'min_samples_leaf': 2}. Best is trial 7 with value: 0.5336158451407507.
['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1223    3]
[CV] Fold 0: AUC = 0.5069926929190441
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1222    4]
[CV] Fold 1: AUC = 0.5052157170585777
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1224    2]
[CV] Fold 2: AUC = 0.5543110215463205
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1218    7]
[CV] Fold 3: AUC = 0.5491230950872996
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1220    5]
[CV] Fold 4: AUC = 0.5310142071888219
manual auc_list: [np.float64(0.5069926929190441), np.float64(0.5052157170585777), np.float64(0.5543110215463205), np.float64(0.5491230950872996), np.float64(0.5310142071888219)]
manual auc mean (ignore nan): 0.5293313467600128
cross_val_score: [0.50699269 0.50521572 0.55431102 0.5491231  0.53101421]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1224    2]
[CV] Fold 0: AUC = 0.5009314477862006
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1221    5]
[CV] Fold 1: AUC = 0.5084142736074172
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1221    5]
[CV] Fold 2: AUC = 0.5583219099170874
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1218    7]
[CV] Fold 3: AUC = 0.5384031964220091
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1221    4]
[CV] Fold 4: AUC = 0.5179759642826425
manual auc_list: [np.float64(0.5009314477862006), np.float64(0.5084142736074172), np.float64(0.5583219099170874), np.float64(0.5384031964220091), np.float64(0.5179759642826425)]
manual auc mean (ignore nan): 0.5248093584030713
cross_val_score: [0.50093145 0.50841427 0.55832191 0.5384032  0.51797596]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1226]
[CV] Fold 0: AUC = 0.512682921113988
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1225    1]
[CV] Fold 1: AUC = 0.5240594720624245
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1223    3]
[CV] Fold 2: AUC = 0.5466485454183314
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1220    5]
[CV] Fold 3: AUC = 0.5368823938761309
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1224    1]
[CV] Fold 4: AUC = 0.5218620252867632
manual auc_list: [np.float64(0.512682921113988), np.float64(0.5240594720624245), np.float64(0.5466485454183314), np.float64(0.5368823938761309), np.float64(0.5218620252867632)]
manual auc mean (ignore nan): 0.5284270715515277
cross_val_score: [0.51268292 0.52405947 0.54664855 0.53688239 0.52186203]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1199   27]
[CV] Fold 0: AUC = 0.5090664823298302
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1210   16]
[CV] Fold 1: AUC = 0.5245125032708072
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1199   27]
[CV] Fold 2: AUC = 0.5532643632372986
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1189   36]
[CV] Fold 3: AUC = 0.5467539271109443
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1203   22]
[CV] Fold 4: AUC = 0.5344819497548732
manual auc_list: [np.float64(0.5090664823298302), np.float64(0.5245125032708072), np.float64(0.5532643632372986), np.float64(0.5467539271109443), np.float64(0.5344819497548732)]
manual auc mean (ignore nan): 0.5336158451407507
cross_val_score: [0.50906648 0.5245125  0.55326436 0.54675393 0.53448195]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1215   11]
[CV] Fold 0: AUC = 0.519181575689408
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1220    6]
[CV] Fold 1: AUC = 0.4993458385568613
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1218    8]
[CV] Fold 2: AUC = 0.550194686256361
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1212   13]
[I 2025-08-16 18:07:00,741] Trial 8 finished with value: 0.5226698499520426 and parameters: {'n_estimators': 140, 'max_depth': 21, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 7 with value: 0.5336158451407507.
[I 2025-08-16 18:07:44,570] Trial 9 finished with value: 0.530141160835969 and parameters: {'n_estimators': 229, 'max_depth': 21, 'min_samples_split': 3, 'min_samples_leaf': 3}. Best is trial 7 with value: 0.5336158451407507.
2025-08-16 18:07:44,571 - INFO - Best hyperparameters: {'n_estimators': 187, 'max_depth': 14, 'min_samples_split': 6, 'min_samples_leaf': 2}
2025-08-16 18:07:44,571 - INFO - Selected features (from input): ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
2025-08-16 18:07:45,215 - INFO - Saving RF with 10 features.
2025-08-16 18:07:45,702 - INFO - RF (Optuna) metrics: train acc=0.994, val acc=0.769, test acc=0.748
2025-08-16 18:07:45,763 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.76      0.98      0.85       585
         1.0       0.27      0.02      0.04       188

    accuracy                           0.75       773
   macro avg       0.51      0.50      0.45       773
weighted avg       0.64      0.75      0.66       773

2025-08-16 18:07:46,907 - INFO - Optimal threshold for F1: 0.318
2025-08-16 18:07:46,919 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.36828309305373524, "precision": 0.21291448516579406, "recall": 0.7973856209150327, "f1": 0.33608815426997246}
2025-08-16 18:07:46,919 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.35705045278137126, "precision": 0.23036649214659685, "recall": 0.7021276595744681, "f1": 0.3469119579500657}
2025-08-16 18:07:46,926 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_rank_wasserstein_std_middle.csv
[CV] Fold 3: AUC = 0.5372889837598618
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1215   10]
[CV] Fold 4: AUC = 0.5073381654977207
manual auc_list: [np.float64(0.519181575689408), np.float64(0.4993458385568613), np.float64(0.550194686256361), np.float64(0.5372889837598618), np.float64(0.5073381654977207)]
manual auc mean (ignore nan): 0.5226698499520426
cross_val_score: [0.51918158 0.49934584 0.55019469 0.53728898 0.50733817]
X_train.shape: (6128, 135)
X_train nan: 21 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'lat_acc_pred_error', 'SteeringSpeed_Median', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'long_acc_pred_error', 'Lateral_Kurtosis', 'Lateral_Skewness', 'Steering_Skewness']
y_train shape: (6128,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6128, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [959 267], y_pred bincount: [1222    4]
[CV] Fold 0: AUC = 0.5069692602703347
[CV] Fold 1: y_val bincount: [959 267], y_pred bincount: [1221    5]
[CV] Fold 1: AUC = 0.518338000335868
[CV] Fold 2: y_val bincount: [959 267], y_pred bincount: [1221    5]
[CV] Fold 2: AUC = 0.5685697882860189
[CV] Fold 3: y_val bincount: [958 267], y_pred bincount: [1220    5]
[CV] Fold 3: AUC = 0.5397949848701649
[CV] Fold 4: y_val bincount: [958 267], y_pred bincount: [1220    5]
[CV] Fold 4: AUC = 0.5170337704174583
manual auc_list: [np.float64(0.5069692602703347), np.float64(0.518338000335868), np.float64(0.5685697882860189), np.float64(0.5397949848701649), np.float64(0.5170337704174583)]
manual auc mean (ignore nan): 0.530141160835969
cross_val_score: [0.50696926 0.518338   0.56856979 0.53979498 0.51703377]
=== DONE (BASENAME=wasserstein_std_middle) ===

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=925728kb,walltime=00:06:51,ncpus=8,cpupercent=98,vmem=11128692kb
============================================================================================
