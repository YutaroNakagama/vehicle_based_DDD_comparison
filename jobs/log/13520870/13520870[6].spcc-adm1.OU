IDX=6
NAME=dtw_hard
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/misc/pretrain_groups/dtw_hard.txt
TARGETS(first few)=S0178_2 S0120_1 S0120_2 S0206_1 S0186_2 S0134_2 S0154_2 S0181_1 S0154_1 S0191_2
pretrain_setting not found. It will be created at: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_dtw_hard.pkl
2025-08-11 19:01:09.236616: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-11 19:01:09.630984: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-11 19:01:09.972111: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754906470.243531  400629 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754906470.318284  400629 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754906470.977293  400629 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754906470.977357  400629 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754906470.977360  400629 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754906470.977362  400629 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-11 19:01:11.048433: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-11 19:01:17,154 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=finetune_dtw_hard | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-11 19:01:17,156 - INFO - Model type: common
2025-08-11 19:01:17,156 - INFO - Finetuning with target subjects: ['S0178_2', 'S0120_1', 'S0120_2', 'S0206_1', 'S0186_2', 'S0134_2', 'S0154_2', 'S0181_1', 'S0154_1', 'S0191_2']
2025-08-11 19:01:17,217 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-11 19:01:17,280 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-11 19:01:17,325 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-11 19:01:17,384 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-11 19:01:17,437 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-11 19:01:17,462 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-11 19:01:17,506 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-11 19:01:17,563 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-11 19:01:17,627 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-11 19:01:17,651 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-11 19:01:17,678 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-11 19:01:17,719 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-11 19:01:17,781 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-11 19:01:17,827 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-11 19:01:17,879 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-11 19:01:17,921 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-11 19:01:17,963 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-11 19:01:18,002 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-11 19:01:18,050 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-11 19:01:18,095 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-11 19:01:18,139 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-11 19:01:18,187 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-11 19:01:18,231 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-11 19:01:18,277 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-11 19:01:18,319 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-11 19:01:18,363 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-11 19:01:18,405 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-11 19:01:18,451 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-11 19:01:18,509 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-11 19:01:18,551 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-11 19:01:18,593 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-11 19:01:18,635 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-11 19:01:18,676 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-11 19:01:18,722 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-11 19:01:18,766 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-11 19:01:18,810 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-11 19:01:18,870 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-11 19:01:18,926 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-11 19:01:18,966 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-11 19:01:19,006 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-11 19:01:19,046 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-11 19:01:19,103 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-11 19:01:19,159 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-11 19:01:19,181 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-11 19:01:19,232 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-11 19:01:19,255 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-11 19:01:19,311 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-11 19:01:19,336 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-11 19:01:19,385 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-11 19:01:19,409 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-11 19:01:19,433 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-11 19:01:19,455 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-11 19:01:19,478 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-11 19:01:19,533 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-11 19:01:19,555 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-11 19:01:19,578 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-11 19:01:19,601 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-11 19:01:19,625 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-11 19:01:19,657 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-11 19:01:19,700 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-11 19:01:19,741 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-11 19:01:19,783 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-11 19:01:19,826 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-11 19:01:19,877 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-11 19:01:19,933 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-11 19:01:19,999 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-11 19:01:20,318 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-11 19:01:20,410 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-11 19:01:20,496 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-11 19:01:20,574 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-11 19:01:20,650 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-11 19:01:20,722 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-11 19:01:20,767 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-11 19:01:20,805 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-11 19:01:20,845 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-11 19:01:20,897 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-11 19:01:20,972 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-11 19:03:02,283 - INFO - Saved pretrain setting (features/scaler) to /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_dtw_hard.pkl
2025-08-11 19:03:02,283 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_dtw_hard.pkl: features=['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
2025-08-11 19:03:02,305 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-11 19:03:02,329 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-11 19:03:02,353 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-11 19:03:02,373 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-11 19:03:02,394 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-11 19:03:02,418 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-11 19:03:02,438 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-11 19:03:02,461 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-11 19:03:02,480 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-11 19:03:02,501 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
[I 2025-08-11 19:03:02,537] A new study created in memory with name: no-name-a503757e-7e64-43a1-86b1-0e07a6b17786
[I 2025-08-11 19:03:58,088] Trial 0 finished with value: 0.4992115371203001 and parameters: {'n_estimators': 275, 'max_depth': 24, 'min_samples_split': 9, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.4992115371203001.
[I 2025-08-11 19:04:22,547] Trial 1 finished with value: 0.5028408373351094 and parameters: {'n_estimators': 124, 'max_depth': 18, 'min_samples_split': 9, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.5028408373351094.
[I 2025-08-11 19:04:45,480] Trial 2 finished with value: 0.49844925993358763 and parameters: {'n_estimators': 197, 'max_depth': 7, 'min_samples_split': 3, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.5028408373351094.
[I 2025-08-11 19:05:17,068] Trial 3 finished with value: 0.5015546246072188 and parameters: {'n_estimators': 200, 'max_depth': 11, 'min_samples_split': 4, 'min_samples_leaf': 3}. Best is trial 1 with value: 0.5028408373351094.
X_train.shape: (6092, 135)
X_train nan: 13 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
y_train shape: (6092,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6092, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [973 246], y_pred bincount: [1205   14]
[CV] Fold 0: AUC = 0.5034508978183306
[CV] Fold 1: y_val bincount: [973 246], y_pred bincount: [1212    7]
[CV] Fold 1: AUC = 0.5091787197419764
[CV] Fold 2: y_val bincount: [973 245], y_pred bincount: [1211    7]
[CV] Fold 2: AUC = 0.4844306479015038
[CV] Fold 3: y_val bincount: [973 245], y_pred bincount: [1203   15]
[CV] Fold 3: AUC = 0.5220294901105356
[CV] Fold 4: y_val bincount: [973 245], y_pred bincount: [1212    6]
[CV] Fold 4: AUC = 0.4769679300291545
manual auc_list: [np.float64(0.5034508978183306), np.float64(0.5091787197419764), np.float64(0.4844306479015038), np.float64(0.5220294901105356), np.float64(0.4769679300291545)]
manual auc mean (ignore nan): 0.4992115371203001
cross_val_score: [0.5034509  0.50917872 0.48443065 0.52202949 0.47696793]
X_train.shape: (6092, 135)
X_train nan: 13 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
y_train shape: (6092,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6092, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [973 246], y_pred bincount: [1192   27]
[CV] Fold 0: AUC = 0.5060453379456713
[CV] Fold 1: y_val bincount: [973 246], y_pred bincount: [1207   12]
[CV] Fold 1: AUC = 0.5036514342532942
[CV] Fold 2: y_val bincount: [973 245], y_pred bincount: [1209    9]
[CV] Fold 2: AUC = 0.5057574931308597
[CV] Fold 3: y_val bincount: [973 245], y_pred bincount: [1196   22]
[CV] Fold 3: AUC = 0.5294964028776978
[CV] Fold 4: y_val bincount: [973 245], y_pred bincount: [1200   18]
[CV] Fold 4: AUC = 0.46925351846802443
manual auc_list: [np.float64(0.5060453379456713), np.float64(0.5036514342532942), np.float64(0.5057574931308597), np.float64(0.5294964028776978), np.float64(0.46925351846802443)]
manual auc mean (ignore nan): 0.5028408373351094
cross_val_score: [0.50604534 0.50365143 0.50575749 0.5294964  0.46925352]
X_train.shape: (6092, 135)
X_train nan: 13 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
y_train shape: (6092,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6092, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [973 246], y_pred bincount: [1015  204]
[CV] Fold 0: AUC = 0.5094544573400513
[CV] Fold 1: y_val bincount: [973 246], y_pred bincount: [957 262]
[CV] Fold 1: AUC = 0.4832134292565948
[CV] Fold 2: y_val bincount: [973 245], y_pred bincount: [1053  165]
[CV] Fold 2: AUC = 0.49764037166768044
[CV] Fold 3: y_val bincount: [973 245], y_pred bincount: [1042  176]
[CV] Fold 3: AUC = 0.524873628793758
[CV] Fold 4: y_val bincount: [973 245], y_pred bincount: [942 276]
[CV] Fold 4: AUC = 0.4770644126098538
manual auc_list: [np.float64(0.5094544573400513), np.float64(0.4832134292565948), np.float64(0.49764037166768044), np.float64(0.524873628793758), np.float64(0.4770644126098538)]
manual auc mean (ignore nan): 0.49844925993358763
cross_val_score: [0.50945446 0.48321343 0.49764037 0.52487363 0.47706441]
X_train.shape: (6092, 135)
X_train nan: 13 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
y_train shape: (6092,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6092, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [973 246], y_pred bincount: [1145   74]
[CV] Fold 0: AUC = 0.5133147837130992
[CV] Fold 1: y_val bincount: [973 246], y_pred bincount: [1147   72]
[CV] Fold 1: AUC = 0.4954252625773945
[CV] Fold 2: y_val bincount: [973 245], y_pred bincount: [1173   45]
[CV] Fold 2: AUC = 0.49231285525515445
[CV] Fold 3: y_val bincount: [973 245], y_pred bincount: [1158   60]
[CV] Fold 3: AUC = 0.5212282652012501
[CV] Fold 4: y_val bincount: [973 245], y_pred bincount: [1141   77]
[CV] Fold 4: AUC = 0.485491956289196
manual auc_list: [np.float64(0.5133147837130992), np.float64(0.4954252625773945), np.float64(0.49231285525515445), np.float64(0.5212282652012501), np.float64(0.485491956289196)]
manual auc mean (ignore nan): 0.5015546246072188
cross_val_score: [0.51331478 0.49542526 0.49231286 0.52122827 0.48549196]
X_train.shape: (6092, 135)
X_train nan: 13 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: [I 2025-08-11 19:05:46,943] Trial 4 finished with value: 0.49705151416092475 and parameters: {'n_estimators': 136, 'max_depth': 24, 'min_samples_split': 4, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.5028408373351094.
[I 2025-08-11 19:06:07,393] Trial 5 finished with value: 0.4993510258990418 and parameters: {'n_estimators': 176, 'max_depth': 7, 'min_samples_split': 4, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.5028408373351094.
[I 2025-08-11 19:06:42,447] Trial 6 finished with value: 0.4965357467279394 and parameters: {'n_estimators': 192, 'max_depth': 14, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.5028408373351094.
[I 2025-08-11 19:07:43,410] Trial 7 finished with value: 0.4985872480995507 and parameters: {'n_estimators': 296, 'max_depth': 19, 'min_samples_split': 4, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.5028408373351094.
['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
y_train shape: (6092,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6092, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [973 246], y_pred bincount: [1218    1]
[CV] Fold 0: AUC = 0.5108247896456355
[CV] Fold 1: y_val bincount: [973 246], y_pred bincount: [1218    1]
[CV] Fold 1: AUC = 0.5096006818238789
[CV] Fold 2: y_val bincount: [973 245], y_pred bincount: [1218]
[CV] Fold 2: AUC = 0.4841076410009019
[CV] Fold 3: y_val bincount: [973 245], y_pred bincount: [1214    4]
[CV] Fold 3: AUC = 0.5136061413260062
[CV] Fold 4: y_val bincount: [973 245], y_pred bincount: [1218]
[CV] Fold 4: AUC = 0.46711831700820095
manual auc_list: [np.float64(0.5108247896456355), np.float64(0.5096006818238789), np.float64(0.4841076410009019), np.float64(0.5136061413260062), np.float64(0.46711831700820095)]
manual auc mean (ignore nan): 0.49705151416092475
cross_val_score: [0.51082479 0.50960068 0.48410764 0.51360614 0.46711832]
X_train.shape: (6092, 135)
X_train nan: 13 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
y_train shape: (6092,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6092, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [973 246], y_pred bincount: [1015  204]
[CV] Fold 0: AUC = 0.5103610491397823
[CV] Fold 1: y_val bincount: [973 246], y_pred bincount: [949 270]
[CV] Fold 1: AUC = 0.4845294496110429
[CV] Fold 2: y_val bincount: [973 245], y_pred bincount: [1045  173]
[CV] Fold 2: AUC = 0.49921345722256016
[CV] Fold 3: y_val bincount: [973 245], y_pred bincount: [1043  175]
[CV] Fold 3: AUC = 0.5334437988967426
[CV] Fold 4: y_val bincount: [973 245], y_pred bincount: [939 279]
[CV] Fold 4: AUC = 0.4692073746250813
manual auc_list: [np.float64(0.5103610491397823), np.float64(0.4845294496110429), np.float64(0.49921345722256016), np.float64(0.5334437988967426), np.float64(0.4692073746250813)]
manual auc mean (ignore nan): 0.4993510258990418
cross_val_score: [0.51036105 0.48452945 0.49921346 0.5334438  0.46920737]
X_train.shape: (6092, 135)
X_train nan: 13 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
y_train shape: (6092,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6092, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [973 246], y_pred bincount: [1201   18]
[CV] Fold 0: AUC = 0.5029119561493662
[CV] Fold 1: y_val bincount: [973 246], y_pred bincount: [1202   17]
[CV] Fold 1: AUC = 0.4977356094218702
[CV] Fold 2: y_val bincount: [973 245], y_pred bincount: [1211    7]
[CV] Fold 2: AUC = 0.5016464962141074
[CV] Fold 3: y_val bincount: [973 245], y_pred bincount: [1199   19]
[CV] Fold 3: AUC = 0.5126161461501353
[CV] Fold 4: y_val bincount: [973 245], y_pred bincount: [1201   17]
[CV] Fold 4: AUC = 0.46776852570421795
manual auc_list: [np.float64(0.5029119561493662), np.float64(0.4977356094218702), np.float64(0.5016464962141074), np.float64(0.5126161461501353), np.float64(0.46776852570421795)]
manual auc mean (ignore nan): 0.4965357467279394
cross_val_score: [0.50291196 0.49773561 0.5016465  0.51261615 0.46776853]
X_train.shape: (6092, 135)
X_train nan: 13 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
y_train shape: (6092,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6092, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [973 246], y_pred bincount: [1216    3]
[CV] Fold 0: AUC = 0.5073697139849096
[CV] Fold 1: y_val bincount: [973 246], y_pred bincount: [1217    2]
[CV] Fold 1: AUC = 0.500229781331729
[CV] Fold 2: y_val bincount: [973 245], y_pred bincount: [1217    1]
[CV] Fold 2: AUC = 0.49858422300060823
[CV] Fold 3: y_val bincount: [973 245], y_pred bincount: [1214    4]
[CV] Fold 3: AUC = 0.5103131488977914
[CV] Fold 4: y_val bincount: [973 245], y_pred bincount: [1218]
[CV] Fold 4: AUC = 0.476439373282715
manual auc_list: [np.float64(0.5073697139849096), np.float64(0.500229781331729), np.float64(0.49858422300060823), np.float64(0.5103131488977914), np.float64(0.476439373282715)]
manual auc mean (ignore nan): 0.4985872480995507
cross_val_score: [0.50736971 0.50022978 0.49858422 0.51031315 0.47643937]
X_train.shape: (6092, 135)
X_train nan: 13 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
y_train shape: (6092,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6092, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [973 246], y_pred bincount: [1219]
[CV] Fold 0: AUC = 0.5070647314900693
[CV] Fold 1: y_val bincount: [973 246], y_pred bincount: [1218    1]
[CV] Fold 1: AUC = 0.509329122068199
[CV] Fold 2: y_val bincount: [973 245], y_pred bincount: [1218]
[CV] Fold 2: AUC = 0.48675461962791283
[CV] Fold 3: y_val bincount: [973 245], y_pred bincount: [1214    4]
[I 2025-08-11 19:08:22,533] Trial 8 finished with value: 0.49630308012709506 and parameters: {'n_estimators': 179, 'max_depth': 24, 'min_samples_split': 4, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.5028408373351094.
[I 2025-08-11 19:08:47,015] Trial 9 finished with value: 0.495107149720741 and parameters: {'n_estimators': 190, 'max_depth': 8, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.5028408373351094.
2025-08-11 19:08:47,016 - INFO - Best hyperparameters: {'n_estimators': 124, 'max_depth': 18, 'min_samples_split': 9, 'min_samples_leaf': 4}
2025-08-11 19:08:47,016 - INFO - Selected features (from input): ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
2025-08-11 19:08:50,067 - INFO - Saving RF with 10 features.
2025-08-11 19:08:50,378 - INFO - RF (Optuna) metrics: train acc=0.997, val acc=0.798, test acc=0.757
2025-08-11 19:08:50,400 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.76      0.98      0.86       585
         1.0       0.44      0.04      0.07       185

    accuracy                           0.76       770
   macro avg       0.60      0.51      0.46       770
weighted avg       0.69      0.76      0.67       770

2025-08-11 19:08:51,770 - INFO - Optimal threshold for F1: 0.242
2025-08-11 19:08:51,782 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.2437417654808959, "precision": 0.19054441260744986, "recall": 0.9366197183098591, "f1": 0.31666666666666665}
2025-08-11 19:08:51,782 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.2766233766233766, "precision": 0.2380281690140845, "recall": 0.9135135135135135, "f1": 0.3776536312849162}
2025-08-11 19:08:51,791 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_finetune_dtw_hard_finetune.csv
[CV] Fold 3: AUC = 0.5113325083373534
[CV] Fold 4: y_val bincount: [973 245], y_pred bincount: [1218]
[CV] Fold 4: AUC = 0.46703441911194077
manual auc_list: [np.float64(0.5070647314900693), np.float64(0.509329122068199), np.float64(0.48675461962791283), np.float64(0.5113325083373534), np.float64(0.46703441911194077)]
manual auc mean (ignore nan): 0.49630308012709506
cross_val_score: [0.50706473 0.50932912 0.48675462 0.51133251 0.46703442]
X_train.shape: (6092, 135)
X_train nan: 13 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'LongAcc_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'Steering_Skewness', 'Steering_SpectralEntropy', 'Lateral_SampleEntropy']
y_train shape: (6092,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6092, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [973 246], y_pred bincount: [1064  155]
[CV] Fold 0: AUC = 0.5041945537646537
[CV] Fold 1: y_val bincount: [973 246], y_pred bincount: [1022  197]
[CV] Fold 1: AUC = 0.4849221667961798
[CV] Fold 2: y_val bincount: [973 245], y_pred bincount: [1084  134]
[CV] Fold 2: AUC = 0.49553033957673515
[CV] Fold 3: y_val bincount: [973 245], y_pred bincount: [1081  137]
[CV] Fold 3: AUC = 0.5204689892400948
[CV] Fold 4: y_val bincount: [973 245], y_pred bincount: [1018  200]
[CV] Fold 4: AUC = 0.4704196992260419
manual auc_list: [np.float64(0.5041945537646537), np.float64(0.4849221667961798), np.float64(0.49553033957673515), np.float64(0.5204689892400948), np.float64(0.4704196992260419)]
manual auc mean (ignore nan): 0.495107149720741
cross_val_score: [0.50419455 0.48492217 0.49553034 0.52046899 0.4704197 ]

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=971108kb,walltime=00:07:50,ncpus=8,cpupercent=98,vmem=2395800kb
============================================================================================
