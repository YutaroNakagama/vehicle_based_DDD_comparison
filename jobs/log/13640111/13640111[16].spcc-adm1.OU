=== JOB INFO ===
IDX=16
NAME(line)=results/ranks/wasserstein_std_high.txt
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/results/ranks/wasserstein_std_high.txt
BASENAME=wasserstein_std_high
TARGETS(first few)=S0205_2 S0172_1 S0205_1 S0181_2 S0148_1 S0202_2 S0201_1 S0197_1 S0207_1 S0201_2
[PRETRAIN] pretrain_setting exists. Reusing: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_std_high.pkl
----- RUN: EVAL-ONLY (no fine-tune) -----
2025-08-16 18:01:03.109138: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:03.498243: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:03.833567: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755334864.104097 3032791 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755334864.178771 3032791 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755334864.834563 3032791 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334864.834616 3032791 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334864.834619 3032791 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334864.834621 3032791 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 18:01:04.902319: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 18:01:10,931 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_std_high | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 18:01:10,933 - INFO - Model type: common
2025-08-16 18:01:10,933 - INFO - Finetuning with target subjects: ['S0205_2', 'S0172_1', 'S0205_1', 'S0181_2', 'S0148_1', 'S0202_2', 'S0201_1', 'S0197_1', 'S0207_1', 'S0201_2']
2025-08-16 18:01:10,986 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 18:01:11,035 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 18:01:11,084 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 18:01:11,130 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 18:01:11,197 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 18:01:11,224 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 18:01:11,270 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 18:01:11,319 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 18:01:11,365 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 18:01:11,422 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 18:01:11,464 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 18:01:11,502 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 18:01:11,549 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 18:01:11,612 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 18:01:11,638 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 18:01:11,662 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 18:01:11,690 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 18:01:11,751 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 18:01:11,796 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 18:01:11,825 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 18:01:11,876 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 18:01:11,916 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 18:01:11,956 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 18:01:12,000 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 18:01:12,045 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 18:01:12,108 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 18:01:12,165 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 18:01:12,190 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 18:01:12,213 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 18:01:12,237 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 18:01:12,300 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 18:01:12,324 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 18:01:12,358 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 18:01:12,401 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 18:01:12,455 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 18:01:12,494 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 18:01:12,545 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 18:01:12,572 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 18:01:12,596 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 18:01:12,639 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 18:01:12,680 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 18:01:12,724 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 18:01:12,786 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 18:01:12,810 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 18:01:12,833 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 18:01:12,869 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 18:01:12,911 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 18:01:12,968 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 18:01:13,007 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 18:01:13,057 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 18:01:13,095 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 18:01:13,133 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 18:01:13,174 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 18:01:13,217 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 18:01:13,258 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 18:01:13,300 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 18:01:13,341 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 18:01:13,381 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 18:01:13,423 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 18:01:13,467 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 18:01:13,525 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 18:01:13,548 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 18:01:13,570 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 18:01:13,601 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 18:01:13,656 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 18:01:13,677 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 18:01:13,730 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 18:01:13,753 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 18:01:13,776 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 18:01:13,797 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 18:01:13,847 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 18:01:13,868 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 18:01:13,889 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 18:01:13,911 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 18:01:13,932 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 18:01:13,953 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 18:01:13,982 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 18:01:14,029 - INFO - [EvalOnly] Found existing pretrained model/scaler. Skipping retrain.
2025-08-16 18:01:14,393 - INFO - [EvalOnly] Loaded model features: ./model/common/selected_features_train_RF_pretrain_general.pkl (10 cols)
2025-08-16 18:01:14,415 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 18:01:14,441 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 18:01:14,462 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 18:01:14,488 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 18:01:14,514 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 18:01:14,536 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 18:01:14,558 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 18:01:14,584 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 18:01:14,607 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 18:01:14,630 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 18:01:14,676 - WARNING - [EvalOnly] feature mismatch before alignment: missing_in_val=[] extra_in_val=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 18:01:14,676 - WARNING - [EvalOnly] feature mismatch (test) before alignment: missing_in_test=[] extra_in_test=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 18:01:14,681 - INFO - [EvalOnly] scaler expects n_features=10, aligned_features=10
2025-08-16 18:01:15,020 - INFO - [EvalOnly] val pos_ratio=0.212, pred_pos_ratio=0.184
2025-08-16 18:01:15,020 - INFO - [EvalOnly] test pos_ratio=0.226, pred_pos_ratio=0.181
2025-08-16 18:01:15,023 - INFO - [EvalOnly] val CM=
[[576   7]
 [ 28 129]]
2025-08-16 18:01:15,024 - INFO - [EvalOnly] test CM=
[[574   7]
 [ 41 129]]
2025-08-16 18:01:15,024 - INFO - [EvalOnly] RF on targets: val acc=0.953 auc=0.964 ap=0.933 | test acc=0.936 auc=0.931 ap=0.897
2025-08-16 18:01:15,030 - INFO - [EvalOnly] Saved -> ./model/common/metrics_RF_rank_wasserstein_std_high_evalonly_on_targets.csv
----- RUN: FINE-TUNE (use target-train) -----
2025-08-16 18:01:17.425119: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:17.429390: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:17.440673: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755334877.458974 3032819 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755334877.464454 3032819 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755334877.479205 3032819 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334877.479230 3032819 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334877.479232 3032819 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334877.479234 3032819 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 18:01:17.483637: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 18:01:20,211 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_std_high | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 18:01:20,212 - INFO - Model type: common
2025-08-16 18:01:20,212 - INFO - Finetuning with target subjects: ['S0205_2', 'S0172_1', 'S0205_1', 'S0181_2', 'S0148_1', 'S0202_2', 'S0201_1', 'S0197_1', 'S0207_1', 'S0201_2']
2025-08-16 18:01:20,239 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 18:01:20,264 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 18:01:20,290 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 18:01:20,315 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 18:01:20,341 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 18:01:20,366 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 18:01:20,391 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 18:01:20,415 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 18:01:20,440 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 18:01:20,465 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 18:01:20,489 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 18:01:20,514 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 18:01:20,539 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 18:01:20,563 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 18:01:20,587 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 18:01:20,611 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 18:01:20,635 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 18:01:20,659 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 18:01:20,683 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 18:01:20,706 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 18:01:20,730 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 18:01:20,753 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 18:01:20,776 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 18:01:20,799 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 18:01:20,822 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 18:01:20,845 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 18:01:20,868 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 18:01:20,891 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 18:01:20,914 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 18:01:20,937 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 18:01:20,960 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 18:01:20,983 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 18:01:21,006 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 18:01:21,029 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 18:01:21,051 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 18:01:21,074 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 18:01:21,097 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 18:01:21,120 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 18:01:21,143 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 18:01:21,165 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 18:01:21,188 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 18:01:21,210 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 18:01:21,233 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 18:01:21,255 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 18:01:21,278 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 18:01:21,300 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 18:01:21,323 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 18:01:21,346 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 18:01:21,368 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 18:01:21,390 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 18:01:21,412 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 18:01:21,435 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 18:01:21,457 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 18:01:21,479 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 18:01:21,501 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 18:01:21,524 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 18:01:21,546 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 18:01:21,568 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 18:01:21,590 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 18:01:21,612 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 18:01:21,634 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 18:01:21,656 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 18:01:21,678 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 18:01:21,701 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 18:01:21,722 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 18:01:21,744 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 18:01:21,766 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 18:01:21,788 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 18:01:21,821 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 18:01:21,843 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 18:01:21,865 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 18:01:21,886 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 18:01:21,907 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 18:01:21,928 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 18:01:21,949 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 18:01:21,970 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 18:01:21,990 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 18:01:22,032 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_std_high.pkl: features=['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
2025-08-16 18:01:22,054 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 18:01:22,077 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 18:01:22,098 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 18:01:22,121 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 18:01:22,146 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 18:01:22,167 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 18:01:22,189 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 18:01:22,213 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 18:01:22,234 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 18:01:22,256 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 18:01:22,300 - INFO - [split:finetune_setting] global  : n=7442, pos=1978, pos_ratio=0.266
2025-08-16 18:01:22,300 - INFO - [split:finetune_setting] train   : n=5951, pos=1651, pos_ratio=0.277, |Δ|=0.012
2025-08-16 18:01:22,300 - INFO - [split:finetune_setting] val     : n=740, pos=157, pos_ratio=0.212, |Δ|=0.054
2025-08-16 18:01:22,301 - INFO - [split:finetune_setting] test    : n=751, pos=170, pos_ratio=0.226, |Δ|=0.039
[I 2025-08-16 18:01:22,305] A new study created in memory with name: no-name-c5b60a2b-14f8-4d3c-8a71-31b6d1560714
[I 2025-08-16 18:02:03,555] Trial 0 finished with value: 0.5016474518245051 and parameters: {'n_estimators': 213, 'max_depth': 24, 'min_samples_split': 9, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.5016474518245051.
[I 2025-08-16 18:02:43,672] Trial 1 finished with value: 0.4978608675102036 and parameters: {'n_estimators': 214, 'max_depth': 24, 'min_samples_split': 7, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.5016474518245051.
[I 2025-08-16 18:03:19,063] Trial 2 finished with value: 0.5017824113402698 and parameters: {'n_estimators': 260, 'max_depth': 10, 'min_samples_split': 7, 'min_samples_leaf': 1}. Best is trial 2 with value: 0.5017824113402698.
[I 2025-08-16 18:03:46,882] Trial 3 finished with value: 0.5021135772819887 and parameters: {'n_estimators': 243, 'max_depth': 8, 'min_samples_split': 10, 'min_samples_leaf': 3}. Best is trial 3 with value: 0.5021135772819887.
X_train.shape: (5951, 135)
X_train nan: 28 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 22  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
y_train shape: (5951,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5951, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [860 331], y_pred bincount: [1168   23]
[CV] Fold 0: AUC = 0.5119370477060353
[CV] Fold 1: y_val bincount: [860 330], y_pred bincount: [1171   19]
[CV] Fold 1: AUC = 0.496261451726568
[CV] Fold 2: y_val bincount: [860 330], y_pred bincount: [1164   26]
[CV] Fold 2: AUC = 0.5168357998590556
[CV] Fold 3: y_val bincount: [860 330], y_pred bincount: [1169   21]
[CV] Fold 3: AUC = 0.48700493305144466
[CV] Fold 4: y_val bincount: [860 330], y_pred bincount: [1175   15]
[CV] Fold 4: AUC = 0.49619802677942215
manual auc_list: [np.float64(0.5119370477060353), np.float64(0.496261451726568), np.float64(0.5168357998590556), np.float64(0.48700493305144466), np.float64(0.49619802677942215)]
manual auc mean (ignore nan): 0.5016474518245051
cross_val_score: [0.51193705 0.49626145 0.5168358  0.48700493 0.49619803]
X_train.shape: (5951, 135)
X_train nan: 28 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 22  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
y_train shape: (5951,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5951, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [860 331], y_pred bincount: [1146   45]
[CV] Fold 0: AUC = 0.516777910489707
[CV] Fold 1: y_val bincount: [860 330], y_pred bincount: [1162   28]
[CV] Fold 1: AUC = 0.4732346723044397
[CV] Fold 2: y_val bincount: [860 330], y_pred bincount: [1165   25]
[CV] Fold 2: AUC = 0.5038231148696265
[CV] Fold 3: y_val bincount: [860 330], y_pred bincount: [1149   41]
[CV] Fold 3: AUC = 0.491508104298802
[CV] Fold 4: y_val bincount: [860 330], y_pred bincount: [1168   22]
[CV] Fold 4: AUC = 0.5039605355884426
manual auc_list: [np.float64(0.516777910489707), np.float64(0.4732346723044397), np.float64(0.5038231148696265), np.float64(0.491508104298802), np.float64(0.5039605355884426)]
manual auc mean (ignore nan): 0.4978608675102036
cross_val_score: [0.51677791 0.47323467 0.50382311 0.4915081  0.50396054]
X_train.shape: (5951, 135)
X_train nan: 28 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 22  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
y_train shape: (5951,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5951, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [860 331], y_pred bincount: [981 210]
[CV] Fold 0: AUC = 0.5066957071594183
[CV] Fold 1: y_val bincount: [860 330], y_pred bincount: [1036  154]
[CV] Fold 1: AUC = 0.49678999295278364
[CV] Fold 2: y_val bincount: [860 330], y_pred bincount: [1044  146]
[CV] Fold 2: AUC = 0.5166208597603946
[CV] Fold 3: y_val bincount: [860 330], y_pred bincount: [1003  187]
[CV] Fold 3: AUC = 0.49221987315010574
[CV] Fold 4: y_val bincount: [860 330], y_pred bincount: [1028  162]
[CV] Fold 4: AUC = 0.4965856236786469
manual auc_list: [np.float64(0.5066957071594183), np.float64(0.49678999295278364), np.float64(0.5166208597603946), np.float64(0.49221987315010574), np.float64(0.4965856236786469)]
manual auc mean (ignore nan): 0.5017824113402698
cross_val_score: [0.50669571 0.49678999 0.51662086 0.49221987 0.49658562]
X_train.shape: (5951, 135)
X_train nan: 28 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 22  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
y_train shape: (5951,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5951, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [860 331], y_pred bincount: [884 307]
[CV] Fold 0: AUC = 0.499806787044193
[CV] Fold 1: y_val bincount: [860 330], y_pred bincount: [938 252]
[CV] Fold 1: AUC = 0.5016560958421423
[CV] Fold 2: y_val bincount: [860 330], y_pred bincount: [962 228]
[CV] Fold 2: AUC = 0.5248273431994361
[CV] Fold 3: y_val bincount: [860 330], y_pred bincount: [896 294]
[CV] Fold 3: AUC = 0.48049682875264266
[CV] Fold 4: y_val bincount: [860 330], y_pred bincount: [947 243]
[CV] Fold 4: AUC = 0.5037808315715293
manual auc_list: [np.float64(0.499806787044193), np.float64(0.5016560958421423), np.float64(0.5248273431994361), np.float64(0.48049682875264266), np.float64(0.5037808315715293)]
manual auc mean (ignore nan): 0.5021135772819887
cross_val_score: [0.49980679 0.5016561  0.52482734 0.48049683 0.50378083]
X_train.shape: (5951, 135)
X_train nan: 28 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 22  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: [I 2025-08-16 18:04:05,332] Trial 4 finished with value: 0.4961984185280047 and parameters: {'n_estimators': 146, 'max_depth': 9, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.5021135772819887.
[I 2025-08-16 18:04:30,110] Trial 5 finished with value: 0.49852832619030896 and parameters: {'n_estimators': 175, 'max_depth': 11, 'min_samples_split': 8, 'min_samples_leaf': 5}. Best is trial 3 with value: 0.5021135772819887.
[I 2025-08-16 18:05:06,798] Trial 6 finished with value: 0.5088224527293591 and parameters: {'n_estimators': 202, 'max_depth': 17, 'min_samples_split': 6, 'min_samples_leaf': 2}. Best is trial 6 with value: 0.5088224527293591.
[I 2025-08-16 18:05:39,130] Trial 7 finished with value: 0.5041742770216037 and parameters: {'n_estimators': 161, 'max_depth': 28, 'min_samples_split': 7, 'min_samples_leaf': 1}. Best is trial 6 with value: 0.5088224527293591.
['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
y_train shape: (5951,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5951, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [860 331], y_pred bincount: [936 255]
[CV] Fold 0: AUC = 0.49586524274573174
[CV] Fold 1: y_val bincount: [860 330], y_pred bincount: [985 205]
[CV] Fold 1: AUC = 0.48788231148696265
[CV] Fold 2: y_val bincount: [860 330], y_pred bincount: [1032  158]
[CV] Fold 2: AUC = 0.5191789992952784
[CV] Fold 3: y_val bincount: [860 330], y_pred bincount: [960 230]
[CV] Fold 3: AUC = 0.4899471458773784
[CV] Fold 4: y_val bincount: [860 330], y_pred bincount: [986 204]
[CV] Fold 4: AUC = 0.4881183932346723
manual auc_list: [np.float64(0.49586524274573174), np.float64(0.48788231148696265), np.float64(0.5191789992952784), np.float64(0.4899471458773784), np.float64(0.4881183932346723)]
manual auc mean (ignore nan): 0.4961984185280047
cross_val_score: [0.49586524 0.48788231 0.519179   0.48994715 0.48811839]
X_train.shape: (5951, 135)
X_train nan: 28 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 22  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
y_train shape: (5951,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5951, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [860 331], y_pred bincount: [986 205]
[CV] Fold 0: AUC = 0.5038431813391414
[CV] Fold 1: y_val bincount: [860 330], y_pred bincount: [1046  144]
[CV] Fold 1: AUC = 0.4970436927413671
[CV] Fold 2: y_val bincount: [860 330], y_pred bincount: [1057  133]
[CV] Fold 2: AUC = 0.512445384073291
[CV] Fold 3: y_val bincount: [860 330], y_pred bincount: [995 195]
[CV] Fold 3: AUC = 0.4918569415081043
[CV] Fold 4: y_val bincount: [860 330], y_pred bincount: [1030  160]
[CV] Fold 4: AUC = 0.48745243128964055
manual auc_list: [np.float64(0.5038431813391414), np.float64(0.4970436927413671), np.float64(0.512445384073291), np.float64(0.4918569415081043), np.float64(0.48745243128964055)]
manual auc mean (ignore nan): 0.49852832619030896
cross_val_score: [0.50384318 0.49704369 0.51244538 0.49185694 0.48745243]
X_train.shape: (5951, 135)
X_train nan: 28 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 22  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
y_train shape: (5951,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5951, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [860 331], y_pred bincount: [1148   43]
[CV] Fold 0: AUC = 0.5103948570224127
[CV] Fold 1: y_val bincount: [860 330], y_pred bincount: [1156   34]
[CV] Fold 1: AUC = 0.5033615221987315
[CV] Fold 2: y_val bincount: [860 330], y_pred bincount: [1159   31]
[CV] Fold 2: AUC = 0.5127801268498943
[CV] Fold 3: y_val bincount: [860 330], y_pred bincount: [1142   48]
[CV] Fold 3: AUC = 0.49750176180408734
[CV] Fold 4: y_val bincount: [860 330], y_pred bincount: [1159   31]
[CV] Fold 4: AUC = 0.5200739957716701
manual auc_list: [np.float64(0.5103948570224127), np.float64(0.5033615221987315), np.float64(0.5127801268498943), np.float64(0.49750176180408734), np.float64(0.5200739957716701)]
manual auc mean (ignore nan): 0.5088224527293591
cross_val_score: [0.51039486 0.50336152 0.51278013 0.49750176 0.520074  ]
X_train.shape: (5951, 135)
X_train nan: 28 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 22  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
y_train shape: (5951,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5951, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [860 331], y_pred bincount: [1174   17]
[CV] Fold 0: AUC = 0.5240708213307104
[CV] Fold 1: y_val bincount: [860 330], y_pred bincount: [1176   14]
[CV] Fold 1: AUC = 0.48697674418604653
[CV] Fold 2: y_val bincount: [860 330], y_pred bincount: [1180   10]
[CV] Fold 2: AUC = 0.5186363636363637
[CV] Fold 3: y_val bincount: [860 330], y_pred bincount: [1180   10]
[CV] Fold 3: AUC = 0.4882980972515857
[CV] Fold 4: y_val bincount: [860 330], y_pred bincount: [1182    8]
[CV] Fold 4: AUC = 0.5028893587033122
manual auc_list: [np.float64(0.5240708213307104), np.float64(0.48697674418604653), np.float64(0.5186363636363637), np.float64(0.4882980972515857), np.float64(0.5028893587033122)]
manual auc mean (ignore nan): 0.5041742770216037
cross_val_score: [0.52407082 0.48697674 0.51863636 0.4882981  0.50288936]
X_train.shape: (5951, 135)
X_train nan: 28 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 22  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
y_train shape: (5951,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5951, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [860 331], y_pred bincount: [984 207]
[CV] Fold 0: AUC = 0.5033478535797091
[CV] Fold 1: y_val bincount: [860 330], y_pred bincount: [1049  141]
[CV] Fold 1: AUC = 0.4955708245243129
[CV] Fold 2: y_val bincount: [860 330], y_pred bincount: [1057  133]
[CV] Fold 2: AUC = 0.5137420718816067
[I 2025-08-16 18:06:05,502] Trial 8 finished with value: 0.4984391267413118 and parameters: {'n_estimators': 186, 'max_depth': 11, 'min_samples_split': 6, 'min_samples_leaf': 5}. Best is trial 6 with value: 0.5088224527293591.
[I 2025-08-16 18:06:55,962] Trial 9 finished with value: 0.5064062517964014 and parameters: {'n_estimators': 286, 'max_depth': 17, 'min_samples_split': 3, 'min_samples_leaf': 4}. Best is trial 6 with value: 0.5088224527293591.
2025-08-16 18:06:55,963 - INFO - Best hyperparameters: {'n_estimators': 202, 'max_depth': 17, 'min_samples_split': 6, 'min_samples_leaf': 2}
2025-08-16 18:06:55,963 - INFO - Selected features (from input): ['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
2025-08-16 18:06:56,674 - INFO - Saving RF with 10 features.
2025-08-16 18:06:57,284 - INFO - RF (Optuna) metrics: train acc=0.999, val acc=0.768, test acc=0.750
2025-08-16 18:06:57,345 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.77      0.96      0.86       581
         1.0       0.12      0.02      0.03       170

    accuracy                           0.75       751
   macro avg       0.45      0.49      0.44       751
weighted avg       0.62      0.75      0.67       751

2025-08-16 18:06:58,559 - INFO - Optimal threshold for F1: 0.219
2025-08-16 18:06:58,570 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.21621621621621623, "precision": 0.2130257801899593, "recall": 1.0, "f1": 0.3512304250559284}
2025-08-16 18:06:58,570 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.2303595206391478, "precision": 0.22727272727272727, "recall": 1.0, "f1": 0.37037037037037035}
2025-08-16 18:06:58,577 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_rank_wasserstein_std_high.csv
[CV] Fold 3: y_val bincount: [860 330], y_pred bincount: [995 195]
[CV] Fold 3: AUC = 0.49384073291050035
[CV] Fold 4: y_val bincount: [860 330], y_pred bincount: [1030  160]
[CV] Fold 4: AUC = 0.4856941508104299
manual auc_list: [np.float64(0.5033478535797091), np.float64(0.4955708245243129), np.float64(0.5137420718816067), np.float64(0.49384073291050035), np.float64(0.4856941508104299)]
manual auc mean (ignore nan): 0.4984391267413118
cross_val_score: [0.50334785 0.49557082 0.51374207 0.49384073 0.48569415]
X_train.shape: (5951, 135)
X_train nan: 28 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 22  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['lat_acc_pred_error', 'steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Lateral_Skewness', 'Lateral_SampleEntropy', 'Steering_Skewness', 'SteeringSpeed_Median', 'LongAcc_Skewness']
y_train shape: (5951,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5951, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [860 331], y_pred bincount: [1135   56]
[CV] Fold 0: AUC = 0.5052659312864469
[CV] Fold 1: y_val bincount: [860 330], y_pred bincount: [1138   52]
[CV] Fold 1: AUC = 0.5008491895701198
[CV] Fold 2: y_val bincount: [860 330], y_pred bincount: [1148   42]
[CV] Fold 2: AUC = 0.5158949964763918
[CV] Fold 3: y_val bincount: [860 330], y_pred bincount: [1145   45]
[CV] Fold 3: AUC = 0.5028083157152925
[CV] Fold 4: y_val bincount: [860 330], y_pred bincount: [1145   45]
[CV] Fold 4: AUC = 0.5072128259337562
manual auc_list: [np.float64(0.5052659312864469), np.float64(0.5008491895701198), np.float64(0.5158949964763918), np.float64(0.5028083157152925), np.float64(0.5072128259337562)]
manual auc mean (ignore nan): 0.5064062517964014
cross_val_score: [0.50526593 0.50084919 0.515895   0.50280832 0.50721283]
=== DONE (BASENAME=wasserstein_std_high) ===

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=856136kb,walltime=00:06:03,ncpus=8,cpupercent=100,vmem=2270424kb
============================================================================================
