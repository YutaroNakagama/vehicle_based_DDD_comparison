=== JOB INFO ===
IDX=15
NAME(line)=results/ranks/wasserstein_mean_middle.txt
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/results/ranks/wasserstein_mean_middle.txt
BASENAME=wasserstein_mean_middle
TARGETS(first few)=S0181_2 S0147_2 S0204_2 S0169_2 S0116_1 S0189_2 S0140_1 S0139_2 S0193_1 S0185_2
[PRETRAIN] pretrain_setting exists. Reusing: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_mean_middle.pkl
----- RUN: EVAL-ONLY (no fine-tune) -----
2025-08-16 09:27:47.986556: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 09:27:48.372858: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 09:27:48.707423: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755304068.974896 4120582 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755304069.049950 4120582 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755304069.695749 4120582 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755304069.695786 4120582 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755304069.695788 4120582 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755304069.695790 4120582 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 09:27:49.761806: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 09:27:55,816 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_mean_middle | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 09:27:55,818 - INFO - Model type: common
2025-08-16 09:27:55,818 - INFO - Finetuning with target subjects: ['S0181_2', 'S0147_2', 'S0204_2', 'S0169_2', 'S0116_1', 'S0189_2', 'S0140_1', 'S0139_2', 'S0193_1', 'S0185_2']
2025-08-16 09:27:55,874 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 09:27:55,924 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 09:27:55,972 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 09:27:56,020 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 09:27:56,078 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 09:27:56,121 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 09:27:56,156 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 09:27:56,204 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 09:27:56,249 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 09:27:56,314 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 09:27:56,341 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 09:27:56,366 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 09:27:56,401 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 09:27:56,463 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 09:27:56,506 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 09:27:56,550 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 09:27:56,594 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 09:27:56,657 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 09:27:56,703 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 09:27:56,749 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 09:27:56,811 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 09:27:56,836 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 09:27:56,860 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 09:27:56,891 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 09:27:56,936 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 09:27:56,980 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 09:27:57,032 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 09:27:57,082 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 09:27:57,125 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 09:27:57,166 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 09:27:57,217 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 09:27:57,240 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 09:27:57,269 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 09:27:57,328 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 09:27:57,351 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 09:27:57,375 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 09:27:57,402 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 09:27:57,458 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 09:27:57,481 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 09:27:57,504 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 09:27:57,527 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 09:27:57,550 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 09:27:57,589 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 09:27:57,632 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 09:27:57,676 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 09:27:57,735 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 09:27:57,774 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 09:27:57,824 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 09:27:57,847 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 09:27:57,900 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 09:27:57,924 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 09:27:57,982 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 09:27:58,005 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 09:27:58,027 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 09:27:58,052 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 09:27:58,082 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 09:27:58,142 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 09:27:58,165 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 09:27:58,223 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 09:27:58,245 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 09:27:58,269 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 09:27:58,292 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 09:27:58,314 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 09:27:58,337 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 09:27:58,359 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 09:27:58,382 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 09:27:58,414 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 09:27:58,468 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 09:27:58,512 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 09:27:58,552 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 09:27:58,606 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 09:27:58,649 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 09:27:58,689 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 09:27:58,726 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 09:27:58,762 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 09:27:58,802 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 09:27:58,837 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 09:27:58,885 - INFO - [EvalOnly] Found existing pretrained model/scaler. Skipping retrain.
2025-08-16 09:27:59,233 - INFO - [EvalOnly] Loaded model features: ./model/common/selected_features_train_RF_pretrain_general.pkl (10 cols)
2025-08-16 09:27:59,260 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 09:27:59,281 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 09:27:59,303 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 09:27:59,323 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 09:27:59,351 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 09:27:59,374 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 09:27:59,399 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 09:27:59,421 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 09:27:59,443 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 09:27:59,465 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 09:27:59,509 - WARNING - [EvalOnly] feature mismatch before alignment: missing_in_val=[] extra_in_val=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 09:27:59,509 - WARNING - [EvalOnly] feature mismatch (test) before alignment: missing_in_test=[] extra_in_test=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 09:27:59,845 - INFO - [EvalOnly] RF on targets (no fine-tune): val acc=0.948, test acc=0.932
2025-08-16 09:27:59,849 - INFO - [EvalOnly] Saved -> ./model/common/metrics_RF_rank_wasserstein_mean_middle_evalonly_on_targets.csv
----- RUN: FINE-TUNE (use target-train) -----
2025-08-16 09:28:02.292774: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 09:28:02.296885: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 09:28:02.308042: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755304082.326079 4120609 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755304082.331539 4120609 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755304082.346025 4120609 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755304082.346049 4120609 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755304082.346052 4120609 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755304082.346054 4120609 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 09:28:02.350332: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 09:28:05,041 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_mean_middle | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 09:28:05,041 - INFO - Model type: common
2025-08-16 09:28:05,042 - INFO - Finetuning with target subjects: ['S0181_2', 'S0147_2', 'S0204_2', 'S0169_2', 'S0116_1', 'S0189_2', 'S0140_1', 'S0139_2', 'S0193_1', 'S0185_2']
2025-08-16 09:28:05,069 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 09:28:05,094 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 09:28:05,120 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 09:28:05,145 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 09:28:05,170 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 09:28:05,195 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 09:28:05,220 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 09:28:05,244 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 09:28:05,269 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 09:28:05,294 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 09:28:05,319 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 09:28:05,344 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 09:28:05,368 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 09:28:05,392 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 09:28:05,416 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 09:28:05,440 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 09:28:05,464 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 09:28:05,487 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 09:28:05,511 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 09:28:05,534 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 09:28:05,558 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 09:28:05,581 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 09:28:05,605 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 09:28:05,628 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 09:28:05,651 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 09:28:05,674 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 09:28:05,696 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 09:28:05,719 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 09:28:05,743 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 09:28:05,765 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 09:28:05,788 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 09:28:05,811 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 09:28:05,834 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 09:28:05,857 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 09:28:05,879 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 09:28:05,902 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 09:28:05,925 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 09:28:05,948 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 09:28:05,971 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 09:28:05,993 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 09:28:06,016 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 09:28:06,038 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 09:28:06,061 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 09:28:06,084 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 09:28:06,107 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 09:28:06,129 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 09:28:06,152 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 09:28:06,175 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 09:28:06,197 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 09:28:06,219 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 09:28:06,242 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 09:28:06,264 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 09:28:06,287 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 09:28:06,309 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 09:28:06,331 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 09:28:06,353 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 09:28:06,376 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 09:28:06,398 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 09:28:06,420 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 09:28:06,443 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 09:28:06,465 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 09:28:06,487 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 09:28:06,509 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 09:28:06,531 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 09:28:06,553 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 09:28:06,575 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 09:28:06,597 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 09:28:06,619 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 09:28:06,641 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 09:28:06,670 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 09:28:06,692 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 09:28:06,713 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 09:28:06,734 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 09:28:06,755 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 09:28:06,777 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 09:28:06,797 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 09:28:06,817 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 09:28:06,857 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_mean_middle.pkl: features=['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
2025-08-16 09:28:06,882 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 09:28:06,902 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 09:28:06,924 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 09:28:06,944 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 09:28:06,969 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 09:28:06,990 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 09:28:07,014 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 09:28:07,034 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 09:28:07,055 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 09:28:07,075 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 09:28:07,116 - INFO - [split:finetune_setting] global  : n=7398, pos=1856, pos_ratio=0.251
2025-08-16 09:28:07,116 - INFO - [split:finetune_setting] train   : n=5913, pos=1471, pos_ratio=0.249, |Δ|=0.002
2025-08-16 09:28:07,116 - INFO - [split:finetune_setting] val     : n=737, pos=181, pos_ratio=0.246, |Δ|=0.005
2025-08-16 09:28:07,116 - INFO - [split:finetune_setting] test    : n=748, pos=204, pos_ratio=0.273, |Δ|=0.022
[I 2025-08-16 09:28:07,118] A new study created in memory with name: no-name-0f23a78f-5c69-466e-b084-3ee83fc004d5
[I 2025-08-16 09:28:25,821] Trial 0 finished with value: 0.518232850901607 and parameters: {'n_estimators': 183, 'max_depth': 6, 'min_samples_split': 8, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.518232850901607.
[I 2025-08-16 09:29:05,384] Trial 1 finished with value: 0.511101622019288 and parameters: {'n_estimators': 275, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.518232850901607.
[I 2025-08-16 09:29:40,762] Trial 2 finished with value: 0.5080798103117438 and parameters: {'n_estimators': 244, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.518232850901607.
[I 2025-08-16 09:30:23,182] Trial 3 finished with value: 0.5132173763192237 and parameters: {'n_estimators': 220, 'max_depth': 25, 'min_samples_split': 7, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.518232850901607.
X_train.shape: (5913, 135)
X_train nan: 27 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
y_train shape: (5913,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5913, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 3]
[CV] Fold 0: y_val bincount: [889 294], y_pred bincount: [896 287]
[CV] Fold 0: AUC = 0.5138388313705685
[CV] Fold 1: y_val bincount: [889 294], y_pred bincount: [867 316]
[CV] Fold 1: AUC = 0.5178906208152552
[CV] Fold 2: y_val bincount: [888 295], y_pred bincount: [804 379]
[CV] Fold 2: AUC = 0.5284203695220644
[CV] Fold 3: y_val bincount: [888 294], y_pred bincount: [865 317]
[CV] Fold 3: AUC = 0.5326959612673898
[CV] Fold 4: y_val bincount: [888 294], y_pred bincount: [822 360]
[CV] Fold 4: AUC = 0.4983184715327572
manual auc_list: [np.float64(0.5138388313705685), np.float64(0.5178906208152552), np.float64(0.5284203695220644), np.float64(0.5326959612673898), np.float64(0.4983184715327572)]
manual auc mean (ignore nan): 0.518232850901607
cross_val_score: [0.51383883 0.51789062 0.52842037 0.53269596 0.49831847]
X_train.shape: (5913, 135)
X_train nan: 27 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
y_train shape: (5913,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5913, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 3]
[CV] Fold 0: y_val bincount: [889 294], y_pred bincount: [1081  102]
[CV] Fold 0: AUC = 0.5082413167741787
[CV] Fold 1: y_val bincount: [889 294], y_pred bincount: [1058  125]
[CV] Fold 1: AUC = 0.5230404872860281
[CV] Fold 2: y_val bincount: [888 295], y_pred bincount: [1041  142]
[CV] Fold 2: AUC = 0.4990876469690029
[CV] Fold 3: y_val bincount: [888 294], y_pred bincount: [1049  133]
[CV] Fold 3: AUC = 0.5165280075994362
[CV] Fold 4: y_val bincount: [888 294], y_pred bincount: [1023  159]
[CV] Fold 4: AUC = 0.5086106514677944
manual auc_list: [np.float64(0.5082413167741787), np.float64(0.5230404872860281), np.float64(0.4990876469690029), np.float64(0.5165280075994362), np.float64(0.5086106514677944)]
manual auc mean (ignore nan): 0.511101622019288
cross_val_score: [0.50824132 0.52304049 0.49908765 0.51652801 0.50861065]
X_train.shape: (5913, 135)
X_train nan: 27 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
y_train shape: (5913,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5913, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 3]
[CV] Fold 0: y_val bincount: [889 294], y_pred bincount: [1082  101]
[CV] Fold 0: AUC = 0.5082030562506217
[CV] Fold 1: y_val bincount: [889 294], y_pred bincount: [1058  125]
[CV] Fold 1: AUC = 0.5165859369619614
[CV] Fold 2: y_val bincount: [888 295], y_pred bincount: [1036  147]
[CV] Fold 2: AUC = 0.4962284318216521
[CV] Fold 3: y_val bincount: [888 294], y_pred bincount: [1045  137]
[CV] Fold 3: AUC = 0.5236256664828094
[CV] Fold 4: y_val bincount: [888 294], y_pred bincount: [1025  157]
[CV] Fold 4: AUC = 0.4957559600416743
manual auc_list: [np.float64(0.5082030562506217), np.float64(0.5165859369619614), np.float64(0.4962284318216521), np.float64(0.5236256664828094), np.float64(0.4957559600416743)]
manual auc mean (ignore nan): 0.5080798103117438
cross_val_score: [0.50820306 0.51658594 0.49622843 0.52362567 0.49575596]
X_train.shape: (5913, 135)
X_train nan: 27 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
y_train shape: (5913,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5913, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 3]
[CV] Fold 0: y_val bincount: [889 294], y_pred bincount: [1149   34]
[CV] Fold 0: AUC = 0.48683455384403473
[CV] Fold 1: y_val bincount: [889 294], y_pred bincount: [1158   25]
[CV] Fold 1: AUC = 0.5228606628253101
[CV] Fold 2: y_val bincount: [888 295], y_pred bincount: [1148   35]
[CV] Fold 2: AUC = 0.5086883493663155
[CV] Fold 3: y_val bincount: [888 294], y_pred bincount: [1154   28]
[CV] Fold 3: AUC = 0.5143753447324876
[CV] Fold 4: y_val bincount: [888 294], y_pred bincount: [1145   37]
[CV] Fold 4: AUC = 0.5333279708279708
manual auc_list: [np.float64(0.48683455384403473), np.float64(0.5228606628253101), np.float64(0.5086883493663155), np.float64(0.5143753447324876), np.float64(0.5333279708279708)]
manual auc mean (ignore nan): 0.5132173763192237
cross_val_score: [0.48683455 0.52286066 0.50868835 0.51437534 0.53332797]
X_train.shape: (5913, 135)
X_train nan: 27 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: [I 2025-08-16 09:31:09,836] Trial 4 finished with value: 0.5128266280185486 and parameters: {'n_estimators': 245, 'max_depth': 21, 'min_samples_split': 3, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.518232850901607.
[I 2025-08-16 09:31:34,213] Trial 5 finished with value: 0.5142304170474068 and parameters: {'n_estimators': 215, 'max_depth': 7, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.518232850901607.
[I 2025-08-16 09:32:12,022] Trial 6 finished with value: 0.5134603856801923 and parameters: {'n_estimators': 198, 'max_depth': 18, 'min_samples_split': 2, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.518232850901607.
[I 2025-08-16 09:33:00,581] Trial 7 finished with value: 0.5128853532864283 and parameters: {'n_estimators': 260, 'max_depth': 17, 'min_samples_split': 8, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.518232850901607.
['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
y_train shape: (5913,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5913, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 3]
[CV] Fold 0: y_val bincount: [889 294], y_pred bincount: [1153   30]
[CV] Fold 0: AUC = 0.4923746776550891
[CV] Fold 1: y_val bincount: [889 294], y_pred bincount: [1160   23]
[CV] Fold 1: AUC = 0.5177681871398728
[CV] Fold 2: y_val bincount: [888 295], y_pred bincount: [1150   33]
[CV] Fold 2: AUC = 0.5063635669567873
[CV] Fold 3: y_val bincount: [888 294], y_pred bincount: [1148   34]
[CV] Fold 3: AUC = 0.5199178770607342
[CV] Fold 4: y_val bincount: [888 294], y_pred bincount: [1147   35]
[CV] Fold 4: AUC = 0.5277088312802598
manual auc_list: [np.float64(0.4923746776550891), np.float64(0.5177681871398728), np.float64(0.5063635669567873), np.float64(0.5199178770607342), np.float64(0.5277088312802598)]
manual auc mean (ignore nan): 0.5128266280185486
cross_val_score: [0.49237468 0.51776819 0.50636357 0.51991788 0.52770883]
X_train.shape: (5913, 135)
X_train nan: 27 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
y_train shape: (5913,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5913, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 3]
[CV] Fold 0: y_val bincount: [889 294], y_pred bincount: [953 230]
[CV] Fold 0: AUC = 0.5059074248372014
[CV] Fold 1: y_val bincount: [889 294], y_pred bincount: [910 273]
[CV] Fold 1: AUC = 0.5223403197049349
[CV] Fold 2: y_val bincount: [888 295], y_pred bincount: [864 319]
[CV] Fold 2: AUC = 0.521258970835242
[CV] Fold 3: y_val bincount: [888 294], y_pred bincount: [919 263]
[CV] Fold 3: AUC = 0.52282895140038
[CV] Fold 4: y_val bincount: [888 294], y_pred bincount: [880 302]
[CV] Fold 4: AUC = 0.4988164184592756
manual auc_list: [np.float64(0.5059074248372014), np.float64(0.5223403197049349), np.float64(0.521258970835242), np.float64(0.52282895140038), np.float64(0.4988164184592756)]
manual auc mean (ignore nan): 0.5142304170474068
cross_val_score: [0.50590742 0.52234032 0.52125897 0.52282895 0.49881642]
X_train.shape: (5913, 135)
X_train nan: 27 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
y_train shape: (5913,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5913, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 3]
[CV] Fold 0: y_val bincount: [889 294], y_pred bincount: [1166   17]
[CV] Fold 0: AUC = 0.49610125264954125
[CV] Fold 1: y_val bincount: [889 294], y_pred bincount: [1164   19]
[CV] Fold 1: AUC = 0.5204043372129504
[CV] Fold 2: y_val bincount: [888 295], y_pred bincount: [1157   26]
[CV] Fold 2: AUC = 0.5106962895098488
[CV] Fold 3: y_val bincount: [888 294], y_pred bincount: [1164   18]
[CV] Fold 3: AUC = 0.5099474474474475
[CV] Fold 4: y_val bincount: [888 294], y_pred bincount: [1157   25]
[CV] Fold 4: AUC = 0.530152601581173
manual auc_list: [np.float64(0.49610125264954125), np.float64(0.5204043372129504), np.float64(0.5106962895098488), np.float64(0.5099474474474475), np.float64(0.530152601581173)]
manual auc mean (ignore nan): 0.5134603856801923
cross_val_score: [0.49610125 0.52040434 0.51069629 0.50994745 0.5301526 ]
X_train.shape: (5913, 135)
X_train nan: 27 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
y_train shape: (5913,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5913, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 3]
[CV] Fold 0: y_val bincount: [889 294], y_pred bincount: [1160   23]
[CV] Fold 0: AUC = 0.49325084364454436
[CV] Fold 1: y_val bincount: [889 294], y_pred bincount: [1164   19]
[CV] Fold 1: AUC = 0.5245364737571069
[CV] Fold 2: y_val bincount: [888 295], y_pred bincount: [1155   28]
[CV] Fold 2: AUC = 0.5109749580088564
[CV] Fold 3: y_val bincount: [888 294], y_pred bincount: [1157   25]
[CV] Fold 3: AUC = 0.519527180241466
[CV] Fold 4: y_val bincount: [888 294], y_pred bincount: [1151   31]
[CV] Fold 4: AUC = 0.516137310780168
manual auc_list: [np.float64(0.49325084364454436), np.float64(0.5245364737571069), np.float64(0.5109749580088564), np.float64(0.519527180241466), np.float64(0.516137310780168)]
manual auc mean (ignore nan): 0.5128853532864283
cross_val_score: [0.49325084 0.52453647 0.51097496 0.51952718 0.51613731]
X_train.shape: (5913, 135)
X_train nan: 27 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
y_train shape: (5913,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5913, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 3]
[CV] Fold 0: y_val bincount: [889 294], y_pred bincount: [1161   22]
[CV] Fold 0: AUC = 0.48398031878668235
[CV] Fold 1: y_val bincount: [889 294], y_pred bincount: [1167   16]
[CV] Fold 1: AUC = 0.5223671020714248
[CV] Fold 2: y_val bincount: [888 295], y_pred bincount: [1163   20]
[CV] Fold 2: AUC = 0.5138914338066881
[I 2025-08-16 09:33:47,186] Trial 8 finished with value: 0.5109899171608197 and parameters: {'n_estimators': 236, 'max_depth': 23, 'min_samples_split': 9, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.518232850901607.
[I 2025-08-16 09:34:18,981] Trial 9 finished with value: 0.5071098950241184 and parameters: {'n_estimators': 154, 'max_depth': 22, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.518232850901607.
2025-08-16 09:34:18,981 - INFO - Best hyperparameters: {'n_estimators': 183, 'max_depth': 6, 'min_samples_split': 8, 'min_samples_leaf': 4}
2025-08-16 09:34:18,981 - INFO - Selected features (from input): ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
2025-08-16 09:34:21,257 - INFO - Saving RF with 10 features.
2025-08-16 09:34:21,441 - INFO - RF (Optuna) metrics: train acc=0.755, val acc=0.594, test acc=0.602
2025-08-16 09:34:21,460 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.74      0.70      0.72       544
         1.0       0.29      0.33      0.31       204

    accuracy                           0.60       748
   macro avg       0.52      0.52      0.52       748
weighted avg       0.62      0.60      0.61       748

2025-08-16 09:34:22,590 - INFO - Optimal threshold for F1: 0.429
2025-08-16 09:34:22,601 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.2930800542740841, "precision": 0.2536231884057971, "recall": 0.9668508287292817, "f1": 0.4018369690011481}
2025-08-16 09:34:22,601 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.3155080213903743, "precision": 0.271513353115727, "recall": 0.8970588235294118, "f1": 0.4168564920273349}
2025-08-16 09:34:22,606 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_rank_wasserstein_mean_middle.csv
[CV] Fold 3: y_val bincount: [888 294], y_pred bincount: [1158   24]
[CV] Fold 3: AUC = 0.5047687994116565
[CV] Fold 4: y_val bincount: [888 294], y_pred bincount: [1156   26]
[CV] Fold 4: AUC = 0.529941931727646
manual auc_list: [np.float64(0.48398031878668235), np.float64(0.5223671020714248), np.float64(0.5138914338066881), np.float64(0.5047687994116565), np.float64(0.529941931727646)]
manual auc mean (ignore nan): 0.5109899171608197
cross_val_score: [0.48398032 0.5223671  0.51389143 0.5047688  0.52994193]
X_train.shape: (5913, 135)
X_train nan: 27 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  3  3  0  0  0  0  0  0 21  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'Lateral_SampleEntropy', 'long_acc_pred_error', 'Lateral_Skewness', 'lat_acc_pred_error', 'Lateral_Kurtosis', 'Steering_Skewness', 'SteeringSpeed_Skewness', 'LaneOffset_Kurtosis']
y_train shape: (5913,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5913, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 3]
[CV] Fold 0: y_val bincount: [889 294], y_pred bincount: [1182    1]
[CV] Fold 0: AUC = 0.48265459164543206
[CV] Fold 1: y_val bincount: [889 294], y_pred bincount: [1180    3]
[CV] Fold 1: AUC = 0.5171101061346923
[CV] Fold 2: y_val bincount: [888 295], y_pred bincount: [1181    2]
[CV] Fold 2: AUC = 0.5063024889296075
[CV] Fold 3: y_val bincount: [888 294], y_pred bincount: [1180    2]
[CV] Fold 3: AUC = 0.5097406079548937
[CV] Fold 4: y_val bincount: [888 294], y_pred bincount: [1179    3]
[CV] Fold 4: AUC = 0.5197416804559662
manual auc_list: [np.float64(0.48265459164543206), np.float64(0.5171101061346923), np.float64(0.5063024889296075), np.float64(0.5097406079548937), np.float64(0.5197416804559662)]
manual auc mean (ignore nan): 0.5071098950241184
cross_val_score: [0.48265459 0.51711011 0.50630249 0.50974061 0.51974168]
=== DONE (BASENAME=wasserstein_mean_middle) ===

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=856416kb,walltime=00:06:42,ncpus=8,cpupercent=98,vmem=2270848kb
============================================================================================
