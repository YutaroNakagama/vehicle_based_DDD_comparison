IDX=3
NAME=wasserstein_friendly
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/misc/pretrain_groups/wasserstein_friendly.txt
TARGETS(first few)=S0116_2 S0204_1 S0199_1 S0165_1 S0168_1 S0200_1 S0113_1 S0190_2 S0210_1 S0155_2
pretrain_setting not found. It will be created at: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_friendly.pkl
2025-08-11 19:01:09.237290: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-11 19:01:09.643935: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-11 19:01:09.991964: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754906470.271538 1521068 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754906470.349316 1521068 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754906471.017852 1521068 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754906471.017899 1521068 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754906471.017902 1521068 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754906471.017904 1521068 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-11 19:01:11.087011: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-11 19:01:16,969 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=finetune_wasserstein_friendly | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-11 19:01:16,971 - INFO - Model type: common
2025-08-11 19:01:16,971 - INFO - Finetuning with target subjects: ['S0116_2', 'S0204_1', 'S0199_1', 'S0165_1', 'S0168_1', 'S0200_1', 'S0113_1', 'S0190_2', 'S0210_1', 'S0155_2']
2025-08-11 19:01:17,023 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-11 19:01:17,067 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-11 19:01:17,109 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-11 19:01:17,154 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-11 19:01:17,197 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-11 19:01:17,240 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-11 19:01:17,283 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-11 19:01:17,325 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-11 19:01:17,368 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-11 19:01:17,410 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-11 19:01:17,454 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-11 19:01:17,496 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-11 19:01:17,540 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-11 19:01:17,585 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-11 19:01:17,629 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-11 19:01:17,670 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-11 19:01:17,712 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-11 19:01:17,753 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-11 19:01:17,793 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-11 19:01:17,834 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-11 19:01:17,878 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-11 19:01:17,920 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-11 19:01:17,961 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-11 19:01:18,002 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-11 19:01:18,045 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-11 19:01:18,085 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-11 19:01:18,127 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-11 19:01:18,169 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-11 19:01:18,211 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-11 19:01:18,252 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-11 19:01:18,292 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-11 19:01:18,331 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-11 19:01:18,372 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-11 19:01:18,413 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-11 19:01:18,456 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-11 19:01:18,497 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-11 19:01:18,539 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-11 19:01:18,582 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-11 19:01:18,622 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-11 19:01:18,663 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-11 19:01:18,707 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-11 19:01:18,748 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-11 19:01:18,788 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-11 19:01:18,828 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-11 19:01:18,867 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-11 19:01:18,906 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-11 19:01:18,947 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-11 19:01:18,985 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-11 19:01:19,028 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-11 19:01:19,069 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-11 19:01:19,112 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-11 19:01:19,151 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-11 19:01:19,191 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-11 19:01:19,231 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-11 19:01:19,270 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-11 19:01:19,309 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-11 19:01:19,351 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-11 19:01:19,389 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-11 19:01:19,427 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-11 19:01:19,479 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-11 19:01:19,522 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-11 19:01:19,561 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-11 19:01:19,599 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-11 19:01:19,639 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-11 19:01:19,680 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-11 19:01:19,720 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-11 19:01:19,760 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-11 19:01:19,798 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-11 19:01:19,838 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-11 19:01:19,882 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-11 19:01:19,932 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-11 19:01:19,988 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-11 19:01:20,291 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-11 19:01:20,343 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-11 19:01:20,421 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-11 19:01:20,498 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-11 19:01:20,563 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-11 19:02:54,544 - INFO - Saved pretrain setting (features/scaler) to /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_friendly.pkl
2025-08-11 19:02:54,544 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_friendly.pkl: features=['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
2025-08-11 19:02:54,589 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-11 19:02:54,631 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-11 19:02:54,669 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-11 19:02:54,708 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-11 19:02:54,743 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-11 19:02:54,781 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-11 19:02:54,823 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-11 19:02:54,858 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-11 19:02:54,897 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-11 19:02:54,938 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
[I 2025-08-11 19:02:54,983] A new study created in memory with name: no-name-37c98bb5-b90f-4b49-8a36-ed7632d1890d
[I 2025-08-11 19:03:18,545] Trial 0 finished with value: 0.47977615291683595 and parameters: {'n_estimators': 127, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.47977615291683595.
[I 2025-08-11 19:03:43,915] Trial 1 finished with value: 0.4863023128001866 and parameters: {'n_estimators': 170, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 5}. Best is trial 1 with value: 0.4863023128001866.
[I 2025-08-11 19:04:14,154] Trial 2 finished with value: 0.47828974014664205 and parameters: {'n_estimators': 222, 'max_depth': 9, 'min_samples_split': 4, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.4863023128001866.
[I 2025-08-11 19:05:09,897] Trial 3 finished with value: 0.47969108183201337 and parameters: {'n_estimators': 273, 'max_depth': 23, 'min_samples_split': 7, 'min_samples_leaf': 3}. Best is trial 1 with value: 0.4863023128001866.
X_train.shape: (5986, 135)
X_train nan: 14 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5986,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5986, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [947 251], y_pred bincount: [1163   35]
[CV] Fold 0: AUC = 0.48349789858517356
[CV] Fold 1: y_val bincount: [946 251], y_pred bincount: [1175   22]
[CV] Fold 1: AUC = 0.46200399248671276
[CV] Fold 2: y_val bincount: [946 251], y_pred bincount: [1171   26]
[CV] Fold 2: AUC = 0.49182129831624877
[CV] Fold 3: y_val bincount: [946 251], y_pred bincount: [1179   18]
[CV] Fold 3: AUC = 0.5007075292908704
[CV] Fold 4: y_val bincount: [946 251], y_pred bincount: [1167   30]
[CV] Fold 4: AUC = 0.46085004590517425
manual auc_list: [np.float64(0.48349789858517356), np.float64(0.46200399248671276), np.float64(0.49182129831624877), np.float64(0.5007075292908704), np.float64(0.46085004590517425)]
manual auc mean (ignore nan): 0.47977615291683595
cross_val_score: [0.4834979  0.46200399 0.4918213  0.50070753 0.46085005]
X_train.shape: (5986, 135)
X_train nan: 14 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5986,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5986, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [947 251], y_pred bincount: [1100   98]
[CV] Fold 0: AUC = 0.46735129177061546
[CV] Fold 1: y_val bincount: [946 251], y_pred bincount: [1112   85]
[CV] Fold 1: AUC = 0.49368698567253194
[CV] Fold 2: y_val bincount: [946 251], y_pred bincount: [1117   80]
[CV] Fold 2: AUC = 0.5104149996209664
[CV] Fold 3: y_val bincount: [946 251], y_pred bincount: [1096  101]
[CV] Fold 3: AUC = 0.5030280569055702
[CV] Fold 4: y_val bincount: [946 251], y_pred bincount: [1106   91]
[CV] Fold 4: AUC = 0.4570302300312492
manual auc_list: [np.float64(0.46735129177061546), np.float64(0.49368698567253194), np.float64(0.5104149996209664), np.float64(0.5030280569055702), np.float64(0.4570302300312492)]
manual auc mean (ignore nan): 0.4863023128001866
cross_val_score: [0.46735129 0.49368699 0.510415   0.50302806 0.45703023]
X_train.shape: (5986, 135)
X_train nan: 14 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5986,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5986, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [947 251], y_pred bincount: [1082  116]
[CV] Fold 0: AUC = 0.4624374729172013
[CV] Fold 1: y_val bincount: [946 251], y_pred bincount: [1116   81]
[CV] Fold 1: AUC = 0.48777406231311543
[CV] Fold 2: y_val bincount: [946 251], y_pred bincount: [1134   63]
[CV] Fold 2: AUC = 0.4970393268364176
[CV] Fold 3: y_val bincount: [946 251], y_pred bincount: [1097  100]
[CV] Fold 3: AUC = 0.4799196448876797
[CV] Fold 4: y_val bincount: [946 251], y_pred bincount: [1093  104]
[CV] Fold 4: AUC = 0.4642781937787961
manual auc_list: [np.float64(0.4624374729172013), np.float64(0.48777406231311543), np.float64(0.4970393268364176), np.float64(0.4799196448876797), np.float64(0.4642781937787961)]
manual auc mean (ignore nan): 0.47828974014664205
cross_val_score: [0.46243747 0.48777406 0.49703933 0.47991964 0.46427819]
X_train.shape: (5986, 135)
X_train nan: 14 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5986,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5986, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [947 251], y_pred bincount: [1198]
[CV] Fold 0: AUC = 0.47154150031342423
[CV] Fold 1: y_val bincount: [946 251], y_pred bincount: [1194    3]
[CV] Fold 1: AUC = 0.48409743689091417
[CV] Fold 2: y_val bincount: [946 251], y_pred bincount: [1192    5]
[CV] Fold 2: AUC = 0.4756281428198411
[CV] Fold 3: y_val bincount: [946 251], y_pred bincount: [1195    2]
[CV] Fold 3: AUC = 0.5059676726497815
[CV] Fold 4: y_val bincount: [946 251], y_pred bincount: [1196    1]
[CV] Fold 4: AUC = 0.46122065648610633
manual auc_list: [np.float64(0.47154150031342423), np.float64(0.48409743689091417), np.float64(0.4756281428198411), np.float64(0.5059676726497815), np.float64(0.46122065648610633)]
manual auc mean (ignore nan): 0.47969108183201337
cross_val_score: [0.4715415  0.48409744 0.47562814 0.50596767 0.46122066]
X_train.shape: (5986, 135)
X_train nan: 14 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: [I 2025-08-11 19:05:44,139] Trial 4 finished with value: 0.4872228995926832 and parameters: {'n_estimators': 160, 'max_depth': 30, 'min_samples_split': 6, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.4872228995926832.
[I 2025-08-11 19:06:15,303] Trial 5 finished with value: 0.48697796556084183 and parameters: {'n_estimators': 200, 'max_depth': 11, 'min_samples_split': 9, 'min_samples_leaf': 1}. Best is trial 4 with value: 0.4872228995926832.
[I 2025-08-11 19:06:45,076] Trial 6 finished with value: 0.4791429689908219 and parameters: {'n_estimators': 168, 'max_depth': 14, 'min_samples_split': 3, 'min_samples_leaf': 3}. Best is trial 4 with value: 0.4872228995926832.
[I 2025-08-11 19:07:06,670] Trial 7 finished with value: 0.4800204598956401 and parameters: {'n_estimators': 107, 'max_depth': 25, 'min_samples_split': 10, 'min_samples_leaf': 5}. Best is trial 4 with value: 0.4872228995926832.
['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5986,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5986, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [947 251], y_pred bincount: [1196    2]
[CV] Fold 0: AUC = 0.4874777552935039
[CV] Fold 1: y_val bincount: [946 251], y_pred bincount: [1197]
[CV] Fold 1: AUC = 0.4898671697986069
[CV] Fold 2: y_val bincount: [946 251], y_pred bincount: [1196    1]
[CV] Fold 2: AUC = 0.485091347085232
[CV] Fold 3: y_val bincount: [946 251], y_pred bincount: [1196    1]
[CV] Fold 3: AUC = 0.4991071654186637
[CV] Fold 4: y_val bincount: [946 251], y_pred bincount: [1197]
[CV] Fold 4: AUC = 0.4745710603674098
manual auc_list: [np.float64(0.4874777552935039), np.float64(0.4898671697986069), np.float64(0.485091347085232), np.float64(0.4991071654186637), np.float64(0.4745710603674098)]
manual auc mean (ignore nan): 0.4872228995926832
cross_val_score: [0.48747776 0.48986717 0.48509135 0.49910717 0.47457106]
X_train.shape: (5986, 135)
X_train nan: 14 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5986,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5986, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [947 251], y_pred bincount: [1121   77]
[CV] Fold 0: AUC = 0.47071692112226904
[CV] Fold 1: y_val bincount: [946 251], y_pred bincount: [1144   53]
[CV] Fold 1: AUC = 0.4849270992141371
[CV] Fold 2: y_val bincount: [946 251], y_pred bincount: [1157   40]
[CV] Fold 2: AUC = 0.5089830951037289
[CV] Fold 3: y_val bincount: [946 251], y_pred bincount: [1147   50]
[CV] Fold 3: AUC = 0.49336270141421623
[CV] Fold 4: y_val bincount: [946 251], y_pred bincount: [1135   62]
[CV] Fold 4: AUC = 0.4769000109498581
manual auc_list: [np.float64(0.47071692112226904), np.float64(0.4849270992141371), np.float64(0.5089830951037289), np.float64(0.49336270141421623), np.float64(0.4769000109498581)]
manual auc mean (ignore nan): 0.48697796556084183
cross_val_score: [0.47071692 0.4849271  0.5089831  0.4933627  0.47690001]
X_train.shape: (5986, 135)
X_train nan: 14 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5986,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5986, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [947 251], y_pred bincount: [1177   21]
[CV] Fold 0: AUC = 0.47447380488605245
[CV] Fold 1: y_val bincount: [946 251], y_pred bincount: [1180   17]
[CV] Fold 1: AUC = 0.49273097883308203
[CV] Fold 2: y_val bincount: [946 251], y_pred bincount: [1180   17]
[CV] Fold 2: AUC = 0.48265710940592804
[CV] Fold 3: y_val bincount: [946 251], y_pred bincount: [1182   15]
[CV] Fold 3: AUC = 0.4849818485045021
[CV] Fold 4: y_val bincount: [946 251], y_pred bincount: [1181   16]
[CV] Fold 4: AUC = 0.46087110332454534
manual auc_list: [np.float64(0.47447380488605245), np.float64(0.49273097883308203), np.float64(0.48265710940592804), np.float64(0.4849818485045021), np.float64(0.46087110332454534)]
manual auc mean (ignore nan): 0.4791429689908219
cross_val_score: [0.4744738  0.49273098 0.48265711 0.48498185 0.4608711 ]
X_train.shape: (5986, 135)
X_train nan: 14 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5986,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5986, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [947 251], y_pred bincount: [1187   11]
[CV] Fold 0: AUC = 0.4793203111524336
[CV] Fold 1: y_val bincount: [946 251], y_pred bincount: [1187   10]
[CV] Fold 1: AUC = 0.48425747327813484
[CV] Fold 2: y_val bincount: [946 251], y_pred bincount: [1184   13]
[CV] Fold 2: AUC = 0.46660714436124423
[CV] Fold 3: y_val bincount: [946 251], y_pred bincount: [1187   10]
[CV] Fold 3: AUC = 0.5070373895538354
[CV] Fold 4: y_val bincount: [946 251], y_pred bincount: [1187   10]
[CV] Fold 4: AUC = 0.46287998113255224
manual auc_list: [np.float64(0.4793203111524336), np.float64(0.48425747327813484), np.float64(0.46660714436124423), np.float64(0.5070373895538354), np.float64(0.46287998113255224)]
manual auc mean (ignore nan): 0.4800204598956401
cross_val_score: [0.47932031 0.48425747 0.46660714 0.50703739 0.46287998]
X_train.shape: (5986, 135)
X_train nan: 14 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5986,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5986, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [947 251], y_pred bincount: [1198]
[CV] Fold 0: AUC = 0.4740993786206809
[CV] Fold 1: y_val bincount: [946 251], y_pred bincount: [1197]
[CV] Fold 1: AUC = 0.490183031089174
[CV] Fold 2: y_val bincount: [946 251], y_pred bincount: [1195    2]
[CV] Fold 2: AUC = 0.4813768183081627
[I 2025-08-11 19:08:01,058] Trial 8 finished with value: 0.48134396962338066 and parameters: {'n_estimators': 258, 'max_depth': 26, 'min_samples_split': 7, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.4872228995926832.
[I 2025-08-11 19:08:17,765] Trial 9 finished with value: 0.47573873273968703 and parameters: {'n_estimators': 106, 'max_depth': 11, 'min_samples_split': 4, 'min_samples_leaf': 1}. Best is trial 4 with value: 0.4872228995926832.
2025-08-11 19:08:17,766 - INFO - Best hyperparameters: {'n_estimators': 160, 'max_depth': 30, 'min_samples_split': 6, 'min_samples_leaf': 2}
2025-08-11 19:08:17,766 - INFO - Selected features (from input): ['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
2025-08-11 19:08:22,241 - INFO - Saving RF with 10 features.
2025-08-11 19:08:22,757 - INFO - RF (Optuna) metrics: train acc=1.000, val acc=0.774, test acc=0.703
2025-08-11 19:08:22,786 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.70      1.00      0.83       532
         1.0       0.00      0.00      0.00       225

    accuracy                           0.70       757
   macro avg       0.35      0.50      0.41       757
weighted avg       0.49      0.70      0.58       757

2025-08-11 19:08:23,948 - INFO - Optimal threshold for F1: 0.142
2025-08-11 19:08:23,959 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.23758389261744967, "precision": 0.22826086956521738, "recall": 1.0, "f1": 0.37168141592920356}
2025-08-11 19:08:23,960 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.30250990752972257, "precision": 0.2982689747003995, "recall": 0.9955555555555555, "f1": 0.45901639344262296}
2025-08-11 19:08:23,964 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_finetune_wasserstein_friendly_finetune.csv
[CV] Fold 3: y_val bincount: [946 251], y_pred bincount: [1196    1]
[CV] Fold 3: AUC = 0.48378578708422126
[CV] Fold 4: y_val bincount: [946 251], y_pred bincount: [1196    1]
[CV] Fold 4: AUC = 0.47727483301466445
manual auc_list: [np.float64(0.4740993786206809), np.float64(0.490183031089174), np.float64(0.4813768183081627), np.float64(0.48378578708422126), np.float64(0.47727483301466445)]
manual auc mean (ignore nan): 0.48134396962338066
cross_val_score: [0.47409938 0.49018303 0.48137682 0.48378579 0.47727483]
X_train.shape: (5986, 135)
X_train nan: 14 inf: 0
X_train col nan count: [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['long_acc_pred_error', 'lat_acc_pred_error', 'steering_speed_pred_error', 'steering_pred_error', 'Lateral_SpectralEntropy', 'Steering_Skewness', 'LongAcc_Skewness', 'LongAcc_SpectralEntropy', 'Lateral_Skewness', 'Lateral_SampleEntropy']
y_train shape: (5986,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5986, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [947 251], y_pred bincount: [1122   76]
[CV] Fold 0: AUC = 0.4729256153842918
[CV] Fold 1: y_val bincount: [946 251], y_pred bincount: [1141   56]
[CV] Fold 1: AUC = 0.4867211913445584
[CV] Fold 2: y_val bincount: [946 251], y_pred bincount: [1166   31]
[CV] Fold 2: AUC = 0.48907119934637766
[CV] Fold 3: y_val bincount: [946 251], y_pred bincount: [1143   54]
[CV] Fold 3: AUC = 0.47748961869225004
[CV] Fold 4: y_val bincount: [946 251], y_pred bincount: [1141   56]
[CV] Fold 4: AUC = 0.4524860389309569
manual auc_list: [np.float64(0.4729256153842918), np.float64(0.4867211913445584), np.float64(0.48907119934637766), np.float64(0.47748961869225004), np.float64(0.4524860389309569)]
manual auc mean (ignore nan): 0.47573873273968703
cross_val_score: [0.47292562 0.48672119 0.4890712  0.47748962 0.45248604]

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=974772kb,walltime=00:07:22,ncpus=8,cpupercent=99,vmem=2394680kb
============================================================================================
