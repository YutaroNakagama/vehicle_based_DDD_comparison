=== JOB INFO ===
IDX=13
NAME(line)=results/ranks/wasserstein_mean_high.txt
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/results/ranks/wasserstein_mean_high.txt
BASENAME=wasserstein_mean_high
TARGETS(first few)=S0154_2 S0120_2 S0154_1 S0120_1 S0135_2 S0209_1 S0178_2 S0186_2 S0206_1 S0156_1
[PRETRAIN] pretrain_setting exists. Reusing: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_mean_high.pkl
----- RUN: EVAL-ONLY (no fine-tune) -----
2025-08-16 18:01:05.408798: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:05.808447: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:06.146132: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755334866.428758 1851337 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755334866.503816 1851337 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755334867.192384 1851337 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334867.192427 1851337 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334867.192431 1851337 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334867.192433 1851337 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 18:01:07.265009: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 18:01:15,909 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_mean_high | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 18:01:15,912 - INFO - Model type: common
2025-08-16 18:01:15,912 - INFO - Finetuning with target subjects: ['S0154_2', 'S0120_2', 'S0154_1', 'S0120_1', 'S0135_2', 'S0209_1', 'S0178_2', 'S0186_2', 'S0206_1', 'S0156_1']
2025-08-16 18:01:15,970 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 18:01:16,035 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 18:01:16,079 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 18:01:16,139 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 18:01:16,182 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 18:01:16,225 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 18:01:16,290 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 18:01:16,341 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 18:01:16,392 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 18:01:16,443 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 18:01:16,508 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 18:01:16,533 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 18:01:16,559 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 18:01:16,591 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 18:01:16,636 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 18:01:16,681 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 18:01:16,727 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 18:01:16,789 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 18:01:16,852 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 18:01:16,877 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 18:01:16,901 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 18:01:16,925 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 18:01:16,948 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 18:01:16,974 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 18:01:17,015 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 18:01:17,059 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 18:01:17,102 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 18:01:17,162 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 18:01:17,224 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 18:01:17,249 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 18:01:17,299 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 18:01:17,323 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 18:01:17,347 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 18:01:17,370 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 18:01:17,428 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 18:01:17,492 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 18:01:17,552 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 18:01:17,597 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 18:01:17,642 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 18:01:17,696 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 18:01:17,738 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 18:01:17,780 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 18:01:17,826 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 18:01:17,871 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 18:01:17,933 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 18:01:17,956 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 18:01:18,018 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 18:01:18,041 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 18:01:18,065 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 18:01:18,088 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 18:01:18,113 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 18:01:18,174 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 18:01:18,197 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 18:01:18,221 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 18:01:18,261 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 18:01:18,308 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 18:01:18,348 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 18:01:18,389 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 18:01:18,437 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 18:01:18,480 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 18:01:18,525 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 18:01:18,584 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 18:01:18,606 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 18:01:18,630 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 18:01:18,689 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 18:01:18,748 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 18:01:18,803 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 18:01:18,825 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 18:01:18,856 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 18:01:18,880 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 18:01:18,901 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 18:01:18,951 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 18:01:18,973 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 18:01:18,996 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 18:01:19,017 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 18:01:19,043 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 18:01:19,083 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 18:01:19,129 - INFO - [EvalOnly] Found existing pretrained model/scaler. Skipping retrain.
2025-08-16 18:01:19,484 - INFO - [EvalOnly] Loaded model features: ./model/common/selected_features_train_RF_pretrain_general.pkl (10 cols)
2025-08-16 18:01:19,505 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 18:01:19,530 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 18:01:19,551 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 18:01:19,577 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 18:01:19,601 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 18:01:19,624 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 18:01:19,651 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 18:01:19,674 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 18:01:19,697 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 18:01:19,720 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 18:01:19,762 - WARNING - [EvalOnly] feature mismatch before alignment: missing_in_val=[] extra_in_val=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 18:01:19,762 - WARNING - [EvalOnly] feature mismatch (test) before alignment: missing_in_test=[] extra_in_test=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 18:01:19,767 - INFO - [EvalOnly] scaler expects n_features=10, aligned_features=10
2025-08-16 18:01:20,106 - INFO - [EvalOnly] val pos_ratio=0.142, pred_pos_ratio=0.036
2025-08-16 18:01:20,106 - INFO - [EvalOnly] test pos_ratio=0.189, pred_pos_ratio=0.043
2025-08-16 18:01:20,108 - INFO - [EvalOnly] val CM=
[[637  12]
 [ 92  15]]
2025-08-16 18:01:20,109 - INFO - [EvalOnly] test CM=
[[614  10]
 [122  23]]
2025-08-16 18:01:20,109 - INFO - [EvalOnly] RF on targets: val acc=0.862 auc=0.622 ap=0.304 | test acc=0.828 auc=0.630 ap=0.398
2025-08-16 18:01:20,117 - INFO - [EvalOnly] Saved -> ./model/common/metrics_RF_rank_wasserstein_mean_high_evalonly_on_targets.csv
----- RUN: FINE-TUNE (use target-train) -----
2025-08-16 18:01:22.602628: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:22.606492: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 18:01:22.617333: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755334882.634988 1851361 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755334882.640319 1851361 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755334882.654696 1851361 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334882.654723 1851361 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334882.654726 1851361 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755334882.654728 1851361 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 18:01:22.658980: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 18:01:25,397 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_mean_high | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 18:01:25,398 - INFO - Model type: common
2025-08-16 18:01:25,398 - INFO - Finetuning with target subjects: ['S0154_2', 'S0120_2', 'S0154_1', 'S0120_1', 'S0135_2', 'S0209_1', 'S0178_2', 'S0186_2', 'S0206_1', 'S0156_1']
2025-08-16 18:01:25,424 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 18:01:25,449 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 18:01:25,474 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 18:01:25,499 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 18:01:25,523 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 18:01:25,548 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 18:01:25,572 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 18:01:25,596 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 18:01:25,621 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 18:01:25,645 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 18:01:25,669 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 18:01:25,693 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 18:01:25,717 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 18:01:25,740 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 18:01:25,764 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 18:01:25,787 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 18:01:25,812 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 18:01:25,835 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 18:01:25,859 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 18:01:25,882 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 18:01:25,905 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 18:01:25,928 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 18:01:25,952 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 18:01:25,975 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 18:01:25,997 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 18:01:26,020 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 18:01:26,043 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 18:01:26,066 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 18:01:26,089 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 18:01:26,112 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 18:01:26,134 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 18:01:26,157 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 18:01:26,180 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 18:01:26,203 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 18:01:26,226 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 18:01:26,248 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 18:01:26,271 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 18:01:26,293 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 18:01:26,316 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 18:01:26,338 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 18:01:26,360 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 18:01:26,383 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 18:01:26,405 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 18:01:26,427 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 18:01:26,450 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 18:01:26,472 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 18:01:26,494 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 18:01:26,517 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 18:01:26,539 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 18:01:26,561 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 18:01:26,583 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 18:01:26,605 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 18:01:26,627 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 18:01:26,649 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 18:01:26,671 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 18:01:26,692 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 18:01:26,715 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 18:01:26,737 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 18:01:26,758 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 18:01:26,781 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 18:01:26,803 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 18:01:26,824 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 18:01:26,846 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 18:01:26,867 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 18:01:26,889 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 18:01:26,911 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 18:01:26,933 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 18:01:26,954 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 18:01:26,976 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 18:01:26,997 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 18:01:27,019 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 18:01:27,040 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 18:01:27,061 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 18:01:27,082 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 18:01:27,103 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 18:01:27,123 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 18:01:27,149 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 18:01:27,190 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_mean_high.pkl: features=['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
2025-08-16 18:01:27,210 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 18:01:27,234 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 18:01:27,253 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 18:01:27,277 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 18:01:27,301 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 18:01:27,322 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 18:01:27,343 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 18:01:27,364 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 18:01:27,385 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 18:01:27,405 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 18:01:27,446 - INFO - [split:finetune_setting] global  : n=7604, pos=1479, pos_ratio=0.195
2025-08-16 18:01:27,446 - INFO - [split:finetune_setting] train   : n=6079, pos=1227, pos_ratio=0.202, |Δ|=0.007
2025-08-16 18:01:27,446 - INFO - [split:finetune_setting] val     : n=756, pos=107, pos_ratio=0.142, |Δ|=0.053
2025-08-16 18:01:27,446 - INFO - [split:finetune_setting] test    : n=769, pos=145, pos_ratio=0.189, |Δ|=0.006
[I 2025-08-16 18:01:27,449] A new study created in memory with name: no-name-cc4a1605-190a-4189-b3b2-24cc504575df
[I 2025-08-16 18:01:57,975] Trial 0 finished with value: 0.4984715323278605 and parameters: {'n_estimators': 157, 'max_depth': 29, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.4984715323278605.
[I 2025-08-16 18:02:48,607] Trial 1 finished with value: 0.5009578132438448 and parameters: {'n_estimators': 269, 'max_depth': 18, 'min_samples_split': 4, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.5009578132438448.
[I 2025-08-16 18:03:16,955] Trial 2 finished with value: 0.497917299269908 and parameters: {'n_estimators': 160, 'max_depth': 16, 'min_samples_split': 8, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.5009578132438448.
[I 2025-08-16 18:04:05,749] Trial 3 finished with value: 0.4973042885471005 and parameters: {'n_estimators': 281, 'max_depth': 17, 'min_samples_split': 4, 'min_samples_leaf': 5}. Best is trial 1 with value: 0.5009578132438448.
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1208    8]
[CV] Fold 0: AUC = 0.4947908808984997
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1209    7]
[CV] Fold 1: AUC = 0.49451429050372975
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1209    7]
[CV] Fold 2: AUC = 0.4903591920805398
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1212    4]
[CV] Fold 3: AUC = 0.49566405346896736
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1202   13]
[CV] Fold 4: AUC = 0.5170292446875657
manual auc_list: [np.float64(0.4947908808984997), np.float64(0.49451429050372975), np.float64(0.4903591920805398), np.float64(0.49566405346896736), np.float64(0.5170292446875657)]
manual auc mean (ignore nan): 0.4984715323278605
cross_val_score: [0.49479088 0.49451429 0.49035919 0.49566405 0.51702924]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1213    3]
[CV] Fold 0: AUC = 0.5100326879557455
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1212    4]
[CV] Fold 1: AUC = 0.49734724666834296
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1212    4]
[CV] Fold 2: AUC = 0.4918388364614641
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1207    9]
[CV] Fold 3: AUC = 0.4743647407469682
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1208    7]
[CV] Fold 4: AUC = 0.5312055543867031
manual auc_list: [np.float64(0.5100326879557455), np.float64(0.49734724666834296), np.float64(0.4918388364614641), np.float64(0.4743647407469682), np.float64(0.5312055543867031)]
manual auc mean (ignore nan): 0.5009578132438448
cross_val_score: [0.51003269 0.49734725 0.49183884 0.47436474 0.53120555]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1192   24]
[CV] Fold 0: AUC = 0.5173371888358058
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1182   34]
[CV] Fold 1: AUC = 0.4827550079624507
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1191   25]
[CV] Fold 2: AUC = 0.48364614640913006
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1180   36]
[CV] Fold 3: AUC = 0.49055675823367445
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1179   36]
[CV] Fold 4: AUC = 0.5152913949084789
manual auc_list: [np.float64(0.5173371888358058), np.float64(0.4827550079624507), np.float64(0.48364614640913006), np.float64(0.49055675823367445), np.float64(0.5152913949084789)]
manual auc mean (ignore nan): 0.497917299269908
cross_val_score: [0.51733719 0.48275501 0.48364615 0.49055676 0.51529139]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1189   27]
[CV] Fold 0: AUC = 0.5029419160170983
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1182   34]
[CV] Fold 1: AUC = 0.49103595675132006
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1185   31]
[CV] Fold 2: AUC = 0.4876310977532104
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1182   34]
[CV] Fold 3: AUC = 0.4879631770318838
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1187   28]
[CV] Fold 4: AUC = 0.5169492951819903
manual auc_list: [np.float64(0.5029419160170983), np.float64(0.49103595675132006), np.float64(0.4876310977532104), np.float64(0.4879631770318838), np.float64(0.5169492951819903)]
manual auc mean (ignore nan): 0.4973042885471005
cross_val_score: [0.50294192 0.49103596 0.4876311  0.48796318 0.5169493 ]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1203   13]
[CV] Fold 0: AUC = 0.4992205179783757
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1197   19]
[CV] Fold 1: AUC = 0.5142360238035371
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1203   13]
[CV] Fold 2: AUC = 0.50753904033292
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1198   18]
[CV] Fold 3: AUC = 0.4789592046911453
[I 2025-08-16 18:04:28,457] Trial 4 finished with value: 0.5043974374790159 and parameters: {'n_estimators': 124, 'max_depth': 17, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.5043974374790159.
[I 2025-08-16 18:05:13,101] Trial 5 finished with value: 0.5005295600258103 and parameters: {'n_estimators': 253, 'max_depth': 18, 'min_samples_split': 9, 'min_samples_leaf': 5}. Best is trial 4 with value: 0.5043974374790159.
[I 2025-08-16 18:05:57,944] Trial 6 finished with value: 0.49428126746623074 and parameters: {'n_estimators': 239, 'max_depth': 30, 'min_samples_split': 8, 'min_samples_leaf': 4}. Best is trial 4 with value: 0.5043974374790159.
[I 2025-08-16 18:06:42,483] Trial 7 finished with value: 0.49696054086993824 and parameters: {'n_estimators': 234, 'max_depth': 21, 'min_samples_split': 7, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.5043974374790159.
[I 2025-08-16 18:07:04,401] Trial 8 finished with value: 0.49557131191636916 and parameters: {'n_estimators': 120, 'max_depth': 23, 'min_samples_split': 6, 'min_samples_leaf': 5}. Best is trial 4 with value: 0.5043974374790159.
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1202   13]
[CV] Fold 4: AUC = 0.5220324005891015
manual auc_list: [np.float64(0.4992205179783757), np.float64(0.5142360238035371), np.float64(0.50753904033292), np.float64(0.4789592046911453), np.float64(0.5220324005891015)]
manual auc mean (ignore nan): 0.5043974374790159
cross_val_score: [0.49922052 0.51423602 0.50753904 0.4789592  0.5220324 ]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1194   22]
[CV] Fold 0: AUC = 0.5039393177436929
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1187   29]
[CV] Fold 1: AUC = 0.4906252619227224
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1186   30]
[CV] Fold 2: AUC = 0.4899682633094432
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1187   29]
[CV] Fold 3: AUC = 0.5019609491582421
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1188   27]
[CV] Fold 4: AUC = 0.5161540079949506
manual auc_list: [np.float64(0.5039393177436929), np.float64(0.4906252619227224), np.float64(0.4899682633094432), np.float64(0.5019609491582421), np.float64(0.5161540079949506)]
manual auc mean (ignore nan): 0.5005295600258103
cross_val_score: [0.50393932 0.49062526 0.48996826 0.50196095 0.51615401]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1208    8]
[CV] Fold 0: AUC = 0.49194954320677226
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1210    6]
[CV] Fold 1: AUC = 0.48507669097309525
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1208    8]
[CV] Fold 2: AUC = 0.49226759704911827
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1205   11]
[CV] Fold 3: AUC = 0.48556295844805475
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1205   10]
[CV] Fold 4: AUC = 0.5165495476541132
manual auc_list: [np.float64(0.49194954320677226), np.float64(0.48507669097309525), np.float64(0.49226759704911827), np.float64(0.48556295844805475), np.float64(0.5165495476541132)]
manual auc mean (ignore nan): 0.49428126746623074
cross_val_score: [0.49194954 0.48507669 0.4922676  0.48556296 0.51654955]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1210    6]
[CV] Fold 0: AUC = 0.49089766155393516
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1209    7]
[CV] Fold 1: AUC = 0.49698265023887345
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1212    4]
[CV] Fold 2: AUC = 0.49419281615838917
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1205   11]
[CV] Fold 3: AUC = 0.47884150570629896
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1204   11]
[CV] Fold 4: AUC = 0.5238880706921945
manual auc_list: [np.float64(0.49089766155393516), np.float64(0.49698265023887345), np.float64(0.49419281615838917), np.float64(0.47884150570629896), np.float64(0.5238880706921945)]
manual auc mean (ignore nan): 0.49696054086993824
cross_val_score: [0.49089766 0.49698265 0.49419282 0.47884151 0.52388807]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [1195   21]
[CV] Fold 0: AUC = 0.48176598776297036
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [1200   16]
[CV] Fold 1: AUC = 0.48878551672114656
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [1196   20]
[CV] Fold 2: AUC = 0.48947224615901974
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [1196   20]
[CV] Fold 3: AUC = 0.5021753294520692
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [1195   20]
[CV] Fold 4: AUC = 0.5156574794866401
manual auc_list: [np.float64(0.48176598776297036), np.float64(0.48878551672114656), np.float64(0.48947224615901974), np.float64(0.5021753294520692), np.float64(0.5156574794866401)]
manual auc mean (ignore nan): 0.49557131191636916
cross_val_score: [0.48176599 0.48878552 0.48947225 0.50217533 0.51565748]
X_train.shape: (6079, 135)
X_train nan: 7 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
y_train shape: (6079,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (6079, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[I 2025-08-16 18:07:24,456] Trial 9 finished with value: 0.5135703956330769 and parameters: {'n_estimators': 190, 'max_depth': 7, 'min_samples_split': 7, 'min_samples_leaf': 1}. Best is trial 9 with value: 0.5135703956330769.
2025-08-16 18:07:24,456 - INFO - Best hyperparameters: {'n_estimators': 190, 'max_depth': 7, 'min_samples_split': 7, 'min_samples_leaf': 1}
2025-08-16 18:07:24,456 - INFO - Selected features (from input): ['steering_speed_pred_error', 'long_acc_pred_error', 'SteeringSpeed_Skewness', 'steering_pred_error', 'Steering_Skewness', 'Lateral_Skewness', 'Lateral_Kurtosis', 'lat_acc_pred_error', 'Steering_Kurtosis', 'Lateral_FreqCOG']
2025-08-16 18:07:25,142 - INFO - Saving RF with 10 features.
2025-08-16 18:07:25,485 - INFO - RF (Optuna) metrics: train acc=0.795, val acc=0.681, test acc=0.698
2025-08-16 18:07:25,544 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.84      0.78      0.81       624
         1.0       0.26      0.34      0.30       145

    accuracy                           0.70       769
   macro avg       0.55      0.56      0.55       769
weighted avg       0.73      0.70      0.71       769

2025-08-16 18:07:26,749 - INFO - Optimal threshold for F1: 0.430
2025-08-16 18:07:26,761 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.335978835978836, "precision": 0.15771230502599654, "recall": 0.8504672897196262, "f1": 0.26608187134502925}
2025-08-16 18:07:26,761 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.34460338101430427, "precision": 0.1973018549747049, "recall": 0.8068965517241379, "f1": 0.3170731707317073}
2025-08-16 18:07:26,771 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_rank_wasserstein_mean_high.csv
[CV] Fold 0: y_val bincount: [970 246], y_pred bincount: [897 319]
[CV] Fold 0: AUC = 0.5369918699186992
[CV] Fold 1: y_val bincount: [970 246], y_pred bincount: [915 301]
[CV] Fold 1: AUC = 0.5085240130751822
[CV] Fold 2: y_val bincount: [971 245], y_pred bincount: [835 381]
[CV] Fold 2: AUC = 0.503835725845436
[CV] Fold 3: y_val bincount: [971 245], y_pred bincount: [909 307]
[CV] Fold 3: AUC = 0.49545808024548643
[CV] Fold 4: y_val bincount: [970 245], y_pred bincount: [938 277]
[CV] Fold 4: AUC = 0.5230422890805807
manual auc_list: [np.float64(0.5369918699186992), np.float64(0.5085240130751822), np.float64(0.503835725845436), np.float64(0.49545808024548643), np.float64(0.5230422890805807)]
manual auc mean (ignore nan): 0.5135703956330769
cross_val_score: [0.53699187 0.50852401 0.50383573 0.49545808 0.52304229]
=== DONE (BASENAME=wasserstein_mean_high) ===

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=872844kb,walltime=00:06:31,ncpus=8,cpupercent=98,vmem=2286588kb
============================================================================================
