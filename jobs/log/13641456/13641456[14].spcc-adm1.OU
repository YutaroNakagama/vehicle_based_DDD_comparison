=== JOB INFO ===
IDX=14
NAME(line)=results/ranks/wasserstein_mean_low.txt
GROUP_FILE=/home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/results/ranks/wasserstein_mean_low.txt
BASENAME=wasserstein_mean_low
TARGETS(first few)=S0190_2 S0200_1 S0204_1 S0136_2 S0207_2 S0196_1 S0199_1 S0207_1 S0210_1 S0155_1
[PRETRAIN] pretrain_setting exists. Reusing: /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_mean_low.pkl
----- RUN: EVAL-ONLY (no fine-tune) -----
2025-08-16 19:03:06.943759: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:07.357048: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:07.691482: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755338587.967250  566475 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755338588.050170  566475 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755338588.704883  566475 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.704918  566475 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.704920  566475 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338588.704922  566475 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 19:03:08.775347: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 19:03:14,910 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_mean_low | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 19:03:14,911 - INFO - Model type: common
2025-08-16 19:03:14,911 - INFO - Finetuning with target subjects: ['S0190_2', 'S0200_1', 'S0204_1', 'S0136_2', 'S0207_2', 'S0196_1', 'S0199_1', 'S0207_1', 'S0210_1', 'S0155_1']
2025-08-16 19:03:14,968 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 19:03:15,015 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 19:03:15,064 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 19:03:15,112 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 19:03:15,179 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 19:03:15,217 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 19:03:15,250 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 19:03:15,297 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 19:03:15,343 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 19:03:15,410 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 19:03:15,435 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 19:03:15,480 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 19:03:15,528 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 19:03:15,588 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 19:03:15,612 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 19:03:15,638 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 19:03:15,675 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 19:03:15,736 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 19:03:15,759 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 19:03:15,808 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 19:03:15,872 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 19:03:15,894 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 19:03:15,919 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 19:03:15,951 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 19:03:15,996 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 19:03:16,043 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 19:03:16,105 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 19:03:16,164 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 19:03:16,188 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 19:03:16,211 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 19:03:16,235 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 19:03:16,259 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 19:03:16,319 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 19:03:16,360 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 19:03:16,407 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 19:03:16,468 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 19:03:16,490 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 19:03:16,513 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 19:03:16,565 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 19:03:16,604 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 19:03:16,648 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 19:03:16,687 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 19:03:16,729 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 19:03:16,779 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 19:03:16,818 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 19:03:16,876 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 19:03:16,917 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 19:03:16,979 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 19:03:17,003 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 19:03:17,062 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 19:03:17,084 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 19:03:17,107 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 19:03:17,128 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 19:03:17,151 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 19:03:17,188 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 19:03:17,233 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 19:03:17,276 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 19:03:17,319 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 19:03:17,359 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 19:03:17,402 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 19:03:17,446 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 19:03:17,489 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 19:03:17,544 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 19:03:17,582 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 19:03:17,631 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 19:03:17,687 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 19:03:17,709 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 19:03:17,769 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 19:03:17,790 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 19:03:17,812 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 19:03:17,833 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 19:03:17,895 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 19:03:17,916 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 19:03:17,939 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 19:03:17,960 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 19:03:17,980 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 19:03:18,002 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 19:03:18,050 - INFO - [EvalOnly] Found existing pretrained model/scaler. Skipping retrain.
2025-08-16 19:03:18,604 - INFO - [EvalOnly] Loaded model features: ./model/common/selected_features_train_RF_pretrain_general.pkl (10 cols)
2025-08-16 19:03:18,625 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 19:03:18,647 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 19:03:18,673 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 19:03:18,694 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 19:03:18,716 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 19:03:18,741 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 19:03:18,763 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 19:03:18,786 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 19:03:18,808 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 19:03:18,832 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 19:03:18,883 - WARNING - [EvalOnly] feature mismatch before alignment: missing_in_val=[] extra_in_val=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 19:03:18,883 - WARNING - [EvalOnly] feature mismatch (test) before alignment: missing_in_test=[] extra_in_test=['Steering_Range', 'Steering_StdDev', 'Steering_Energy', 'Steering_ZeroCrossingRate', 'Steering_Quartile25']
2025-08-16 19:03:18,888 - INFO - [EvalOnly] scaler expects n_features=10, aligned_features=10
2025-08-16 19:03:19,235 - INFO - [EvalOnly] val pos_ratio=0.273, pred_pos_ratio=0.209
2025-08-16 19:03:19,235 - INFO - [EvalOnly] test pos_ratio=0.239, pred_pos_ratio=0.182
2025-08-16 19:03:19,237 - INFO - [EvalOnly] val CM=
[[535   5]
 [ 53 150]]
2025-08-16 19:03:19,239 - INFO - [EvalOnly] test CM=
[[568   5]
 [ 48 132]]
2025-08-16 19:03:19,239 - INFO - [EvalOnly] RF on targets: val acc=0.922 auc=0.913 ap=0.891 | test acc=0.930 auc=0.914 ap=0.878
2025-08-16 19:03:19,244 - INFO - [EvalOnly] Saved -> ./model/common/metrics_RF_rank_wasserstein_mean_low_evalonly_on_targets.csv
----- RUN: FINE-TUNE (use target-train) -----
2025-08-16 19:03:21.695766: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:21.699820: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-08-16 19:03:21.710613: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1755338601.728230  566558 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1755338601.733491  566558 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1755338601.747703  566558 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338601.747723  566558 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338601.747725  566558 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1755338601.747727  566558 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-16 19:03:21.751878: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-16 19:03:24,461 - INFO - [RUN] model=RF | domain_mixup=disabled | coral=disabled | vae=disabled | sample_size=None | seed=42 | fold=None | tag=rank_wasserstein_mean_low | subject_wise_split=disabled | feature_selection=rf | data_leak=disabled
2025-08-16 19:03:24,462 - INFO - Model type: common
2025-08-16 19:03:24,462 - INFO - Finetuning with target subjects: ['S0190_2', 'S0200_1', 'S0204_1', 'S0136_2', 'S0207_2', 'S0196_1', 'S0199_1', 'S0207_1', 'S0210_1', 'S0155_1']
2025-08-16 19:03:24,488 - INFO - Loaded: ./data/processed/common/processed_S0139_1.csv
2025-08-16 19:03:24,513 - INFO - Loaded: ./data/processed/common/processed_S0120_1.csv
2025-08-16 19:03:24,538 - INFO - Loaded: ./data/processed/common/processed_S0116_2.csv
2025-08-16 19:03:24,563 - INFO - Loaded: ./data/processed/common/processed_S0120_2.csv
2025-08-16 19:03:24,587 - INFO - Loaded: ./data/processed/common/processed_S0116_1.csv
2025-08-16 19:03:24,612 - INFO - Loaded: ./data/processed/common/processed_S0148_1.csv
2025-08-16 19:03:24,637 - INFO - Loaded: ./data/processed/common/processed_S0189_1.csv
2025-08-16 19:03:24,661 - INFO - Loaded: ./data/processed/common/processed_S0171_1.csv
2025-08-16 19:03:24,686 - INFO - Loaded: ./data/processed/common/processed_S0135_2.csv
2025-08-16 19:03:24,710 - INFO - Loaded: ./data/processed/common/processed_S0197_1.csv
2025-08-16 19:03:24,735 - INFO - Loaded: ./data/processed/common/processed_S0134_1.csv
2025-08-16 19:03:24,759 - INFO - Loaded: ./data/processed/common/processed_S0178_1.csv
2025-08-16 19:03:24,782 - INFO - Loaded: ./data/processed/common/processed_S0134_2.csv
2025-08-16 19:03:24,806 - INFO - Loaded: ./data/processed/common/processed_S0140_1.csv
2025-08-16 19:03:24,830 - INFO - Loaded: ./data/processed/common/processed_S0181_1.csv
2025-08-16 19:03:24,853 - INFO - Loaded: ./data/processed/common/processed_S0174_2.csv
2025-08-16 19:03:24,877 - INFO - Loaded: ./data/processed/common/processed_S0113_1.csv
2025-08-16 19:03:24,901 - INFO - Loaded: ./data/processed/common/processed_S0181_2.csv
2025-08-16 19:03:24,924 - INFO - Loaded: ./data/processed/common/processed_S0140_2.csv
2025-08-16 19:03:24,947 - INFO - Loaded: ./data/processed/common/processed_S0171_2.csv
2025-08-16 19:03:24,971 - INFO - Loaded: ./data/processed/common/processed_S0172_1.csv
2025-08-16 19:03:24,994 - INFO - Loaded: ./data/processed/common/processed_S0167_1.csv
2025-08-16 19:03:25,017 - INFO - Loaded: ./data/processed/common/processed_S0198_1.csv
2025-08-16 19:03:25,040 - INFO - Loaded: ./data/processed/common/processed_S0202_1.csv
2025-08-16 19:03:25,063 - INFO - Loaded: ./data/processed/common/processed_S0153_2.csv
2025-08-16 19:03:25,085 - INFO - Loaded: ./data/processed/common/processed_S0155_2.csv
2025-08-16 19:03:25,108 - INFO - Loaded: ./data/processed/common/processed_S0189_2.csv
2025-08-16 19:03:25,131 - INFO - Loaded: ./data/processed/common/processed_S0204_2.csv
2025-08-16 19:03:25,153 - INFO - Loaded: ./data/processed/common/processed_S0170_1.csv
2025-08-16 19:03:25,177 - INFO - Loaded: ./data/processed/common/processed_S0178_2.csv
2025-08-16 19:03:25,199 - INFO - Loaded: ./data/processed/common/processed_S0201_1.csv
2025-08-16 19:03:25,222 - INFO - Loaded: ./data/processed/common/processed_S0194_1.csv
2025-08-16 19:03:25,244 - INFO - Loaded: ./data/processed/common/processed_S0198_2.csv
2025-08-16 19:03:25,267 - INFO - Loaded: ./data/processed/common/processed_S0156_1.csv
2025-08-16 19:03:25,289 - INFO - Loaded: ./data/processed/common/processed_S0196_2.csv
2025-08-16 19:03:25,312 - INFO - Loaded: ./data/processed/common/processed_S0201_2.csv
2025-08-16 19:03:25,334 - INFO - Loaded: ./data/processed/common/processed_S0206_1.csv
2025-08-16 19:03:25,356 - INFO - Loaded: ./data/processed/common/processed_S0186_2.csv
2025-08-16 19:03:25,379 - INFO - Loaded: ./data/processed/common/processed_S0173_1.csv
2025-08-16 19:03:25,401 - INFO - Loaded: ./data/processed/common/processed_S0165_1.csv
2025-08-16 19:03:25,423 - INFO - Loaded: ./data/processed/common/processed_S0209_1.csv
2025-08-16 19:03:25,445 - INFO - Loaded: ./data/processed/common/processed_S0172_2.csv
2025-08-16 19:03:25,467 - INFO - Loaded: ./data/processed/common/processed_S0210_2.csv
2025-08-16 19:03:25,490 - INFO - Loaded: ./data/processed/common/processed_S0193_1.csv
2025-08-16 19:03:25,512 - INFO - Loaded: ./data/processed/common/processed_S0165_2.csv
2025-08-16 19:03:25,534 - INFO - Loaded: ./data/processed/common/processed_S0205_1.csv
2025-08-16 19:03:25,556 - INFO - Loaded: ./data/processed/common/processed_S0213_2.csv
2025-08-16 19:03:25,579 - INFO - Loaded: ./data/processed/common/processed_S0205_2.csv
2025-08-16 19:03:25,601 - INFO - Loaded: ./data/processed/common/processed_S0199_2.csv
2025-08-16 19:03:25,623 - INFO - Loaded: ./data/processed/common/processed_S0202_2.csv
2025-08-16 19:03:25,645 - INFO - Loaded: ./data/processed/common/processed_S0186_1.csv
2025-08-16 19:03:25,667 - INFO - Loaded: ./data/processed/common/processed_S0156_2.csv
2025-08-16 19:03:25,688 - INFO - Loaded: ./data/processed/common/processed_S0136_1.csv
2025-08-16 19:03:25,710 - INFO - Loaded: ./data/processed/common/processed_S0191_2.csv
2025-08-16 19:03:25,732 - INFO - Loaded: ./data/processed/common/processed_S0206_2.csv
2025-08-16 19:03:25,754 - INFO - Loaded: ./data/processed/common/processed_S0167_2.csv
2025-08-16 19:03:25,776 - INFO - Loaded: ./data/processed/common/processed_S0209_2.csv
2025-08-16 19:03:25,798 - INFO - Loaded: ./data/processed/common/processed_S0173_2.csv
2025-08-16 19:03:25,819 - INFO - Loaded: ./data/processed/common/processed_S0169_1.csv
2025-08-16 19:03:25,841 - INFO - Loaded: ./data/processed/common/processed_S0148_2.csv
2025-08-16 19:03:25,863 - INFO - Loaded: ./data/processed/common/processed_S0200_2.csv
2025-08-16 19:03:25,885 - INFO - Loaded: ./data/processed/common/processed_S0185_1.csv
2025-08-16 19:03:25,907 - INFO - Loaded: ./data/processed/common/processed_S0193_2.csv
2025-08-16 19:03:25,928 - INFO - Loaded: ./data/processed/common/processed_S0194_2.csv
2025-08-16 19:03:25,950 - INFO - Loaded: ./data/processed/common/processed_S0147_2.csv
2025-08-16 19:03:25,971 - INFO - Loaded: ./data/processed/common/processed_S0185_2.csv
2025-08-16 19:03:25,993 - INFO - Loaded: ./data/processed/common/processed_S0170_2.csv
2025-08-16 19:03:26,014 - INFO - Loaded: ./data/processed/common/processed_S0139_2.csv
2025-08-16 19:03:26,036 - INFO - Loaded: ./data/processed/common/processed_S0168_2.csv
2025-08-16 19:03:26,057 - INFO - Loaded: ./data/processed/common/processed_S0168_1.csv
2025-08-16 19:03:26,078 - INFO - Loaded: ./data/processed/common/processed_S0154_2.csv
2025-08-16 19:03:26,099 - INFO - Loaded: ./data/processed/common/processed_S0169_2.csv
2025-08-16 19:03:26,120 - INFO - Loaded: ./data/processed/common/processed_S0188_2.csv
2025-08-16 19:03:26,141 - INFO - Loaded: ./data/processed/common/processed_S0188_1.csv
2025-08-16 19:03:26,162 - INFO - Loaded: ./data/processed/common/processed_S0154_1.csv
2025-08-16 19:03:26,182 - INFO - Loaded: ./data/processed/common/processed_S0153_1.csv
2025-08-16 19:03:26,202 - INFO - Loaded: ./data/processed/common/processed_S0190_1.csv
2025-08-16 19:03:26,240 - INFO - Loaded pretrain setting from /home/s2240011/git/ddd/vehicle_based_DDD_comparison/project/model/common/pretrain_setting_wasserstein_mean_low.pkl: features=['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
2025-08-16 19:03:26,260 - INFO - Loaded: ./data/processed/common/processed_S0190_2.csv
2025-08-16 19:03:26,287 - INFO - Loaded: ./data/processed/common/processed_S0200_1.csv
2025-08-16 19:03:26,311 - INFO - Loaded: ./data/processed/common/processed_S0204_1.csv
2025-08-16 19:03:26,331 - INFO - Loaded: ./data/processed/common/processed_S0136_2.csv
2025-08-16 19:03:26,352 - INFO - Loaded: ./data/processed/common/processed_S0207_2.csv
2025-08-16 19:03:26,375 - INFO - Loaded: ./data/processed/common/processed_S0196_1.csv
2025-08-16 19:03:26,396 - INFO - Loaded: ./data/processed/common/processed_S0199_1.csv
2025-08-16 19:03:26,417 - INFO - Loaded: ./data/processed/common/processed_S0207_1.csv
2025-08-16 19:03:26,438 - INFO - Loaded: ./data/processed/common/processed_S0210_1.csv
2025-08-16 19:03:26,461 - INFO - Loaded: ./data/processed/common/processed_S0155_1.csv
2025-08-16 19:03:26,497 - INFO - [split:finetune_setting] global  : n=7463, pos=1787, pos_ratio=0.239
2025-08-16 19:03:26,497 - INFO - [split:finetune_setting] train   : n=5967, pos=1404, pos_ratio=0.235, |Δ|=0.004
2025-08-16 19:03:26,497 - INFO - [split:finetune_setting] val     : n=743, pos=203, pos_ratio=0.273, |Δ|=0.034
2025-08-16 19:03:26,497 - INFO - [split:finetune_setting] test    : n=753, pos=180, pos_ratio=0.239, |Δ|=0.000
[I 2025-08-16 19:03:26,499] A new study created in memory with name: no-name-b0dbcaf6-fe0e-42df-87e9-684f35461b35
[I 2025-08-16 19:03:46,080] Trial 0 finished with value: 0.510493614558159 and parameters: {'n_estimators': 194, 'max_depth': 6, 'min_samples_split': 7, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.510493614558159.
[I 2025-08-16 19:04:18,631] Trial 1 finished with value: 0.5025600052379412 and parameters: {'n_estimators': 171, 'max_depth': 21, 'min_samples_split': 4, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.510493614558159.
[I 2025-08-16 19:04:34,344] Trial 2 finished with value: 0.508925066483158 and parameters: {'n_estimators': 108, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.510493614558159.
[I 2025-08-16 19:05:25,582] Trial 3 finished with value: 0.5019301624466111 and parameters: {'n_estimators': 267, 'max_depth': 25, 'min_samples_split': 3, 'min_samples_leaf': 5}. Best is trial 0 with value: 0.510493614558159.
X_train.shape: (5967, 135)
X_train nan: 6 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
y_train shape: (5967,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5967, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 281], y_pred bincount: [828 366]
[CV] Fold 0: AUC = 0.5298710208027192
[CV] Fold 1: y_val bincount: [913 281], y_pred bincount: [888 306]
[CV] Fold 1: AUC = 0.4963068060010992
[CV] Fold 2: y_val bincount: [913 280], y_pred bincount: [790 403]
[CV] Fold 2: AUC = 0.5276169613519012
[CV] Fold 3: y_val bincount: [912 281], y_pred bincount: [758 435]
[CV] Fold 3: AUC = 0.49413123556221517
[CV] Fold 4: y_val bincount: [912 281], y_pred bincount: [845 348]
[CV] Fold 4: AUC = 0.50454204907286
manual auc_list: [np.float64(0.5298710208027192), np.float64(0.4963068060010992), np.float64(0.5276169613519012), np.float64(0.49413123556221517), np.float64(0.50454204907286)]
manual auc mean (ignore nan): 0.510493614558159
cross_val_score: [0.52987102 0.49630681 0.52761696 0.49413124 0.50454205]
X_train.shape: (5967, 135)
X_train nan: 6 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
y_train shape: (5967,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5967, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 281], y_pred bincount: [1175   19]
[CV] Fold 0: AUC = 0.523829384181826
[CV] Fold 1: y_val bincount: [913 281], y_pred bincount: [1166   28]
[CV] Fold 1: AUC = 0.4820290544254014
[CV] Fold 2: y_val bincount: [913 280], y_pred bincount: [1166   27]
[CV] Fold 2: AUC = 0.5046432483179472
[CV] Fold 3: y_val bincount: [912 281], y_pred bincount: [1175   18]
[CV] Fold 3: AUC = 0.5115346194668164
[CV] Fold 4: y_val bincount: [912 281], y_pred bincount: [1162   31]
[CV] Fold 4: AUC = 0.49076371979771494
manual auc_list: [np.float64(0.523829384181826), np.float64(0.4820290544254014), np.float64(0.5046432483179472), np.float64(0.5115346194668164), np.float64(0.49076371979771494)]
manual auc mean (ignore nan): 0.5025600052379412
cross_val_score: [0.52382938 0.48202905 0.50464325 0.51153462 0.49076372]
X_train.shape: (5967, 135)
X_train nan: 6 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
y_train shape: (5967,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5967, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 281], y_pred bincount: [1040  154]
[CV] Fold 0: AUC = 0.5221961933791459
[CV] Fold 1: y_val bincount: [913 281], y_pred bincount: [1084  110]
[CV] Fold 1: AUC = 0.504406496903174
[CV] Fold 2: y_val bincount: [913 280], y_pred bincount: [1014  179]
[CV] Fold 2: AUC = 0.5153457987795338
[CV] Fold 3: y_val bincount: [912 281], y_pred bincount: [998 195]
[CV] Fold 3: AUC = 0.5086080414559531
[CV] Fold 4: y_val bincount: [912 281], y_pred bincount: [1036  157]
[CV] Fold 4: AUC = 0.4940688018979834
manual auc_list: [np.float64(0.5221961933791459), np.float64(0.504406496903174), np.float64(0.5153457987795338), np.float64(0.5086080414559531), np.float64(0.4940688018979834)]
manual auc mean (ignore nan): 0.508925066483158
cross_val_score: [0.52219619 0.5044065  0.5153458  0.50860804 0.4940688 ]
X_train.shape: (5967, 135)
X_train nan: 6 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
y_train shape: (5967,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5967, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 281], y_pred bincount: [1184   10]
[CV] Fold 0: AUC = 0.5251429529181105
[CV] Fold 1: y_val bincount: [913 281], y_pred bincount: [1168   26]
[CV] Fold 1: AUC = 0.475352071501795
[CV] Fold 2: y_val bincount: [913 280], y_pred bincount: [1181   12]
[CV] Fold 2: AUC = 0.49900641527147555
[CV] Fold 3: y_val bincount: [912 281], y_pred bincount: [1178   15]
[CV] Fold 3: AUC = 0.5116126615471063
[CV] Fold 4: y_val bincount: [912 281], y_pred bincount: [1165   28]
[CV] Fold 4: AUC = 0.49853671099456826
manual auc_list: [np.float64(0.5251429529181105), np.float64(0.475352071501795), np.float64(0.49900641527147555), np.float64(0.5116126615471063), np.float64(0.49853671099456826)]
manual auc mean (ignore nan): 0.5019301624466111
cross_val_score: [0.52514295 0.47535207 0.49900642 0.51161266 0.49853671]
X_train.shape: (5967, 135)
X_train nan: 6 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
y_train shape: (5967,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5967, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 281], y_pred bincount: [1132   62]
[CV] Fold 0: AUC = 0.5167782095707321
[CV] Fold 1: y_val bincount: [913 281], y_pred bincount: [1134   60]
[CV] Fold 1: AUC = 0.4977451052998796
[CV] Fold 2: y_val bincount: [913 280], y_pred bincount: [1117   76]
[CV] Fold 2: AUC = 0.501881552182757
[CV] Fold 3: y_val bincount: [912 281], y_pred bincount: [1104   89]
[I 2025-08-16 19:05:50,303] Trial 4 finished with value: 0.5043407848610078 and parameters: {'n_estimators': 148, 'max_depth': 13, 'min_samples_split': 8, 'min_samples_leaf': 3}. Best is trial 0 with value: 0.510493614558159.
[I 2025-08-16 19:06:16,711] Trial 5 finished with value: 0.5105668846784573 and parameters: {'n_estimators': 197, 'max_depth': 9, 'min_samples_split': 4, 'min_samples_leaf': 3}. Best is trial 5 with value: 0.5105668846784573.
[I 2025-08-16 19:07:00,558] Trial 6 finished with value: 0.493929577024771 and parameters: {'n_estimators': 210, 'max_depth': 23, 'min_samples_split': 3, 'min_samples_leaf': 1}. Best is trial 5 with value: 0.5105668846784573.
[I 2025-08-16 19:07:23,017] Trial 7 finished with value: 0.49895193823605916 and parameters: {'n_estimators': 120, 'max_depth': 19, 'min_samples_split': 8, 'min_samples_leaf': 5}. Best is trial 5 with value: 0.5105668846784573.
[I 2025-08-16 19:07:50,213] Trial 8 finished with value: 0.5069357160241074 and parameters: {'n_estimators': 139, 'max_depth': 20, 'min_samples_split': 3, 'min_samples_leaf': 3}. Best is trial 5 with value: 0.5105668846784573.
[CV] Fold 3: AUC = 0.5013072048448524
[CV] Fold 4: y_val bincount: [912 281], y_pred bincount: [1118   75]
[CV] Fold 4: AUC = 0.5039918524068178
manual auc_list: [np.float64(0.5167782095707321), np.float64(0.4977451052998796), np.float64(0.501881552182757), np.float64(0.5013072048448524), np.float64(0.5039918524068178)]
manual auc mean (ignore nan): 0.5043407848610078
cross_val_score: [0.51677821 0.49774511 0.50188155 0.5013072  0.50399185]
X_train.shape: (5967, 135)
X_train nan: 6 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
y_train shape: (5967,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5967, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 281], y_pred bincount: [997 197]
[CV] Fold 0: AUC = 0.5275089357754538
[CV] Fold 1: y_val bincount: [913 281], y_pred bincount: [1028  166]
[CV] Fold 1: AUC = 0.5033696741024272
[CV] Fold 2: y_val bincount: [913 280], y_pred bincount: [972 221]
[CV] Fold 2: AUC = 0.516867469879518
[CV] Fold 3: y_val bincount: [912 281], y_pred bincount: [941 252]
[CV] Fold 3: AUC = 0.5027275707061247
[CV] Fold 4: y_val bincount: [912 281], y_pred bincount: [980 213]
[CV] Fold 4: AUC = 0.5023607729287631
manual auc_list: [np.float64(0.5275089357754538), np.float64(0.5033696741024272), np.float64(0.516867469879518), np.float64(0.5027275707061247), np.float64(0.5023607729287631)]
manual auc mean (ignore nan): 0.5105668846784573
cross_val_score: [0.52750894 0.50336967 0.51686747 0.50272757 0.50236077]
X_train.shape: (5967, 135)
X_train nan: 6 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
y_train shape: (5967,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5967, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 281], y_pred bincount: [1194]
[CV] Fold 0: AUC = 0.5203992937131898
[CV] Fold 1: y_val bincount: [913 281], y_pred bincount: [1191    3]
[CV] Fold 1: AUC = 0.4817484106597857
[CV] Fold 2: y_val bincount: [913 280], y_pred bincount: [1193]
[CV] Fold 2: AUC = 0.489250508527617
[CV] Fold 3: y_val bincount: [912 281], y_pred bincount: [1190    3]
[CV] Fold 3: AUC = 0.49342495473559345
[CV] Fold 4: y_val bincount: [912 281], y_pred bincount: [1192    1]
[CV] Fold 4: AUC = 0.4848247174876693
manual auc_list: [np.float64(0.5203992937131898), np.float64(0.4817484106597857), np.float64(0.489250508527617), np.float64(0.49342495473559345), np.float64(0.4848247174876693)]
manual auc mean (ignore nan): 0.493929577024771
cross_val_score: [0.52039929 0.48174841 0.48925051 0.49342495 0.48482472]
X_train.shape: (5967, 135)
X_train nan: 6 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
y_train shape: (5967,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5967, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 281], y_pred bincount: [1171   23]
[CV] Fold 0: AUC = 0.5160532131762248
[CV] Fold 1: y_val bincount: [913 281], y_pred bincount: [1153   41]
[CV] Fold 1: AUC = 0.47881334461105507
[CV] Fold 2: y_val bincount: [913 280], y_pred bincount: [1158   35]
[CV] Fold 2: AUC = 0.4978055077452668
[CV] Fold 3: y_val bincount: [912 281], y_pred bincount: [1152   41]
[CV] Fold 3: AUC = 0.511031248048948
[CV] Fold 4: y_val bincount: [912 281], y_pred bincount: [1158   35]
[CV] Fold 4: AUC = 0.4910563775988012
manual auc_list: [np.float64(0.5160532131762248), np.float64(0.47881334461105507), np.float64(0.4978055077452668), np.float64(0.511031248048948), np.float64(0.4910563775988012)]
manual auc mean (ignore nan): 0.49895193823605916
cross_val_score: [0.51605321 0.47881334 0.49780551 0.51103125 0.49105638]
X_train.shape: (5967, 135)
X_train nan: 6 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
y_train shape: (5967,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5967, 10)
X_train[selected_features] col nan: [0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 281], y_pred bincount: [1191    3]
[CV] Fold 0: AUC = 0.5246323371778931
[CV] Fold 1: y_val bincount: [913 281], y_pred bincount: [1176   18]
[CV] Fold 1: AUC = 0.4828437009117025
[CV] Fold 2: y_val bincount: [913 280], y_pred bincount: [1184    9]
[CV] Fold 2: AUC = 0.5162181192301675
[CV] Fold 3: y_val bincount: [912 281], y_pred bincount: [1182   11]
[CV] Fold 3: AUC = 0.5244232690266591
[CV] Fold 4: y_val bincount: [912 281], y_pred bincount: [1177   16]
[CV] Fold 4: AUC = 0.48656115377411496
manual auc_list: [np.float64(0.5246323371778931), np.float64(0.4828437009117025), np.float64(0.5162181192301675), np.float64(0.5244232690266591), np.float64(0.48656115377411496)]
manual auc mean (ignore nan): 0.5069357160241074
cross_val_score: [0.52463234 0.4828437  0.51621812 0.52442327 0.48656115]
X_train.shape: (5967, 135)
X_train nan: 6 inf: 0
X_train col nan count: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
X_train all const col: ['Steering_FreqVar', 'SteeringSpeed_FreqVar', 'Lateral_FreqVar', 'LaneOffset_FreqVar', 'LongAcc_FreqVar']
selected_features: ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
y_train shape: (5967,)
y_train nan: 0 unique: [0. 1.]
X_train[selected_features] shape: (5967, 10)
X_train[selected_features] col nan: [I 2025-08-16 19:08:35,721] Trial 9 finished with value: 0.5019847818163237 and parameters: {'n_estimators': 232, 'max_depth': 21, 'min_samples_split': 4, 'min_samples_leaf': 3}. Best is trial 5 with value: 0.5105668846784573.
2025-08-16 19:08:35,722 - INFO - Best hyperparameters: {'n_estimators': 197, 'max_depth': 9, 'min_samples_split': 4, 'min_samples_leaf': 3}
2025-08-16 19:08:35,722 - INFO - Selected features (from input): ['steering_speed_pred_error', 'steering_pred_error', 'long_acc_pred_error', 'lat_acc_pred_error', 'Steering_Skewness', 'LongAcc_Skewness', 'SteeringSpeed_Skewness', 'Steering_Kurtosis', 'SteeringSpeed_Kurtosis', 'SteeringSpeed_Median']
2025-08-16 19:08:36,362 - INFO - Saving RF with 10 features.
2025-08-16 19:08:36,791 - INFO - RF (Optuna) metrics: train acc=0.892, val acc=0.643, test acc=0.688
2025-08-16 19:08:36,851 - INFO - Test classification report:
              precision    recall  f1-score   support

         0.0       0.77      0.84      0.80       573
         1.0       0.29      0.21      0.24       180

    accuracy                           0.69       753
   macro avg       0.53      0.52      0.52       753
weighted avg       0.66      0.69      0.67       753

2025-08-16 19:08:38,044 - INFO - Optimal threshold for F1: 0.262
2025-08-16 19:08:38,056 - INFO - Validation (F1-opt threshold) metrics: {"accuracy": 0.27860026917900405, "precision": 0.2746955345060893, "recall": 1.0, "f1": 0.4309978768577495}
2025-08-16 19:08:38,056 - INFO - Test (F1-opt threshold from Val) metrics: {"accuracy": 0.24169986719787517, "precision": 0.2396804260985353, "recall": 1.0, "f1": 0.3866809881847476}
2025-08-16 19:08:38,063 - INFO - Saved metrics CSV -> ./model//common/metrics_RF_rank_wasserstein_mean_low.csv
[0 0 0 0 0 0 0 0 0 0]
[CV] Fold 0: y_val bincount: [913 281], y_pred bincount: [1191    3]
[CV] Fold 0: AUC = 0.5136872303188814
[CV] Fold 1: y_val bincount: [913 281], y_pred bincount: [1182   12]
[CV] Fold 1: AUC = 0.4778583762419461
[CV] Fold 2: y_val bincount: [913 280], y_pred bincount: [1187    6]
[CV] Fold 2: AUC = 0.5092473791268972
[CV] Fold 3: y_val bincount: [912 281], y_pred bincount: [1185    8]
[CV] Fold 3: AUC = 0.513825154523319
[CV] Fold 4: y_val bincount: [912 281], y_pred bincount: [1180   13]
[CV] Fold 4: AUC = 0.49530576887057504
manual auc_list: [np.float64(0.5136872303188814), np.float64(0.4778583762419461), np.float64(0.5092473791268972), np.float64(0.513825154523319), np.float64(0.49530576887057504)]
manual auc mean (ignore nan): 0.5019847818163237
cross_val_score: [0.51368723 0.47785838 0.50924738 0.51382515 0.49530577]
=== DONE (BASENAME=wasserstein_mean_low) ===

=================================== RESOURCE INFORMATION ===================================
 Requested Resource:
 mem=128gb,walltime=24:00:00,ncpus=8,place=pack 
 Used Resource: 
 mem=853968kb,walltime=00:05:38,ncpus=8,cpupercent=97,vmem=2267016kb
============================================================================================
